

## DLP（Data Loss Prevention）及びUEBA（User and Entity Behavior Analytics）

承知いたしました。
応用情報技術者試験の合格請負人として、あなたの実力を飛躍的に向上させる最高品質の演習問題集を作成します。単なる暗記ではなく、技術の本質を深く理解し、現場で通用する応用力を身につけていきましょう。それでは、早速始めます。

---

**【問1】**
情報セキュリティ対策におけるDLPの主な目的は、外部からのサイバー攻撃を防ぐことではなく、別の特定のリスクに対応することです。DLPが主眼を置く情報漏えいリスクとは何か、その発生源に着目して具体的に説明してください。

---
**【解答】**
DLPが主眼を置くのは、従業員など組織の内部関係者による、意図的または不注意による機密情報や重要データの持ち出し、紛失、誤送信といった「内部からの情報漏えい」を防止することです。

---
**【解説】**
DLPは「Data Loss Prevention」の略称です。その名の通り、*Data Loss*（データの損失・漏えい）を *Prevention*（防止）することを目的としています。
従来のファイアウォールやIDS/IPSが主に外部からの脅威を防ぐ「境界型防御」であるのに対し、DLPは組織内部で扱われるデータそのものに焦点を当てます。例えば、機密情報がUSBメモリにコピーされたり、個人のメールアドレスに送信されたりするのを防ぎます。これは、悪意ある内部不正だけでなく、「うっかりミス」による情報漏えいが後を絶たないという現代の課題に対応するための重要な技術です。

---
**【初心者が勘違いしやすい点】**
「DLPを導入すれば、あらゆる情報漏えいを防げる」と誤解しがちです。しかし、DLPはあくまで設定されたポリシーに基づいて動作します。ポリシーが不適切であったり、まだ機密情報として分類されていない新しいデータであったりすると、漏えいを防げない可能性があります。DLPは万能の銀の弾丸ではなく、適切なデータ分類と継続的なポリシーの見直しという運用とセットで初めて効果を発揮するソリューションです。

---
**【問2】**
UEBAが脅威を検知する仕組みの根幹には、「ベースライン」という概念があります。UEBAにおける「ベースライン」とは何か、そしてそれをどのように利用して異常を検知するのかを説明してください。

---
**【解答】**
UEBAにおける「ベースライン」とは、機械学習を用いて分析した、個々のユーザーや機器の平常時の行動パターンのことです。UEBAは、現在の行動がこのベースラインから大きく逸脱した際に、それを「異常」として検知します。

---
**【解説】】**
UEBAは「User and Entity Behavior Analytics」の略で、*User*（ユーザー）と *Entity*（実体、ここではサーバや端末などの機器）の *Behavior*（行動）を *Analytics*（分析）する技術です。
UEBAの最大の特徴は、事前に定義されたルールに頼らない点です。まず、システムは一定期間のログデータ（ログイン時刻、アクセス先、データ転送量など）を収集・学習し、ユーザーAさんは「平日の9時～18時に営業支援システムにアクセスする」、サーバBは「深夜2時に特定のサーバと定期通信を行う」といった、個々の「いつもの行動＝ベースライン」を自動で作成します。そして、このベースラインから外れた行動、例えば「ユーザーAさんが日曜の深夜に開発サーバから大量のデータをダウンロードした」といった事象を異常として検知し、管理者に警告するのです。

---
**【初心者が勘違いしやすい点】**
「UEBAは単なるログ監視ツールの上位版だ」と誤解されることがあります。しかし、従来のログ監視が「"error"という文字列を含むログを探す」といった静的なルールに基づいていたのに対し、UEBAは「普段と違う」という動的な変化を捉えます。そのため、未知のマルウェアによる不審な通信や、正規の権限を悪用した内部不正など、従来のルールベースの監視では見逃してしまう巧妙な脅威を発見できる点が本質的な違いです。

---
**【問3】**
DLPとUEBAは、監視する「対象」に根本的な違いがあります。それぞれの主要な監視対象は何かを明確に述べ、その違いがどのようなセキュリティ対策上のアプローチの違いを生むのかを説明してください。

---
**【解答】**
DLPの主要な監視対象は「データそのもの（ファイルの内容や属性）」であるのに対し、UEBAの主要な監視対象は「ユーザーや機器の行動（ログや操作履歴）」です。この違いにより、DLPはデータ中心の静的なポリシー制御、UEBAは行動中心の動的な異常検知というアプローチの違いが生まれます。

---
**【解説】】**
この違いを空港のセキュリティに例えてみましょう。
DLPは「手荷物検査」に似ています。検査官は乗客が誰であるか（ユーザーの行動）よりも、その人が持っているカバンの中身（データ）に危険物（機密情報）が含まれていないかを、ルール（ポリシー）に基づいてチェックします。
一方、UEBAは「警備員の巡回」に似ています。警備員は、空港内をうろついたり、不自然な動きをしたりする人物（異常な行動）がいないかを監視します。その人物が何を持っているか（データ）も判断材料の一つですが、主眼はあくまで「普段と違う怪しい振る舞い」の検知にあります。
このように、DLPは「モノ（データ）」を、UEBAは「コト（行動）」を見ており、両者は異なる視点からセキュリティを確保します。

---
**【初心者が勘違いしやすい点】**
DLPとUEBAを競合する技術だと捉えがちですが、実際には相互補完的な関係にあります。例えば、UEBAが「あるユーザーが普段アクセスしない機密フォルダにアクセスした」という異常行動を検知し、その後のDLPの監視ログで「そのユーザーが機密ファイルを外部に送信しようとしてブロックされた」ことが確認される、といった連携が可能です。両者を組み合わせることで、脅威の予兆検知から実害の防止まで、多層的な防御が実現できます。

---
**【問4】**
UEBAの正式名称に含まれる「Entity」という単語は、この技術を理解する上で重要なキーワードです。なぜ「User」だけでなく「Entity」の行動分析も行う必要があるのか、具体的な脅威シナリオを挙げて説明してください。

---
**【解答】**
サイバー攻撃では、マルウェアに感染したサーバやIoT機器のように、人間が直接介在しない「Entity（機器）」が起点となって内部ネットワークで不正活動を行うケースがあるためです。ユーザーの行動だけを監視していては、このような機器による異常な振る舞いを見逃してしまうため、「Entity」の行動分析も不可欠となります。

---
**【解説】】**
「Entity」は「実体」「存在」を意味し、ITの文脈ではユーザー以外にシステムを構成する要素、具体的にはサーバ、クライアントPC、ネットワーク機器、IoTデバイスなどを指します。
例えば、以下のような脅威シナリオが考えられます。
*   **サーバの侵害:** Webサーバが脆弱性を突かれてマルウェアに感染。そのサーバが、本来通信するはずのない内部のデータベースサーバに対して、深夜に大量のアクセスを試みる。
*   **IoT機器の悪用:** セキュリティの甘い監視カメラが乗っ取られ、ネットワークスキャンの踏み台として利用される。
これらの活動はユーザーの操作によるものではないため、ユーザーの行動分析だけでは検知できません。「Entity」のベースライン（例：このサーバは通常、どの機器とどのポートで通信するか）を学習し、そこからの逸脱を検知することで、初めて対応が可能になります。

---
**【初心者が勘違いしやすい点】**
UEBAを「ユーザーの不正を見張るためのツール」とだけ考えてしまうと、その適用範囲を狭めてしまいます。「Entity」の分析まで含めて初めて、現代の複雑なIT環境における内部の脅威（ラテラルムーブメントなど）に広く対応できる、という点を理解することが重要です。

---
**【問5】**
DLPソリューションは、ポリシーに違反するデータの移動を検知した際に、いくつかの制御アクションを実行します。代表的な制御アクションを3つ挙げ、それぞれがどのような目的で利用されるかを簡潔に説明してください。

---
**【解答】**
1.  **ブロック（Block）:** 情報漏えいを未然に防ぐことを目的に、データのコピーや送信などの操作を完全に停止させる。
2.  **暗号化（Encrypt）:** データが外部に持ち出されること自体は許可しつつ、許可されたユーザー以外が内容を閲覧できないようにし、安全なデータ利用を促す目的で利用する。
3.  **警告（Alert/Notify）:** 操作をブロックはしないが、ユーザーにポリシー違反の可能性があることを警告し、注意を促す。また、管理者へ通知し、操作の監査証跡を残す目的で利用する。

---
**【解説】】**
DLPの制御アクションは、セキュリティポリシーの厳格さと業務の利便性のバランスを考慮して選択されます。
*   **ブロック:** 最も強力な制御です。「個人情報を含むファイルは、いかなる場合も外部へのメール送信を禁止する」といった厳格なルールに適用されます。
*   **暗号化:** 例えば、社外の取引先と機密情報を共有する必要がある場合に、USBメモリへのコピーは許可するが、ファイルを自動的に暗号化するといった使い方をします。これにより、利便性を損なわずに安全性を高めます。
*   **警告:** 「このファイルは『社外秘』と分類されていますが、本当に送信しますか？」といった警告を表示します。これは、従業員のセキュリティ意識を向上させるとともに、操作が正当な業務によるものかを確認する機会を与えます。

---
**【初心者が勘違いしやすい点】**
「DLPはデータをブロックするためだけのもの」と考えるのは早計です。実際には、業務を円滑に進めるために、上記のように柔軟な制御オプションが用意されています。どのような場合にブロックし、どのような場合に暗号化や警告で済ませるか、適切なポリシーを設計することがDLP運用の鍵となります。

---
**【問6】**
営業部門のAさんが、深夜2時に、普段は全くアクセスしない開発部門のソースコード管理サーバから、大量のファイルを自身のPCにダウンロードしました。このインシデントの検知において、DLPとUEBAはそれぞれどのような役割を果たすか、あるいは果たせないかを説明してください。

---
**【解答】**
このインシデントの検知において、主たる役割を果たすのはUEBAです。UEBAはAさんの「時間（深夜）」「アクセス先（開発サーバ）」「操作（大量ダウンロード）」といった一連の行動が通常のベースラインから逸脱しているため、「異常行動」として検知できます。一方、DLPはAさんが正当なアクセス権を持ち、データ自体に持ち出し禁止のポリシーが設定されていなければ、この操作を検知・ブロックすることは困難です。

---
**【解説】】**
このシナリオは、UEBAの価値を非常によく示しています。
*   **UEBAの視点:**
    *   **Who (誰が):** 営業部門のAさん
    *   **What (何を):** ソースコードを大量にダウンロード
    *   **Where (どこから):** 開発部門のサーバから
    *   **When (いつ):** 深夜2時に
    これらの要素を組み合わせ、Aさんの通常の行動ベースラインと比較することで「極めて疑わしい行動」と判断します。アカウントが乗っ取られたか、内部不正の兆候である可能性が高いと警告を発します。
*   **DLPの視点:**
    DLPは「データ」に焦点を当てます。もし、ソースコードファイルに「最重要機密：持ち出し禁止」といった分類がなされており、DLPがそのポリシーに基づいて監視していれば、ダウンロードをブロックできたかもしれません。しかし、もしAさんが（何らかの理由で）そのサーバへのアクセス権を持っており、ファイルに持ち出し禁止のポリシーがなければ、DLPはこの一連の「行動」を異常とは判断できません。

---
**【初心者が勘違いしやすい点】**
「アクセス権限があれば何をしても良い」というわけではない、というセキュリティの原則をこの問題は示唆しています。正規の権限を持つユーザーによる不正行為（あるいはアカウント乗っ取り）は、従来のアクセス制御だけでは防げません。UEBAは、その「権限の不正利用」の兆候を、行動分析によって炙り出すことができるのです。

---
**【問7】**
DLPのアプローチは「ポリシーベース」、UEBAのアプローチは「行動分析（機械学習）」と表現されます。このアプローチの違いが、未知の脅威への対応能力にどのような差をもたらすかを説明してください。

---
**【解答】**
「ポリシーベース」のDLPは、既知のルール（例：「マイナンバーを含むファイルを外部に送信しない」）に合致する脅威は確実に防げますが、ルールとして定義されていない未知の脅威や巧妙な手口には対応できません。一方、「行動分析」を用いるUEBAは、特定のルールに依存せず「平常時との違い」を検知するため、ゼロデイ攻撃や内部不正など、前例のない未知の脅威の兆候を発見できる可能性があります。

---
**【解説】】**
この違いは、病気の診断に例えることができます。
*   **DLP（ポリシーベース）:** 「体温が38度以上ならインフルエンザの疑い」という明確な診断基準（ポリシー）に基づいて判断するようなものです。この基準に合えば確実に見つけられますが、体温が上がらない特殊な病気（未知の脅威）は見逃してしまいます。
*   **UEBA（行動分析）:** 「いつもの元気な様子と比べて、今日は顔色が悪く、食欲もない」といった平常時との差異（ベースラインからの逸脱）から「何か体調が悪いのではないか」と気づく総合的な問診のようなものです。特定の病名が分からなくても、「何かがおかしい」という兆候を捉えることができます。
このように、DLPが既知のリスクを確実に封じ込めるのに長けているのに対し、UEBAは未知のリスクの予兆を捉えることに優れています。

---
**【初心者が勘違いしやすい点】**
「機械学習を使うUEBAの方がDLPより優れている」と短絡的に考えるのは誤りです。両者は役割が異なります。機密情報の漏えいを「確実に止める」という最後の砦としての役割はDLPが担います。UEBAのアラートはあくまで「疑い」であり、必ずしも悪意のある行為とは限りません（過検知）。両者の特性を理解し、適材適所で活用することが重要です。

---
**【問8】**
顧客情報を含む電子メールを、誤って外部のメーリングリストに送信しようとした場合、この情報漏えいを未然に防ぐのに適しているのはDLPとUEBAのどちらですか。その理由も併せて説明してください。

---
**【解答】**
このケースで情報漏えいを未然に防ぐのに適しているのはDLPです。理由は、DLPが電子メールの「内容」を解析し、「顧客情報」という機密データが含まれていること、そして宛先が「外部ドメイン」であることを検知し、あらかじめ設定されたポリシーに基づいて送信をブロックできるからです。

---
**【解説】】**
このシナリオは、DLPが最も得意とする典型的な例です。DLPは、正規表現（例：クレジットカード番号のパターン）やキーワード（例：「顧客リスト」「会員番号」）によってデータの内容をスキャンし、機密情報かどうかを識別します。そして、「機密情報を含む通信が、組織の外部（外部ドメインやクラウドストレージなど）に向かう場合、その通信を遮断する」というポリシーを適用することで、意図しない情報漏えいを水際で防ぎます。
一方、UEBAはこの操作を異常と検知できない可能性があります。もし、この従業員が普段から外部とメールをやり取りしているのであれば、UEBAの観点では「いつもの行動」の範囲内と判断され、アラートが上がらないかもしれません。UEBAは「行動の異常性」を見るため、「データの機密性」を直接判断して止めることは専門外です。

---
**【初心者が勘違いしやすい点】**
UEBAが検知するのはあくまで「行動」の異常であり、その行動によって扱われている「データ」の機密性そのものを評価するわけではない、という点を混同しないことが重要です。データの機密性に基づいて制御を行うのはDLPの核心的な機能です。

---
**【問9】**
DLPの運用を成功させるためには、技術的な設定以前に、組織として実施すべき重要な準備プロセスがあります。そのプロセスとは何か、そしてなぜそれが不可欠なのかを説明してください。

---
**【解答】**
DLPの運用前に実施すべき重要な準備プロセスは、保護対象となる「重要データの定義と分類（Data Classification）」です。これが不可欠な理由は、DLPはどのデータが重要かを自律的に判断できないため、組織が「何を」「どのレベルで」守るべきかを明確に定義してポリシーに落とし込まなければ、DLPが正しく機能しないからです。

---
**【解説】】**
データ分類とは、組織内の全てのデータを、その機密性や重要性に応じて「極秘」「社外秘」「公開」などのカテゴリに分ける作業です。例えば、「マイナンバーや役員会議事録は『極秘』」「業務マニュアルは『社内限』」「プレスリリースは『公開』」のように分類します。
この分類があって初めて、DLPに「『極秘』データは印刷・コピー・外部送信を全てブロックする」「『社内限』データは外部送信時に上長の承認を必要とする」といった具体的なポリシーを設定できます。もしデータ分類が曖昧であれば、守るべき情報が漏えいしたり、逆に公開情報までブロックして業務を阻害したりする事態に陥ります。DLPという「高性能な金庫」を導入しても、何を入れるべきか（守るべきデータは何か）が決まっていなければ意味がないのです。

---
**【初心者が勘違いしやすい点】**
「高価なDLPツールを導入すれば、すぐに情報漏えいを防げる」と考えがちです。しかし、DLPはあくまでツールであり、その効果は組織のデータ管理体制（＝データ分類の精度）に大きく依存します。技術の導入と、それを支える運用ルールの整備は、常に一体で考えなければならないという好例です。

---
**【問10】**
IDS/IPSとUEBAは、どちらも不正な活動を検知するセキュリティ技術ですが、その検知メカニズムに大きな違いがあります。IDS/IPSが主に利用する検知手法と、UEBAが利用する検知手法を対比させて説明してください。

---
**【解答】**
IDS/IPSは、主に「シグネチャ」と呼ばれる既知の攻撃パターンを定義したファイルと比較し、一致する通信を検知する「シグネチャベース（知識ベース）」の手法を用います。一方、UEBAは、機械学習によってユーザーや機器の正常な行動パターン（ベースライン）を学習し、そこから逸脱する未知の振る舞いを検知する「ビヘイビアベース（振る舞いベース）」の手法を用います。

---
**【解説】】**
*   **IDS/IPS (Intrusion Detection/Prevention System):** 日本語では侵入検知・防御システム。これは、指名手配犯の顔写真リスト（シグネチャ）を持って、空港のゲートで入国者をチェックするようなものです。リストに載っている攻撃（SQLインジェクションの典型的なコードなど）は高い精度で検知・ブロックできますが、リストにない新種の攻撃（ゼロデイ攻撃）や、変装した攻撃者は見逃してしまいます。
*   **UEBA (User and Entity Behavior Analytics):** こちらは、前述の通り、熟練の警備員が「いつもの空港の様子」と違う不審な振る舞いを見つけ出すようなものです。特定の攻撃パターンを知らなくても、「あの人物の行動は怪しい」と直感的に気づくことができます。

---
**【初心者が勘違いしやすい点】**
IDS/IPSはもう古い技術で、これからはUEBAの時代だ、と考えるのは短絡的です。既知の典型的な攻撃を効率的にブロックする上では、シグネチャベースのIDS/IPSは今でも非常に有効です。UEBAは、IDS/IPSをすり抜けてくるような、より巧妙で未知の脅威を補完的に検知する役割を担います。これらもまた、競合ではなく補完関係にある技術です。

---
**【問11】**
DLPとUEBAの関係性について、「静的」と「動的」というキーワードを用いて説明してください。

---
**【解答】**
DLPは、あらかじめ定義されたデータ分類やルールに基づいて制御を行う「静的」なセキュリティ対策です。一方、UEBAは、リアルタイムで変化するユーザーや機器の行動を常に分析し、平常時との差異を検知する「動的」なセキュリティ対策であると言えます。

---
**【解説】】**
*   **静的なDLP:** DLPのポリシーは、「この種類のデータは、この経路での持ち出しを禁止する」というように、一度設定されると基本的には固定的に適用されます。これは、法律の条文のように、定められたルールに基づいて善悪を判断するアプローチです。
*   **動的なUEBA:** UEBAが学習するベースラインは、ユーザーの役割変更やシステムのアップデートに伴い、時間と共に変化していきます。UEBAは常に現在の行動と「最新の平常時」を比較し続けるため、その判断基準は常に変化（学習）し続ける「動的」なものと言えます。これは、状況に応じて柔軟に判断を下す裁判官のようなアプローチです。
この静的な制御と動的な分析を組み合わせることで、より堅牢なセキュリティ体制を築くことができます。

---
**【初心者が勘違いしやすい点】**
「静的」というと、時代遅れで柔軟性がないというネガティブなイメージを持つかもしれません。しかし、セキュリティにおいて「機密情報は絶対に外部に出さない」といった普遍的で揺るぎないルールを強制することは非常に重要です。この確実なルール適用こそが「静的」なDLPの強みであり、役割です。

---
**【問12】**
ある社員が、会社のノートPCを自宅に持ち帰り、個人契約のクラウドストレージに業務ファイルをアップロードしました。この行為が情報漏えいに繋がるかどうかを判断する上で、DLPとUEBAはそれぞれどのような情報に着目しますか？

---
**【解答】**
DLPは、アップロードされた「ファイルの内容」に着目します。そのファイルに機密情報（例：顧客リスト）が含まれていれば、ポリシー違反としてブロックします。一方、UEBAは、その社員の一連の「行動」に着目します。例えば、その社員が普段クラウドストレージを使わない、深夜に大量のファイルをアップロードしている、などの行動があれば、ベースラインから逸脱した異常行動として検知します。

---
**【解説】】**
この問題は、DLPとUEBAの視点の違いを再確認するものです。
*   **DLPの判断基準:** ファイルに機密情報が含まれているか？ → Yesならブロック。Noなら許可。
*   **UEBAの判断基準:** この行動は普段通りか？ → No（異常）ならアラート。Yes（平常）なら静観。

重要なのは、両者の判断が必ずしも一致しないことです。例えば、機密情報ではないが大量の業務ファイルをアップロードした場合、DLPは許可しますがUEBAは異常と判断するかもしれません。逆に、ファイル一つだけでも極秘情報であれば、UEBAが気づかないうちにDLPがブロックします。

---
**【初心者が勘違いしやすい点】**
どちらか一方だけでは、セキュリティの穴が生まれる可能性があることを理解する必要があります。DLPは「中身が重要でないデータ」の異常な持ち出しを見逃す可能性があり、UEBAは「行動は普段通りだが中身が重要なデータ」の漏えいを止められない可能性があります。両輪で監視することが理想的です。

---
**【問13】**
「UEBAは、機械学習を用いてログを分析し、インシデントを検知するシステムである」という説明は、正しいですが不十分です。この説明に欠けている、UEBAの核心的なコンセプトを2つ補って、より正確な説明を完成させてください。

---
**【解答】**
欠けている核心的なコンセプトは「ユーザー及びエンティティ（User and Entity）」と「行動のベースライン（Behavior Baseline）」です。これらを補うと、「UEBAは、機械学習を用いて**ユーザー及びエンティティの**ログを分析し、**平常時の行動ベースラインを確立**した上で、そこから逸脱する行動をインシデントとして検知するシステムである」という、より正確な説明になります。

---
**【解説】】**
単に「ログを分析する」だけでは、従来のSIEM（Security Information and Event Management）など他の技術との違いが明確になりません。UEBAの本質は以下の2点にあります。
1.  **誰の/何のログか:** 分析対象が「ユーザー」と「エンティティ」に特化していること。これにより、主体ごとの行動パターンをきめ細かく追跡できます。
2.  **どうやって異常と判断するか:** 「ベースラインからの逸脱」というアプローチを取ること。これが、ルールベースの検知との決定的な違いであり、未知の脅威に対応できる理由です。
これらのキーワードを正確に理解し、説明できることが、UEBAを本質的に理解しているかどうかの試金石となります。

---
**【初心者が勘 женщиやすい点】**
UEBAとSIEMの混同は、非常によくある誤解です。SIEMは、様々な機器からログを「集約」し、ルールに基づいて「相関分析」を行うのが主目的です。一方、UEBAは、集約されたログを元に、個々の主体（ユーザー/エンティティ）の「行動」に焦点を当てて、より高度な「分析」を行うことに特化しています。近年では、両者の機能が統合された製品も多く登場しています。

---
**【問14】**
DLPが効果を発揮するためには、監視対象となるデータがどのような経路で漏えいするかを想定し、それぞれに対応した監視機能が必要です。組織のデータが漏えいしうる典型的な経路（チャネル）を4つ挙げてください。

---
**【解答】**
1.  **ネットワーク経由:** 電子メール、Webアップロード（Webメール、SNS、クラウドストレージなど）、FTPなど。
2.  **エンドポイント（端末）経由:** USBメモリなどの外部記憶媒体へのコピー、CD/DVDへの書き込み。
3.  **印刷:** 紙媒体への印刷。
4.  **アプリケーション経由:** クリップボードへのコピー、スクリーンショットの取得など。

---
**【解説】】**
DLPソリューションは、これらの様々な漏えい経路を監視するために、複数のコンポーネントで構成されることが一般的です。
*   **ネットワークDLP:** ネットワークの出口（ゲートウェイ）に設置され、組織内外の通信を監視します。
*   **エンドポイントDLP:** 各PCやサーバにエージェントソフトウェアを導入し、USBポートの制御や印刷、クリップボードの操作などを監視・制御します。
*   **ストレージDLP:** ファイルサーバやデータベース内に保管されている機密情報をスキャンし、不適切な場所に保存されていないかを検出します（Data at Restの保護）。
これらの機能を組み合わせることで、多岐にわたる情報漏えいリスクに包括的に対応します。

---
**【初心者が勘違いしやすい点】**
「ネットワークDLPさえ入れておけば、メールとWebからの漏えいは防げるので安心だ」と考えてしまうことです。しかし、これではUSBメモリへのコピーや、スマートフォンのカメラで画面を撮影するといった物理的な持ち出しには対応できません。情報漏えい対策は、技術的な対策と物理的な対策、そして人的な教育を組み合わせた多層的なアプローチが不可欠です。

---
**【問15】**
内部不正を企む従業員が、自身の正当なアカウントを使い、数ヶ月間にわたって少しずつ機密情報を収集し、最終的に外部へ持ち出す、という巧妙な攻撃（スローアタック）に対して、DLPとUEBAはそれぞれどのように機能しますか。また、どちらがこの種の攻撃の早期発見に有効と考えられるか、理由と共に述べてください。

---
**【解答】**
DLPは、最終的にデータが外部へ持ち出される瞬間を捉え、ポリシーに合致すればブロックできますが、それ以前の収集段階の不審な動きを検知することは困難です。一方、UEBAは、長期間にわたる行動の変化を分析し、普段アクセスしないデータへの散発的なアクセスが増えるなど、ベースラインからのわずかな逸脱を累積して評価することで、攻撃の初期段階で兆候を捉えられる可能性があります。したがって、この種の攻撃の早期発見にはUEBAがより有効と考えられます。

---
**【解説】】**
スローアタックは、一度に大量のデータを動かすのではなく、検知システムの閾値を超えないように、時間をかけて少しずつ活動するため、従来の監視システムでは見つけにくいという特徴があります。
*   **DLPの限界:** 一回ごとのデータアクセスが正当な権限の範囲内であれば、DLPは警告しません。DLPが機能するのは、あくまで最後の「持ち出し」のフェーズです。
*   **UEBAの強み:** UEBAは、個々の行動だけでなく、複数の行動を時系列で分析し、リスクスコアを累積していく機能を持つ製品が多くあります。「先週はサーバAに、今週はサーバBに、普段と違うアクセスをしている。両方とも単体では些細だが、合わせるとリスクが高い」といった判断が可能です。これにより、巧妙に隠された攻撃の予兆を早期に発見できる可能性が高まります。

---
**【初心者が勘違いしやすい点】**
セキュリティ対策は、被害を「未然に防ぐ」ことだけでなく、「早期に発見する」ことも同様に重要です。DLPが「防止（Prevention）」に重きを置いているのに対し、UEBAは「検知（Detection）」と「分析（Analytics）」に強みを持ちます。どちらか一方ではなく、攻撃の各フェーズに対応できるような多層的な防御体制を構築する視点が求められます。

---
**【問16】**
「DLPはデータの『内容』を解析し、機密情報かどうかを判断する」とされます。その際、DLPがデータの内容を識別するために用いる、代表的な技術手法を2つ挙げてください。

---
**【解答】**
1.  **正規表現マッチング:** クレジットカード番号やマイナンバー、電話番号など、特定のパターン（文字列の形式）を持つ情報を検出する手法。
2.  **キーワードマッチング:** 「社外秘」「極秘」「Confidential」など、あらかじめ登録された特定の単語やフレーズがファイル内に含まれているかを検出する手法。

---
**【解説】】**
DLPは、これらの技術を用いて、データの中身を高速にスキャンし、ポリシーに合致するかどうかを判定します。
*   **正規表現マッチング:** 例えば、クレジットカード番号は「4桁の数字が4つ、ハイフンで区切られている（例：1234-5678-9012-3456）」という形式を持っています。このパターンを正規表現として登録しておくことで、DLPは文書やメール本文からカード番号らしき文字列を自動で検出できます。
*   **キーワードマッチング:** 組織内で定められた機密指定の文言や、プロジェクトのコードネームなどをキーワードとして登録します。これにより、ルールに基づいた情報漏えいを防ぎます。
この他にも、文書全体の単語の出現頻度などから内容を統計的に推測する手法や、文書のフィンガープリント（ハッシュ値）を登録しておく手法など、より高度な識別技術も存在します。

---
**【初心者が勘違いしやすい点】**
これらの手法は完璧ではありません。例えば、キーワードを意図的にひらがなで書いたり、画像データとして貼り付けたりすると、単純なマッチングでは検出を回避される可能性があります（OCR機能を持つDLPもあります）。そのため、複数の技術を組み合わせ、定期的にポリシーやキーワードを見直す運用が重要になります。

---
**【問17】**
UEBAが分析する「行動」には、どのような種類のデータが含まれますか。分析の元となるログや情報の具体例を、最低4つ挙げてください。

---
**【解答】**
1.  **認証ログ:** ログイン/ログオフの成功・失敗、時刻、アクセス元のIPアドレス、使用端末など。
2.  **アクセスログ:** ファイルサーバやデータベース、各種アプリケーションへのアクセス履歴、操作内容（読み取り、書き込み、削除など）。
3.  **ネットワークログ:** ファイアウォールやプロキシサーバの通信ログ（宛先IPアドレス、ポート番号、通信量など）。
4.  **エンドポイントログ:** PC上でのプロセス起動履歴、USBデバイスの接続履歴、レジストリ変更など。

---
**【解説】】**
UEBAは、これらの多種多様なログソースから情報を収集し、個々のユーザーやエンティティの行動として時系列に沿って再構成します。例えば、「ユーザーAが、IPアドレスX.X.X.Xの端末から午前3時にVPNログインし（認証ログ）、ファイルサーバYにアクセスして（アクセスログ）、大量のデータをダウンロードし（ネットワークログ）、その直後にpowershell.exeを起動した（エンドポイントログ）」といった一連のストーリーを組み立てます。このストーリー全体が、そのユーザーの「いつもの行動（ベースライン）」と比較され、異常かどうかが判断されます。より多くの種類のログを分析するほど、分析の精度は向上します。

---
**【初心者が勘違いしやすい点】**
UEBAの導入効果は、収集できるログの「質」と「量」に大きく左右されることを理解する必要があります。必要なログが取得できていなかったり、ログのフォーマットがバラバラで正規化できなかったりすると、UEBAは十分な分析ができず、宝の持ち腐れとなってしまいます。導入前には、どのシステムからどのようなログが取得可能かを調査するアセスメントが不可欠です。

---
**【問18】**
DLPとUEBAは、それぞれ「誤検知（False Positive）」と「見逃し（False Negative）」という課題を抱えています。両技術において、これらの課題がどのような状況で発生しやすいかを説明してください。

---
**【解答】**
*   **DLP:**
    *   **誤検知:** ポリシーが厳しすぎる場合。例えば、社員番号と形式が似ているだけの文字列を個人情報と誤認してブロックし、正当な業務を阻害する。
    *   **見逃し:** ポリシーが緩すぎる、または想定外の方法でデータを持ち出された場合。例えば、機密情報を暗号化されたZIPファイルや画像ファイルに偽装して送信し、内容スキャンを回避される。
*   **UEBA:**
    *   **誤検知:** ユーザーが正当な理由で普段と違う行動（例：休日出勤、新規プロジェクトへの参加）をした際に、それを異常として警告してしまう。
    *   **見逃し:** 攻撃者が検知を避けるために、長期間にわたってベースラインを少しずつ汚染（学習）させたり、非常にゆっくりと活動したりして、大きな逸脱として検知されないように振る舞う。

---
**【解説】】**
*   **False Positive（偽陽性）:** 無害なものを有害だと誤って判断すること。これが多発すると、管理者はアラート疲れを起こし、本当に重要な警告を見逃す原因になります。
*   **False Negative（偽陰性）:** 有害なものを見逃してしまうこと。これは、セキュリティ侵害に直結する最も避けたい事態です。
どちらの技術も、これらの課題とのバランスを取るための「チューニング（調整）」作業が運用上、非常に重要となります。セキュリティのレベルを上げれば利便性が下がり（誤検知増）、利便性を追求すればセキュリティレベルが下がる（見逃し増）というトレードオフの関係を理解し、組織のリスク許容度に応じた調整が求められます。

---
**【初心者が勘違いしやすい点】**
「導入すれば自動で完璧に動いてくれる」という幻想を抱かないことが重要です。DLPのポリシーチューニングも、UEBAのベースライン学習の監視やアラートの分析も、専門知識を持った人間による継続的な運用・改善作業が不可欠です。ツールはあくまで支援者であり、最終的な判断と運用責任は人間が担います。

---
**【問19】**
ある企業が、DX推進の一環としてクラウドサービスの利用を拡大しています。この環境において、従来の境界型防御に加えてDLPやUEBAが特に重要となる理由を、「データの所在」と「アクセスの多様化」という観点から説明してください。

---
**【解答】**
クラウド利用の拡大により、守るべき「データの所在」が社内ネットワークに限定されず、社外のクラウド上に分散するようになりました。また、従業員の「アクセスの多様化」により、社内だけでなく自宅や出張先など様々な場所・端末からデータにアクセスするようになりました。この結果、社内外の境界が曖昧になり、データそのものを監視するDLPや、場所を問わずユーザーの行動を監視するUEBAの重要性が増しています。

---
**【解説】】**
従来のセキュリティは、城壁（ファイアウォール）で会社のネットワークを囲み、その出入り口を監視する「境界型防御」が中心でした。しかし、クラウド化が進んだ現代では、重要なデータやアプリケーションが城の外（クラウド）にあり、社員も城の外（リモートワーク）からアクセスするのが当たり前になりました。
*   **DLPの重要性:** データがどこにあろうとも（社内サーバ、SaaS、IaaS）、そのデータ自体に付けられた「機密」というタグを追跡し、不正な共有やダウンロードを防ぐ必要があります。データの場所に依存しない制御が可能なDLPが不可欠です。
*   **UEBAの重要性:** 誰が、いつ、どこからアクセスしても、その行動が「いつも通りか」を監視する必要があります。社内のIPアドレスからのアクセスも、自宅からのVPNアクセスも、同一のユーザーとして行動を分析し、異常を検知するUEBAが有効です。

---
**【初心者が勘違いしやすい点】**
クラウド時代のセキュリティは「ゼロトラスト」という考え方が主流になっています。「社内だから安全、社外だから危険」と区別するのではなく、「あらゆるアクセスを信頼せず（ゼロトラスト）、都度検証する」というアプローチです。DLPによるデータアクセスの検証や、UEBAによる行動の信頼性評価は、このゼロトラスト・セキュリティを実現するための重要な構成要素となります。

---
**【問20】**
DLPとUEBAを連携させて統合的に運用することで、単独で利用するよりも高度なセキュリティ対策が実現できます。この連携によるメリットを、「コンテキスト（文脈）」という言葉を用いて具体的に説明してください。

---
**【解答】**
DLPとUEBAを連携させることで、一方の技術が検知した事象を、もう一方の技術の情報で補強し、より豊かな「コンテキスト（文脈）」を持ったインシデントとして評価できる点がメリットです。これにより、アラートの精度向上と、インシデント対応の迅速化が可能になります。

---
**【解説】】**
具体的な連携例を挙げます。
1.  **UEBA → DLP:** UEBAが「ユーザーAの行動リスクスコアが急上昇した」と検知したとします。この情報をDLPに連携し、「ユーザーAによるデータ操作の監視ポリシーを一時的に強化する（通常は警告のみだが、ブロックに変更する）」といった動的な制御が可能になります。リスクの高い人物の行動を、より厳しく監視するという文脈が生まれます。
2.  **DLP → UEBA:** DLPが「ユーザーBが機密情報の外部送信を試み、ブロックされた」というイベントを検知したとします。この情報をUEBAに連携すると、UEBAはユーザーBの過去の行動ログを再評価し、「このブロックイベントの1時間前に、普段アクセスしないファイルサーバへのアクセスがあった」といった関連する不審な行動を掘り起こすことができます。これにより、単なる操作ミスなのか、悪意ある漏えいの試みなのか、その背景（コンテキスト）を深く理解した上で対応できます。

このように、両者を連携させることで、点（個々のイベント）の監視から、線（一連の行動）や面（組織全体のリスク状況）での監視へと進化させることができるのです。

---
**【初心者が勘違いしやすい点】**
DLPとUEBAを別々のベンダーから導入すると、このような高度な連携が難しい場合があります。製品選定の際には、将来的な連携や統合運用を見据え、API連携の可否や、統合プラットフォームとして提供されているかといった点も考慮に入れることが、より成熟したセキュリティ運用を目指す上で重要になります。








１．全体像（テキスト図）

```
　　　┌───────────┐
　　　│　　　DLP　　　　　│
　　　│　　　　　　　　　　│
　　　├──────↓──────┤
　　　│重要データ（機密情報）│
　　　│　　　　　　　　　　│
　　　└───────────┘
　　　　　　　　↑
　　　　　　　　│
　　　　データ中心の制御

　　　　　　　　┌───────────┐
　　　　　　　　│　　　UEBA　　　　　│
　　　　　　　　│　　　　　　　　　　│
　　　　　　　　├──────↓──────┤
　　　　　　　　│ユーザー、機器の行動│
　　　　　　　　│　　　　　　　　　　│
　　　　　　　　└───────────┘
　　　　　　　　　　　　↑
　　　　　　　　　　　　│
　　　　　　　行動分析による検知
```

２．定義（IPA準拠）と用語の由来
（１）DLP
定義：Data Loss Preventionの略。企業が保有する機密情報や重要データの紛失、及び外部への漏えいを防止するための技術及び対策の総称です。
由来：Data Loss（データの損失）をPrevention（防止）するという目的をそのまま表現した用語です。

（２）UEBA
定義：User and Entity Behavior Analyticsの略。ユーザーや機器（エンティティ）の行動を機械学習等を用いて分析し、通常とは異なる異常な行動を検知する技術です。
由来：User（ユーザー）及びEntity（機器・実体）のBehavior（行動）をAnalytics（分析）するという、技術の核心をそのまま示した用語です。

３．技術の必要性（解決する具体的課題）
（１）DLP
今日の企業活動では、機密情報や個人情報が電子データとして大量に扱われています。従来のセキュリティ対策は、外部からの不正アクセスを防ぐことに主眼が置かれていましたが、内部の人間による意図的・非意図的なデータ持ち出しや、誤送信による情報漏えいが大きな課題となっています。DLPは、データそのものに着目して監視・制御することで、これらの内部起因の課題を解決するために必要です。

（２）UEBA
従来のセキュリティシステムは、既知の攻撃パターンやルールに基づいて異常を検知していました。しかし、ゼロデイ攻撃や、正規のユーザーアカウントを悪用した内部不正など、未知の脅威や巧妙な手口には対応が困難でした。UEBAは、個々のユーザーや機器の「通常の行動」を学習してプロファイルを作成し、そこから逸脱した「異常な行動」を検知することで、ルールベースでは見つけにくい脅威を早期に発見するために必要です。

４．試験の着眼点（頻出領域と解答に必要な知識を解説）
（１）DLP
・**監視対象**: 「データそのもの」が監視対象である点を理解することが重要です。ユーザーやデバイスではなく、データに設定されたポリシーに基づき制御を行います。
・**機能**: データの識別・分類、監視、制御（ブロック、暗号化）、監査・レポート機能など、具体的な機能と目的を関連付けて覚える必要があります。
・**漏えい経路**: どのような経路（電子メール、Web、USB、印刷など）でのデータ漏えいを防ぐのかを把握します。

（２）UEBA
・**検知手法**: 「機械学習」を用いて「ベースライン（通常行動）」を作成し、その「逸脱」を検知する仕組みを理解することが不可欠です。
・**対象**: ユーザーだけでなく、「エンティティ（サーバ、端末、ルータなど）」も分析対象である点がポイントです。
・**適用例**: ユーザーが通常アクセスしないサーバへのアクセス、通常業務時間外の大量ファイルダウンロードなど、具体的な異常行動の例を問われることがあります。

５．体系マップ（分類・関係・比較表）
| 観点 | DLP（Data Loss Prevention） | UEBA（User and Entity Behavior Analytics） |
| :--- | :--- | :--- |
| **主な目的** | 重要データの外部漏えい防止 | 異常な行動の検知 |
| **監視対象** | データそのもの（ファイル、情報） | ユーザー及び機器の行動 |
| **アプローチ** | ポリシーベースの制御 | 行動分析（機械学習） |
| **得意な脅威** | 内部者による意図的・非意図的なデータ持ち出し | 内部不正、アカウント乗っ取り、未知の攻撃 |
| **制御方法** | 通信のブロック、暗号化、警告 | ログの収集・分析、アラート通知 |

６．代表例（正答例・誤答例）
（１）DLP
**正答例**: 機密情報を含むファイルをUSBメモリにコピーしようとした際に、自動的に操作をブロックする。
**誤答例**: ユーザーの過去の行動履歴を分析し、普段はアクセスしないサーバにアクセスしたことを検知する。
→ これはUEBAの機能です。

（２）UEBA
**正答例**: 営業部門の社員が、深夜にシステム開発部門のサーバから大量の設計書ファイルをダウンロードしたことを検知し、アラートを発信する。
**誤答例**: 顧客情報を含む電子メールの添付ファイルを外部のドメイン宛に送信しようとした際に、送信を停止させる。
→ これはDLPの機能です。

７．よくある誤解と正しい知識
**誤解**: DLPは単にデータの移動を監視するだけである。
**正しい知識**: DLPはデータの「内容」を解析し、機密情報と判断されたデータに対して、その移動やコピー、印刷といった操作を制限する機能です。単なるトラフィック監視とは異なります。

**誤解**: UEBAは単なるログ監視ツールである。
**正しい知識**: UEBAはログを収集するだけでなく、機械学習を用いてユーザーや機器の「正常な行動パターン（ベースライン）」を学習し、そのパターンからの逸脱を分析・検知します。単純なキーワード検索やルールベースのログ監視とは根本的に異なる高度な分析手法です。

８．一問一答（5問：問題→回答→解説）
**問題１**
機密情報が定義されたルールに基づいて外部への送信を自動的にブロックするシステムは何か。
**回答１**
DLP（Data Loss Prevention）
**解説１**
DLPは、データの「内容」や「種類」に基づいて、ポリシー違反となる操作を防止する機能です。

**問題２**
ユーザーやエンティティの「通常」の行動パターンを機械学習で確立し、その逸脱を検知する技術は何か。
**回答２**
UEBA（User and Entity Behavior Analytics）
**解説２**
UEBAは、ルールベースではなく、行動分析によって未知の脅威や内部不正を発見することを目的とします。

**問題３**
DLPの主な監視対象として最も適切なものはどれか。
Ａ．ユーザーのログイン履歴
Ｂ．データのファイル名や内容
Ｃ．ネットワークのトラフィック量
**回答３**
Ｂ．データのファイル名や内容
**解説３**
DLPは、データそのものに着目し、その内容が機密情報に該当するかどうかを判断します。

**問題４**
UEBAが検知できる異常行動の例として不適切なものはどれか。
Ａ．夜間帯に通常業務で使わないアプリケーションから大量データをダウンロードする
Ｂ．過去にログイン実績のない端末から重要なシステムにアクセスする
Ｃ．不正なIPアドレスからの総当たり攻撃を検知する
**回答４**
Ｃ．不正なIPアドレスからの総当たり攻撃を検知する
**解説４**
総当たり攻撃（ブルートフォースアタック）は、IDS/IPSなどの従来のセキュリティシステムや、SIEMのルールベースで検知されることが一般的です。UEBAは「行動」の変化に着目します。

**問題５**
DLPとUEBAの関係として最も適切なものはどれか。
**回答５**
DLPがデータの移動を「静的に」制御するのに対し、UEBAはユーザーの行動を「動的に」分析して異常を検知する。
**解説５**
DLPはあらかじめ設定されたポリシーに基づいて「静的」に制御するのに対し、UEBAはリアルタイムな行動を分析して「動的」に脅威を検知するという違いがあります。両者は補完関係にあります。

９．要約（3行以内）
DLPは、データそのものに焦点を当て、機密情報の外部漏えいを防止する技術です。一方、UEBAは、ユーザーや機器の行動を分析し、異常な行動を検知することで内部不正や未知の脅威に対応します。両者は、データ中心か行動中心かの違いで、企業のセキュリティを多角的に強化する役割を担っています。




承知しました！
「DLP・UEBA・SIEM・EDR」に関連する技術群を、体系的にすべて洗い出して整理します。ここでいう「関連」とは、同じ目的領域（情報漏洩防止・行動分析・統合監視・端末防御）に含まれる周辺技術です。

---

# １　全体像（関連技術マップ）

```
【情報漏洩対策】
   └─ DLP
        ├─ CASB（クラウド利用時のDLP）
        ├─ DRM/IRM（ファイルへの利用制御）
        └─ MDM（モバイル端末のデータ制御）

【行動分析】
   └─ UEBA
        ├─ SIEM連携（ログの基盤上で動くことが多い）
        ├─ UBA（User Behavior Analytics：UEBAの前身）
        └─ AI/機械学習による異常検知

【統合監視】
   └─ SIEM
        ├─ SOAR（自動対応：SIEMの発展形）
        ├─ SOC（Security Operation Center：運用体制）
        └─ NDR（Network Detection and Response：ネットワーク挙動監視）

【端末防御】
   └─ EDR
        ├─ XDR（Extended Detection and Response：EDRの拡張）
        ├─ MDR（Managed Detection and Response：運用委託型EDR/XDR）
        └─ 次世代アンチウイルス（NGAV）
```

---

# ２　関連技術リスト（詳細）

## （１）DLP関連

* **CASB（Cloud Access Security Broker）**
  クラウド利用の際にDLP機能を適用する仕組み。
* **DRM/IRM（Digital Rights Management / Information Rights Management）**
  ファイル自体に「開ける人・使える操作」を制御。
* **MDM（Mobile Device Management）**
  スマホ・タブレットにおけるデータ漏洩防止。

## （２）UEBA関連

* **UBA（User Behavior Analytics）**
  UEBAの前身で、ユーザ行動のみを分析対象。
* **機械学習ベース異常検知**
  正常行動の統計モデルを作り、逸脱を検知。
* **SIEM連携**
  UEBAは単体よりSIEM上で動作することが多い。

## （３）SIEM関連

* **SOAR（Security Orchestration, Automation and Response）**
  SIEMで検知したイベントに対し、自動で対応（遮断・通報）。
* **SOC（Security Operation Center）**
  SIEMを中心とした運用組織。
* **NDR（Network Detection and Response）**
  ネットワーク通信の挙動を分析し、攻撃を検知。

## （４）EDR関連

* **XDR（Extended Detection and Response）**
  EDR＋NDR＋SIEM的機能を統合。広範囲で検知・対応。
* **MDR（Managed Detection and Response）**
  ベンダーや専門業者がEDR/XDRを運用代行。
* **NGAV（Next Generation Anti-Virus）**
  挙動分析やAIを用いた従来型アンチウイルスの進化系。

---

# ３　試験的に狙われやすい関連キーワード

* **DLP vs CASB**：「クラウド環境ならCASB」と出題されやすい。
* **UEBA vs SIEM**：「ログ分析」＝SIEM、「行動異常」＝UEBA。
* **EDR vs XDR**：「端末限定」＝EDR、「統合範囲拡大」＝XDR。
* **SIEM vs SOAR**：「検知」＝SIEM、「対応自動化」＝SOAR。

---

# ４　要約（3行以内）

* DLPは「データ保護」、CASB/DRM/MDMが周辺。
* UEBAは「行動異常検知」、SIEMと連携。
* EDRは「端末防御」、XDR/MDR/NGAVへ発展。

---
