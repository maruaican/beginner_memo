
---

# DLP（Data Loss Prevention）の体系的解説

## 1. DLPの概要

### 1.1. DLPとは何か：定義と目的

**DLP（Data Loss Prevention）**とは、機密情報（個人情報、顧客データ、設計情報など）が組織外へ不適切に漏えいすることを防止・検知・管理する技術や運用の総称です。

その名称が示す通り、**Data（データ） Loss（漏失） Prevention（防止）**、つまり「データ漏えいを事前に防ぐ」ことを直接的な目的としています。情報処理推進機構（IPA）は、「情報の持出しや不正送信を技術的に制御・監視する仕組み」と定義しています。

### 1.2. DLPの必要性：解決する具体的課題

DLPは、人為的ミスや意図的な不正行為に起因する、以下のような情報漏えいリスクに対処するために必要とされます。

*   **メール誤送信の検出と防止:** 宛先間違いや添付ファイル間違いによる機密情報流出リスクを低減します。
*   **不正な持ち出しの防止:** USBメモリなどの外部メディアや、個人用クラウドストレージへの機密情報の無断コピーやアップロードを防止します。
*   **内部不正の抑止と検知:** 内部関係者による意図的、あるいは非意図的な情報流出を検知し、対応を可能にします。
*   **クラウド利用の可視化と制御:** SaaSアプリケーションへアップロードされるデータを可視化し、ポリシーに基づいて制御します（CASB連携）。
*   **法令・契約の遵守:** 個人情報保護法やGDPR、業界規制、取引先との契約上の守秘義務に対応するための技術的制御と、インシデント発生時の証跡（ログ）を提供します。

### 1.3. DLPの全体像と動作ポイント

DLPは、データの流れにおける複数のポイントで検査と制御を行います。これらの各ポイントで、エージェントやプロキシなどがデータを検査し、**検出エンジン**が機密情報かどうかを判定します。判定結果に基づき、**ポリシー**に従って「監視」「警告」「遮断」「暗号化」などのアクションが実行され、その結果はログやアラートとして**SIEM**や**管理コンソール**に集約されます。

```mermaid
graph TD
    A[ユーザー操作@エンドポイント] -->|ファイル操作/USB/印刷| B(エンドポイントDLP);
    A -->|ネットワーク通信| C{FW/UTM/プロキシ};
    C -->|SSLインスペクション(復号)| D(ネットワークDLP);
    A -->|クラウドSaaSへのアップロード| E(クラウドDLP/CASB);
    B --> F[ポリシー適用: 遮断/警告/暗号化など];
    D --> F;
    E --> F;
```

## 2. DLPの技術的構成要素

### 2.1. 【どこで検査するか】配置場所による分類

DLPは、その機能が配置される場所によって大きく3種類に分類され、それぞれ監視対象と特徴が異なります。

| 分類 | 検査対象 | 特徴 |
| :--- | :--- | :--- |
| **エンドポイントDLP (Agent)** | ファイル操作、クリップボード、USB、印刷 | ユーザーのPC端末に直接導入。ユーザー行動を細かく制御でき、オフライン時も動作する。 |
| **ネットワークDLP (N-DLP)** | SMTP, HTTP(S), FTPなどのプロトコル | メールゲートウェイやプロキシなどに配置。ネットワークを通過するデータをリアルタイムで横断的に検査する（ミラー方式 or インライン方式）。 |
| **クラウドDLP (CASB)** | SaaSアプリケーション（Box, Google Drive, Microsoft 365など） | API連携などを通じて、クラウドサービス内に保存・共有されるデータを検査・制御する。 |

### 2.2. 【何を根拠に検出するか】検出技術の種類

DLPは、機密情報を特定するために様々な技術を組み合わせて使用します。

| 技術 | 概要と特徴 | 長所 | 短所 |
| :--- | :--- | :--- | :--- |
| **シグネチャ / ハッシュ** | データの内容が、登録済みの特定のパターン（シグネチャ）やハッシュ値と完全に一致するかを判定する。 | 高精度で誤検出が少ない。 | データが一部分でも変更されると検出できない（編集による回避に弱い）。 |
| **フィンガープリント**<br>**(文書ハッシュ)** | 特定の文書（顧客名簿、設計図など）を「指紋」として登録し、その文書と完全に一致するファイルを検出する技術。**文書ハッシュ**は、文書全体をハッシュ関数にかけて固定長の値を算出し、照合に用いる。 | 特定文書の確実な追跡・検出が可能で、改ざんされていなければ高精度に検出できる。 | 文書を1文字でも編集するとハッシュ値が変わり検出できなくなるため、バージョン違いやコピー改変に弱い。 |
| **正規表現** | クレジットカード番号、電話番号、マイナンバーなど、特定の書式・パターンを持つ文字列を検出する。 | 柔軟なパターン定義が可能。構造化データの検出に強い。 | キーワードの多義性やフォーマットのばらつきにより、誤検出（偽陽性）や検出漏れ（偽陰性）が発生しやすく、チューニングが必要。 |
| **コンテキスト解析** | データの内容だけでなく、送信者、宛先、ファイルの種類、時間帯、場所といった周辺情報（メタ情報）を組み合わせてポリシーを判断する。 | 状況に応じた柔軟な制御が可能。 | 設計が複雑になる傾向がある。 |
| **機械学習 (ML)** | ユーザーの通常のデータ操作パターンを学習し、それから逸脱する異常な振る舞い（大量ダウンロード、非勤務時間の大量転送など）を検出する。 | ルールベースでは見つけられない未知の漏えいパターンを検出できる。 | 学習データが必要。誤検出の理由を説明することが難しい（説明性の低さ）。 |
| **OCR (光学式文字認識)** | 画像ファイル（スキャンされたPDF、スクリーンショットなど）に含まれる文字列をテキストデータとして抽出し、他の検出技術と組み合わせて検査する。 | 画像に潜む機密情報を検出できる。 | 処理負荷が高い。認識精度は画像の品質（解像度、傾きなど）に依存する。 |

**※フィンガープリント技術の応用**
実務では、単純な「全体ハッシュ」だけでなく、文書を小さなブロックに分割してそれぞれハッシュ化し、類似度を計算することで「少し改変された文書」や「部分的に一致する文書」も検出可能な**コンテンツフィンガープリント**という改良版の仕組みも使われます。

### 2.3. 【検出後どうするか】ポリシーによるアクション

機密情報が検出された際に実行されるアクションは、事前に定義されたポリシーによって決定されます。

*   **監視 (Monitor):** ログを記録するだけで、通信や操作は許可する。
*   **警告 (Warn):** ユーザーに警告メッセージを表示し、操作を継続するか確認を求める。
*   **遮断 (Block):** 操作や通信を強制的に停止させる。
*   **暗号化 (Encrypt):** ファイルを自動的に暗号化してから送信・保存させる。
*   **隔離 (Quarantine):** ファイルを安全な場所に隔離し、管理者が確認するまでアクセス不能にする。
*   **管理者承認:** ユーザーの操作を一時停止し、管理者の承認を得てから実行を許可するフローを設ける。

## 3. DLPと関連セキュリティ技術

### 3.1. DLPは「機能」か「製品」か？

DLPは特定の「機器の名前」ではなく、**「技術・機能の総称」**と理解するのが適切です。市場には様々な形態でDLP機能が提供されています。

| 製品形態 | 説明 | 主な対象 |
| :--- | :--- | :--- |
| **専用DLP製品** | エンドポイントエージェント、ネットワーク監視、集中管理サーバなどをセットで提供する包括的なソリューション。 | 大規模組織向け |
| **他機器への機能組込み型** | NGFW, UTM, メールゲートウェイ, プロキシなどの既存のセキュリティ機器に「DLPオプション」として機能が追加される形態。 | 中小〜中規模組織向け |
| **クラウドサービス連携型 (CASB/SaaS)** | Microsoft 365やGoogle Workspaceなどのクラウドサービス自体に標準で搭載されているDLP機能。CASB製品の一部としても提供される。 | クラウド利用が中心の組織向け |

### 3.2. 関連技術との連携と役割分担

DLPは単体で機能するだけでなく、他のセキュリティ技術と連携することで、より強固な多層防御を実現します。

| 機器/技術 | DLPへの関わり方 | 強み | 弱み |
| :--- | :--- | :--- | :--- |
| **エンドポイントDLP** | USB、印刷、ファイル操作など端末上のデータ移動を直接制御する。 | 細かい粒度での制御が可能。オフラインでも動作する。 | 各端末への導入・管理コストが高い。 |
| **EDR** | マルウェア感染や不審なプロセスの実行など、端末の「挙動」を検知する。DLP機能は補助的。 | 端末内部の脅威や攻撃の検知に強い。 | データの中身（コンテンツ）の検査は限定的。 |
| **UEBA** | ユーザーの行動を分析し、通常とは異なる異常な行動（大量送信、深夜活動など）を検知。DLPの監視対象を特定するのに役立つ。 | 内部不正の予兆発見に有効。 | 誤検知が発生しやすく、ルールのチューニングが難しい。 |
| **SIEM** | DLPを含む各種セキュリティ機器のログを集中管理し、相関分析を行うことで、インシデントの全体像を可視化する。 | 横断的な視点で情報漏えいの追跡が可能。 | 単体では漏えいを防止（ブロック）できない。 |
| **フォワードプロキシ** | Web通信（HTTP/S）を中継し、アップロードされるファイルやPOSTデータをDLP機能で検査する。 | Web経由のアップロード制御に強い。 | SSLインスペクションが必須で、処理負荷が高い。 |
| **NGFW/UTM** | ネットワーク境界で通信を制御。アプリケーション識別機能とDLP機能を組み合わせて、特定のアプリによるファイル転送を検査する。 | ネットワーク境界で一括制御できる。 | 高度なコンテンツ検査よりもシンプルなパターンマッチが中心。高負荷時に遅延しやすい。 |

### 3.3. 基盤技術としてのDPI (Deep Packet Inspection)

ネットワークDLPを実現する基盤技術の一つが **DPI (Deep Packet Inspection)** です。

*   **定義:** ネットワークを流れるパケットを、IPアドレスやポート番号といった「ヘッダ情報」だけでなく、通信の「ペイロード（中身のデータ）」まで深く解析する技術です。
*   **役割:** NGFWやUTMに搭載され、パケットの中身を解析することで、マルウェアの検知や、DLPによる機密情報の検出を可能にします。DPIは、ネットワークDLPの実効性を担保する重要な技術です。

### 3.4. 暗号化通信(HTTPS)への対応：SSLインスペクションの重要性

HTTPSのような暗号化された通信の内容をネットワークDLP（およびDPI）で検査するためには、通信を一度復号する必要があります。この仕組みを**SSLインスペクション**と呼びます。

*   **仕組み:**
    1.  FWやプロキシなどの検査機器が、クライアントPCとWebサーバの間で「中間者」として動作します。
    2.  この機器は、自身の持つ**社内CAルート証明書**を使って、アクセス先のWebサイトの“偽装サーバ証明書”を動的に生成し、クライアントPCに提示します。
    3.  クライアントPCは、あらかじめ配布された社内CAルート証明書を信頼しているため、この通信を正常なものとして受け入れ、暗号化通信が検査機器で一旦復号されます。
    4.  検査機器は、復号された平文の通信データに対してDPI技術を用いたDLPなどのコンテンツ検査を行い、問題がなければ再度暗号化して本来のWebサーバへ転送します。
*   **結論:**
    *   **ネットワークDLPの実効性を持たせるには、SSLインスペクションができる機器（FW/UTM/プロキシ）で動かす必要があります。**
    *   エンドポイントDLPはPCローカルの操作を監視するため、SSLインスペクションは不要です。

## 4. DLPの運用と実践

### 4.1. ポリシー設計の勘所：成功例と失敗例

DLPの成否は、技術そのものよりもポリシー設計と運用に大きく依存します。

*   **成功例:**
    *   **例1:** メール送信前に「顧客マスタ」のフィンガープリントと完全に一致する添付ファイルを検出し、送信を阻止しつつ、自動的に暗号化して上長承認を求めるフローを適用する。
    *   **例2:** 外部クラウドストレージへの100MBを超える大容量ファイルの転送を検知した場合、即時ブロックはせず、「監視ログを記録し、管理者への承認依頼を必須とする」フローを適用する。
*   **失敗例:**
    *   **例1:** すべてのPDFファイルを社外送信禁止に設定した結果、業務で必要な見積書や納品書までブロックされ、業務が停止する。
    *   **例2:** 「機密」というキーワードだけで判定するルールを設定した結果、無関係なメールまで大量に検出し、アラートが形骸化する（誤検出の氾濫）。

### 4.2. 運用における注意点とよくある誤解

| 誤解 | 正しい知識 |
| :--- | :--- |
| DLPは導入すれば完全に自動で漏えいをゼロにできる。 | 技術的検出は補助であり、完璧ではありません。継続的なポリシーのチューニング、例外管理、そして従業員へのセキュリティ教育といった**運用**が不可欠です。 |
| 誤検出（False Positive）はゼロにすべきだ。 | 誤検出をゼロにしようとすると、検出感度が低下し、本当に防ぐべき漏えいを見逃す（False Negative）リスクが高まります。**リスク**と**業務可用性**のバランスを取るトレードオフの管理が必要です。 |
| DPIとDLPは同じものだ。 | DPIは「パケット内容解析技術」であり、DLPは「漏えい防止全体の仕組み」です。DPIはネットワークDLPを実現するための基盤技術の一つです。 |
| ネットワークDLPは暗号化通信を直接解析できる。 | 実際には、SSLインスペクションで通信を一度復号した後に検査を行います。 |
| エンドポイントDLPだけで対策は十分だ。 | エンドポイントは端末操作の制御に有効ですが、管理外デバイスからのアクセスやクラウド間のデータ移動など、ネットワークやクラウド経路の可視性は確保できません。複数レイヤーでの対策が重要です。 |

### 4.3. 性能に関する考慮事項

DLPの検査方式は、システムのパフォーマンスに影響を与える可能性があります。

*   **インライン検査:** 通信経路上でリアルタイムにデータを検査・ブロックする方式。セキュリティレベルは高いですが、検査処理による**レイテンシ（遅延）**が発生する可能性があります。特に高負荷時には性能低下を招くため、検査対象のプロトコルやデータ量を適切に絞り込むことが重要です。
*   **監視モード (ミラー方式):** 通信を止めずにコピーを検査する方式。システムへの負荷は低いですが、検知してもリアルタイムでのブロックはできないため、防止力は弱くなります。

## 5. （補足）情報処理技術者試験対策

### 5.1. 試験における頻出領域と着眼点

情報処理技術者試験などでは、以下の点が問われやすい傾向にあります。

*   **DLPの概念:** DLPが特定の「機器名」ではなく「機能の総称」であることを理解しているか。
*   **配置場所による3分類:** 「エンドポイント」「ネットワーク」「クラウド」それぞれのDLPの役割、長所・短所を説明できるか。
*   **検出技術の比較:** 「シグネチャ」「正規表現」「フィンガープリント」「機械学習」「OCR」などの各技術の特徴、長所・短所を理解しているか。
*   **DLPと基盤技術の関係:**
    *   **DPI:** ネットワーク通信の「中身」を解析することでDLPの実効性を担保する技術であること。
    *   **SSLインスペクション:** 暗号化通信の検査には必須であり、FW/UTM/プロキシがルート証明書を発行して実現すること。
*   **ポリシーの選択:** 状況に応じて「監視」「ブロック」「暗号化」などのアクションを適切に選択できるか。業務継続性とのバランスが問われる。
*   **他技術との区別:** 暗号化（盗聴防止）やアクセス制御（権限管理）と、DLP（持ち出し防止）の目的の違いを明確に区別できるか。

### 5.2. 試験で狙われやすい誤解（正答例・誤答例）

*   **正答例（試験で正しい選択肢）**
    *   「ネットワークDLPでは、暗号化通信をSSLインスペクションで復号してから内容検査を行う」
    *   「DLPは特定の製品ではなく、情報漏えいを防ぐための技術や機能の総称である」
*   **誤答例（試験作成者が狙う誤解）**
    *   「DLPは専用のファイアウォール機器である」
    *   「SSLインスペクションはDLPサーバ自身が行う機能である」
    *   「DPIは暗号化された通信を直接解析できる技術である」

### 5.3. 知識確認のための一問一答

**問1: DLPの主目的は何か？**
*   **回答:** 機密情報が組織外へ不正に流出することを防止・検知・管理すること。

**問2: ネットワークパケットの内容まで深く解析する技術を何と呼ぶか？**
*   **回答:** DPI（Deep Packet Inspection）。

**問3: HTTPS通信をネットワークDLPで検査するために必須となる仕組みは何か？**
*   **回答:** SSLインスペクション。

**問4: DLPで「フィンガープリント（文書ハッシュ）」を使う長所と短所は何か？**
*   **回答:** **長所**は、特定の文書の持ち出しを改ざんされていなければ高い精度で確実に検出できる点。**短所**は、文書が少しでも編集されるとハッシュ値が変わり検出できなくなる点。

**問5: ネットワークDLPをインライン（通過）モードで運用する際の注意点は何か？**
*   **回答:** 通信のレイテンシ（遅延）や可用性への影響、および高負荷時の性能低下。

**問6: 画像（スキャンされたPDFなど）に含まれる個人情報を検出したい場合、どの技術の組み合わせが有効か？**
*   **回答:** OCR（光学式文字認識）で画像からテキストを抽出し、そのテキストに対して正規表現やキーワードマッチングなどのテキスト解析を適用する。

**問7: 内部不正が疑われる従業員の異常な行動（深夜の大量ダウンロードなど）を検知するのに有効なDLPの検出技術は何か？**
*   **回答:** 機械学習（ML）による振る舞い分析。ユーザーの通常の行動パターンから逸脱する異常な振る舞いを検出する。

**問8: DLPと暗号化技術の根本的な目的の違いは何か？**
*   **回答:** DLPの目的は「正規の利用者による不正な持ち出し防止」であるのに対し、暗号化の目的は「権限のない第三者による盗聴や不正アクセスからのデータ保護」である。