# メールに関するセキュリティ技術 解説書（応用情報技術者試験対応）

## １　全体像（テキスト図）

```
メールセキュリティ技術
 ├─ メール送信の認証・暗号化
 │    ├─ SMTP-AUTH（送信時のユーザー認証）
 │    ├─ POP before SMTP（受信認証に基づく送信許可）
 │    └─ SMTP over SSL/TLS（通信暗号化・相互認証）
 │
 ├─ メール受信の認証・暗号化
 │    ├─ APOP（ハッシュによる認証）
 │    ├─ POP3S / IMAPS（TLSによる暗号化）
 │    └─ STARTTLS（平文通信から暗号化へ切替）
 │
 ├─ メール経路の暗号化
 │    └─ S/MIME, PGP（本文・添付ファイルの暗号化と署名）
 │
 └─ メールなりすまし対策
      ├─ SPF（送信元ドメイン認証）
      ├─ DKIM（電子署名による送信者認証）
      └─ DMARC（SPF＋DKIMの検証ポリシー）
```

---

## １－１　定義（IPA準拠）と用語の由来

* **SMTP-AUTH**

  * 定義：SMTPに「ユーザー認証機能」を追加した方式。
  * 語源：Simple Mail Transfer Protocol Authentication。
* **POP before SMTP**

  * 定義：POP3受信認証をトリガにして、一定時間だけSMTP送信を許可する仕組み。
* **APOP**

  * 定義：POP3認証においてパスワードをハッシュ化して送信する方式。
  * 語源：Authenticated POP。
* **IMAPS / POP3S**

  * 定義：受信プロトコルにTLSを適用して暗号化通信を行う方式。
* **SMTP over SSL/TLS**

  * 定義：SMTP通信をTLSで暗号化し、サーバ・クライアント相互認証を可能にする方式。
* **STARTTLS**

  * 定義：平文通信を開始後、TLSによって暗号化へ切り替える方式。
* **S/MIME / PGP**

  * 定義：メール本文や添付ファイルを暗号化・電子署名する方式。
* **SPF / DKIM / DMARC**

  * 定義：送信ドメイン認証技術。メールなりすまし（フィッシング）対策。

---

## １－２　技術の必要性（解決する具体的課題）

* SMTP標準は**認証機能がなく不正中継が可能** → スパム送信に悪用される
* POP3は**パスワードが平文送信** → 盗聴に弱い
* メールは**途中経路で盗聴・改ざんされる恐れ** → 暗号化・署名が必要
* フィッシングメールは**送信者なりすましが横行** → ドメイン認証が必要

---

## １－３　試験の着眼点（頻出領域／ひっかけ）

* **SMTP-AUTH と POP before SMTP の違い**を狙う問題が頻出
* **APOPは暗号化でなくハッシュ化**である点を狙う（盗聴対策は限定的）
* **IMAPS/POP3SとSTARTTLSの違い**（暗号化のタイミング）を問う
* **SPF/DKIM/DMARCの違い**を正確に理解させる問題が出題される
* **S/MIMEとPGP**（公開鍵基盤の有無）の比較を狙う

---

## １－４　体系マップ（分類・関係・比較表）

| 区分       | 技術                | 内容                      | 解決課題       |
| -------- | ----------------- | ----------------------- | ---------- |
| 認証（送信）   | SMTP-AUTH         | SMTP送信にユーザー名・パスワード認証を追加 | 不正中継防止     |
| 認証（送信）   | POP before SMTP   | POP3受信認証後にSMTP送信許可      | 古い代替策      |
| 認証（受信）   | APOP              | パスワードをハッシュ化して送信         | 平文送信防止     |
| 暗号化通信    | SMTP over SSL/TLS | サーバ・クライアント間の通信暗号化       | 盗聴防止       |
| 暗号化通信    | IMAPS / POP3S     | 受信プロトコルの暗号化             | 盗聴防止       |
| 暗号化通信    | STARTTLS          | 平文通信→暗号化切替              | 移行期対策      |
| メール本文暗号化 | S/MIME / PGP      | 本文・添付ファイル暗号化／署名         | 内容保護・改ざん検出 |
| ドメイン認証   | SPF               | 送信元IPとDNS照合             | なりすまし防止    |
| ドメイン認証   | DKIM              | 電子署名で送信者認証              | 改ざん防止      |
| ドメイン認証   | DMARC             | SPF/DKIM結果を基に受信側ポリシー適用  | フィッシング防止   |

---

## １－５　代表例（正答例・誤答例）

* 正答例：

  * 「SMTP-AUTHは、送信時にユーザー認証を行い、不正中継を防ぐ」
* 誤答例：

  * 「APOPは暗号化通信を行う」→誤り（ハッシュ化であり暗号化ではない）
  * 「POP before SMTPは現在も標準的に利用される」→誤り（ほぼ廃止傾向）

---

## １－６　よくある誤解と対処

* 誤解：「SMTPには標準で認証機能がある」
  → 実際には標準SMTPには認証がなく、SMTP-AUTHで拡張する。

* 誤解：「APOPは暗号化」
  → 実際はMD5ハッシュを使うだけで盗聴に弱い。

* 誤解：「SPFだけでなりすまし防止可能」
  → SPF単独ではFrom偽装に対応できず、DKIMやDMARCと併用が必要。

---

## １－７　一問一答（例）

**問題１**
SMTP-AUTHの目的は何か。
**回答**：SMTP送信にユーザー認証を導入し、不正中継を防止する。
**解説**：標準SMTPは認証なし。不正利用防止に必要。

---

**問題２**
POP before SMTPの仕組みを説明せよ。
**回答**：受信認証成功クライアントのIPアドレスに一定時間だけSMTP送信を許可する。
**誤答例**：「SMTP送信の際にユーザーIDとパスワードを直接確認する」→それはSMTP-AUTH。

---

**問題３**
APOPはどのようにパスワードを保護するか。
**回答**：パスワードをMD5でハッシュ化して送信する。
**誤答例**：「TLSで暗号化する」→それはPOP3S/IMAPS。

---

**問題４**
SPF・DKIM・DMARCの関係を説明せよ。
**回答**：

* SPF：送信元IPの正当性確認
* DKIM：電子署名で改ざん検出
* DMARC：SPF/DKIM結果に基づく受信側ポリシー適用

---

**問題５**
S/MIMEとPGPの違いは何か。
**回答**：S/MIMEは公開鍵基盤（PKI）を利用、PGPは利用者間で公開鍵を配布する。

---

## １－８　要約（3行以内）

メールセキュリティは「認証」「暗号化」「なりすまし防止」の三本柱。
SMTP-AUTHやAPOPで認証を補強し、TLSやS/MIMEで暗号化を行う。
SPF/DKIM/DMARCでなりすましを防ぎ、フィッシング対策を強化する。

---

## １－９　次アクション（復習間隔と演習提案）

* 翌日：SMTP-AUTHとPOP before SMTPの違いを再確認。
* ３日後：APOPとTLS（POP3S/IMAPS/STARTTLS）の違いを比較演習。
* １週間後：SPF/DKIM/DMARCを絡めた総合問題演習。

---

👉質問です。この解説書に、**「S/MIMEとPGPの暗号化／署名の利用手順」**（鍵の仕組みを含む詳細フロー）も追加しますか？それとも試験頻度が高いSMTP系中心で十分にしますか？
