# 外部キーと主キーの関係に関する理解と整理

## はじめに

本資料は、リレーショナルデータベースにおける「外部キー」と「主キー」の関係、特に複合主キーとの関係性についての疑問に対し、丁寧に整理・解説したものです。

## 疑問の出発点

部署表は、会社番号＋部署番号で一意とされる。これは部署表の主キーが複合主キーであるため理解できる。

しかし、従業員表では部署番号が外部キーである。外部キーである以上、それ自体が主キーではないにも関わらず、なぜ会社番号＋部署番号で部署が一意に特定できるのか、という点が疑問として挙がった。

## 主キーと外部キーの基本

主キーとは、表の中で各行を一意に識別するための列または列の組み合わせである。

外部キーとは、<u>他の表の主キー</u>を参照する列であり、多くの場合、1対多の関係における「多」の側に存在する。

## 外部キーでも一意に特定できる理由

外部キーが参照しているのは、常に<u>他の表の主キー</u>である。

主キーは一意であるため、参照元の外部キー（例：会社番号＋部署番号）から参照先の主キーに一致する行は、常に1行だけに決まる。

つまり、**<u>外部キーであっても、参照先の主キーが一意</u>**であれば、それを指定することで特定の行（レコード）を一意に特定できる。

これは、「主キーを参照する」という性質により担保される。

## 構造図（概念）

従業員表（外部キー） → 部署表（主キー）  
会社番号 会社番号（PK）  
部署番号 ─────参照──→ 部署番号（PK）  
  
→ 外部キーは主キー（複合キー）を参照する構造  
→ <u>外部キーで一意に</u>部署を特定可能

## 外部キーと「多」の関係

リレーショナルモデルでは、複数の外部キーが同一の主キーを参照することは許されている。

これが「1対多」の関係であり、外部キーが『多』の側にあることを意味する。

ただし、1つの外部キーが複数の主キーに対応することは構造的に不可能である。

したがって、**<u>外部キーが指す主キーの行は常に1行</u>**に定まる。

## まとめ

・**<u>外部キーは『主キーの中の1行』を参照</u>**している。  
・**<u>その主キーは一意</u>**であるため、外部キーを使っても特定が可能。  
・主キーと外部キーは単純な「主か外か」の関係だけでなく、『何を参照し、どのように一意性を保証するか』の視点で理解することが重要である。  
  
この理解ができれば、SQLのJOIN句やON句で「なぜその項目で結合するのか」が自然に見えてくるようになります。
