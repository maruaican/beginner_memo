## 応用情報技術者試験 午後セキュリティ問題 解説改良版

## 令和6年秋期 午後問1：Webサイトのセキュリティ

### ［設問］1
(1) ゼロトラスト
(2) a: ZTNA, b: SWG, c: CASB
(3) イ（SASEを導入することによって、ネットワーク機能とネットワークセキュリティ機能をクラウド上で統合して導入及び運用できるので、管理の複雑さの低減やコストの削減が期待できる。）

### ［解説］
・用語
*   **ゼロトラスト (Zero Trust)**: 「信頼せず、常に検証する（Never Trust, Always Verify）」という原則に基づき、ネットワークの内部・外部を問わず、全てのアクセスを検証するセキュリティの考え方です。
*   **ZTNA (Zero Trust Network Access)**: ゼロトラストの考えに基づき、ユーザやデバイス単位でアクセス先のリソースへの動的なアクセス制御を行う技術です。
*   **SWG (Secure Web Gateway)**: ユーザが社外のWebサイトへアクセスする際に通信を監視し、不正なサイトへのアクセスを遮断するなど、脅威となる通信をフィルタリングするセキュリティソリューションです。
*   **CASB (Cloud Access Security Broker)**: 従業員によるクラウドサービスの利用状況を可視化・制御し、一元的に管理するソリューションです。
*   **SASE (Secure Access Service Edge)**: ネットワーク機能とセキュリティ機能をクラウド上で統合して提供するフレームワークです。ZTNA、SWG、CASBなどの機能を包含します。

・技術的背景：
(1) 問題文にある「社内LANからのアクセスであっても信用せず、全てのアクセス元のデバイスの健全性を評価した上で、アクセスを許可する」という記述は、ゼロトラストセキュリティモデルの基本的な考え方を明確に示しています。従来の境界型防御モデルとは異なり、内部ネットワークからのアクセスも信頼しない点が特徴です。

**【受験者向け発展解説】**
「境界型防御」の限界がなぜ叫ばれるようになったのか、その背景を理解することが重要です。クラウドサービス（SaaS, IaaS）の利用やテレワークの普及により、「守るべき情報資産」と「アクセスする従業員」が社内ネットワークの**外**にいることが当たり前になりました。この結果、社内と社外を分ける「境界」の概念自体が曖昧になったのです。
ゼロトラストは、この現状に対応するためのパラダイムシフトです。「デバイスの健全性」とは、具体的にはOSやソフトウェアに最新のセキュリティパッチが適用されているか、ウイルス対策ソフトが最新の状態で稼働しているか、といった点を指します。今後の試験では、この健全性を評価し、アクセスポリシーを一元管理する**IDaaS (Identity as a Service)** や、デバイス管理を行う**MDM/UEM (Unified Endpoint Management)** といった技術との連携が問われる可能性があります。

(2)
*   **a: ZTNA**: リモートアクセスしてきたPCから、許可された業務サーバへのアクセスを実現する機能は、ZTNAの役割です。定義されたアクセスポリシーに基づき、アプリケーションやサービスへの安全なリモートアクセスを提供します。
*   **b: SWG**: PCからインターネット上のWebサイトへのアクセスを監視し、不正なサイトへのアクセスを遮断する機能はSWGの役割です。
*   **c: CASB**: 許可されていないクラウドストレージの利用を禁止する機能は、CASBが提供します。CASBは従業員のクラウドサービス利用を可視化し、企業のセキュリティポリシーに準拠させるための制御を行います。

**【受験者向け発展解説】**
ZTNA, SWG, CASBは、ゼロトラストを実現するための具体的なソリューション群です。それぞれの守備範囲を正確に理解しましょう。
*   **ZTNA**: 社外から**社内**のリソースへのアクセスを制御します。（VPNの代替技術）
*   **SWG**: 社内/社外から**インターネット(Webサイト)**へのアクセスを制御します。
*   **CASB**: 社内/社外から**クラウドサービス(SaaSなど)**へのアクセスを制御します。
この3つは機能が重複する部分もあり、統合して提供されるのが次項のSASEです。それぞれの技術が「どこから」「どこへの」通信を守るものなのかを整理しておくと、設問で混同することがなくなります。

(3) SASEは、ZTNA、SWG、CASBといった複数のセキュリティ機能と、SD-WANのようなネットワーク機能をクラウドサービスとして統合的に提供します。これにより、各機能を個別に導入・運用する場合と比較して、管理がシンプルになり、コスト削減にも繋がるというメリットがあります。

**【受験者向け発展解説】**
SASE (サシー) は、ネットワーク機能とセキュリティ機能を**クラウド上で統合**する点に本質があります。今後の出題として、SASEからセキュリティ機能群だけを切り出した**SSE (Security Service Edge)** という用語が問われる可能性があります。`SASE = ネットワーク機能(SD-WAN) + セキュリティ機能(SSE)` という関係性を押えておきましょう。多くの企業ではまずSSEを導入し、段階的にSASEへと移行するケースが多いため、SSEは非常に重要なキーワードです。SASEのメリットとして「管理の複雑さの低減」が挙げられるのは、各拠点のファイアウォールやプロキシサーバを個別に管理するのではなく、クラウド上の単一のコンソールでポリシーを一元管理できるためです。

---
### ［設問］2
(1) ア（インシデントの封じ込め）
(2) エ（PC、プロキシサーバ、EDR製品のログを一元的に集めて分析し、サイバー攻撃の兆候を早期に発見する。）

### ［解説］
・用語
*   **EDR (Endpoint Detection and Response)**: PCやサーバなどのエンドポイントを監視し、不審な挙動を検知して迅速な対応を支援するセキュリティソリューションです。
*   **SIEM (Security Information and Event Management)**: 様々な機器からログ情報を収集し、それらを相関分析することで脅威を検知・通知する仕組みです。

・技術的背景：
(1) EDRの機能によって不審な通信が検知されたPCをネットワークから論理的に遮断する行為は、インシデント対応における「封じ込め」の活動に該当します。これは、検知した脅威が他の機器へ拡散するのを防ぎ、被害を最小限に抑えるための重要な措置です。

**【受験者向け発展解説】**
インシデント対応のフェーズ「**検知→封じ込め→根絶→復旧**」は必ず覚えておきましょう。EDRが担うのは主に「検知」と「封じ込め」の支援です。
従来のアンチウイルスソフト（**EPP: Endpoint Protection Platform**）が既知のマルウェアをパターンファイルで検知する「入り口対策」であるのに対し、**EDR**はPC内部での不審な振る舞い（プロセス起動、通信など）を監視し、侵入されてしまった後の「事後対策」を担います。この**EPPとEDRの違い**は頻出論点です。EDRは侵入を前提とした対策であることを理解することが重要です。

(2) SIEMの主な導入目的は、PC、プロキシサーバ、EDRなど、様々なセキュリティ製品やネットワーク機器から出力される大量のログを一元的に収集・管理し、相関分析を行うことです。これにより、単体の機器では見つけにくいサイバー攻撃の兆候を早期に発見し、迅速な対応を可能にします。

**【受験者向け発展解説】**
SIEM (シーム) のキーワードは「**相関分析**」です。例えば、「(A)プロキシサーバで不審なIPアドレスへの通信を検知」し、同時刻に「(B)EDRで特定のPCに不審なプロセスを検知」した場合、これらを関連付けて一つの重大なアラートとして通知するのが相関分析です。
さらに発展的な概念として、EDRの進化形である**XDR (Extended Detection and Response)** や、インシデント対応の自動化を行う**SOAR (Security Orchestration, Automation and Response)** があります。
*   **XDR**: エンドポイントだけでなく、ネットワーク、クラウドなど複数の領域から情報を収集・分析し、EDRより広範囲な脅威検知を目指します。
*   **SOAR**: SIEMやXDRからのアラートをトリガーに、「不審なIPアドレスをFWで自動的にブロックする」といった対応作業を自動化します。
これらの関係性を理解しておくと、応用力が格段に向上します。

***

## 令和6年春期 午後問1：リモート環境のセキュリティ対策

### ［設問］1
イ（パケットフィルタリングのポリシーで許可していない通信による内部ネットワークへの侵入）

### ［解説］
・技術的背景：
従来の「境界型防御」は、社内ネットワーク（内部）とインターネット（外部）の間にファイアウォールなどの境界を設け、その境界を通過する通信を監視・制御することで内部を守るという考え方です。選択肢イの「パケットフィルタリングのポリシーで許可していない通信による内部ネットワークへの侵入」は、まさにこのファイアウォールが境界で防ぐべき脅威の典型例であり、境界型防御で対策されるべき事象です。

**【受験者向け発展解説】**
ファイアウォールの基本的な機能である「パケットフィルタリング」は、通信のヘッダ情報（IPアドレス、ポート番号など）を見て通信を制御します。これに対し、より高度なファイアウォールとして、通信の中身（データ部）まで見てアプリケーションレベルの攻撃を防御する **WAF (Web Application Firewall)** や、通信の文脈（過去の通信との関連性）を考慮する**ステートフルパケットインスペクション**機能を持つファイアウォールがあります。境界型防御の文脈では、これらのファイアウォールの種類の違いと役割を理解しておくことが重要です。

---
### ［設問］2
(1) a: ゼロトラスト
(2) セキュリティパッチ提供の調査及び適用の判断

### ［解説］
・用語
*   **ゼロトラスト**: 「何も信頼せず、常に検証する（Never Trust, Always Verify）」という概念に基づき、社内LANからのアクセスであっても安全であるとは見なさず、全てのアクセス元のデバイスの健全性を評価した上でアクセスを許可するセキュリティモデルです。

・技術的背景：
(1) クラウドサービスの利用やテレワークが普及し、社内と社外の境界が曖昧になった現代において、従来の境界型防御モデルでは対応が困難になりました。そこで、アクセス元がどこであっても信頼せず、常に検証を行う「ゼロトラスト」の考え方が重要視されるようになりました。

**【受験者向け発展解説】**
この設問のように、近年の情報セキュリティ問題は「テレワーク」や「クラウド利用」といった具体的な業務シーンを題材にすることが非常に多いです。技術用語を単体で覚えるのではなく、「テレワーク環境におけるセキュリティリスクを低減するためには、ゼロトラストの考えに基づき、ZTNAやSASEを導入する」といったように、**課題と解決策をセットで理解する**ことが応用力を高める上で非常に効果的です。

(2) 私物PCなど、会社が管理していないデバイスを業務に利用する場合、OSやソフトウェアの脆弱性を突かれるリスクが高まります。そのため、利用を許可する前に、セキュリティパッチが適切に適用されているかを確認し、必要に応じて適用を判断するプロセスが不可欠です。

**【受験者向け発展解説】**
私物端末の業務利用は **BYOD (Bring Your Own Device)** と呼ばれます。BYODを許可する場合、企業はデバイス全体の管理が難しくなるため、セキュリティとプライバシーのバランスが課題となります。この課題を解決する技術として **MAM (Mobile Application Management)** があります。MAMはデバイス全体ではなく、業務で利用するアプリケーションとそのデータのみを管理領域（コンテナ）に隔離し、その中だけを企業の管理下に置きます。これにより、従業員のプライバシーを守りつつ、業務データの安全性を確保できます。MDMとの違いを理解しておきましょう。

---
### ［設問］3
(1) URLフィルタリング, 業務上不要なサイトへの接続禁止
(2) セキュリティインシデントの発生を迅速に検知するため
(3) ア（MDMの機能を利用して、会社が指定したアプリケーション以外のインストールを禁止する。）、ウ（MDMの機能を利用して、PCの紛失時に遠隔でPC内のデータを消去する。）

### ［解説］
・用語
*   **URLフィルタリング**: アクセス先のURL情報に基づき、特定のカテゴリ（ギャンブル、SNSなど）や個別に指定したWebサイトへのアクセスを制限する機能です。
*   **SIEM (Security Information and Event Management)**: 各種の機器やソフトウェアからログを収集・分析し、セキュリティインシデントの兆候を検知して管理者に通知する仕組みです。
*   **MDM (Mobile Device Management)**: 会社が従業員に貸与するPCやスマートフォンなどのモバイルデバイスを、遠隔から一元的に管理・設定するためのシステムです。

・技術的背景：
(1) プロキシサーバを介してインターネットに接続させることで、通信を一元的に監視・制御できます。URLフィルタリング機能を用いて、業務に関係のないサイトや、マルウェア配布の危険性があるサイトへのアクセスを禁止することは、情報漏えいやウイルス感染のリスクを低減する基本的な対策です。

**【受験者向け発展解説】**
URLフィルタリングは、既知の不正サイトへのアクセスを防ぐ有効な手段ですが、未知のサイトや、改ざんされた正規サイトからの脅威には対応しきれない場合があります。そのため、SWGなどのソリューションでは、URLフィルタリングに加え、Webサイトからダウンロードされるファイルを仮想環境で実行してみる**サンドボックス**機能や、通信内容そのものを詳細に検査する機能が統合されています。

(2) EDR、プロキシサーバ、認証サーバなど、様々なセキュリティ製品のログをSIEMで一元的に収集し、相関分析を行うことで、単体の製品では見逃してしまうような巧妙な攻撃の兆候も検知しやすくなります。これにより、インシデントの早期発見と迅速な対応が可能となります。

**【受験者向け発展解説】**
（令和6年秋期の解説と重複するため割愛）

(3) MDMは、貸与PCのセキュリティを維持するための強力なツールです。許可していないアプリケーションのインストールを禁止することで、マルウェアの侵入経路を減らします。また、万が一PCを紛失したり盗難に遭ったりした場合でも、遠隔操作でデータを消去（リモートワイプ）することにより、情報漏えいを防ぐことができます。

**【受験者向け発展解説】**
MDMの機能である「リモートワイプ」には、デバイス全体を初期化する「フルワイプ」と、業務データ領域のみを選択して消去する「セレクティブワイプ」があります。特に私物端末を利用するBYOD環境では、従業員のプライベートなデータを消去してしまわないよう、後者の「セレクティブワイプ」が重要となります。MDMから派生した**MAM**や**MCM (Mobile Content Management)** は、このセレクティブワイプを実現するための技術です。

---
### ［設問］4
(1) ア（EDRの機能によって、貸与PCでのマルウェアの活動を検知し、貸与PCをネットワークから遮断する。）
(2) b: 多要素認証

### ［解説］
・用語
*   **EDR (Endpoint Detection and Response)**: PCやサーバなどのエンドポイントを監視し、不審な挙動を検知して、その後の対応（調査、隔離など）を支援するセキュリティソリューションです。
*   **多要素認証 (MFA)**: 認証の三要素である「知識情報（パスワードなど）」「所持情報（スマートフォンなど）」「生体情報（指紋など）」のうち、二つ以上を組み合わせて認証を行う方式です。

・技術的背景：
(1) 貸与PCがマルウェアに感染してしまった場合、EDRはその不審な活動（例：外部サーバへの不正な通信、設定ファイルの改ざんなど）を検知します。そして、被害の拡大を防ぐため、そのPCをネットワークから自動的に隔離する（封じ込め）といった対応を行います。これは、インシデント対応の迅速化に貢献します。

**【受験者向け発展解説】**
EDRの検知能力は、エンドポイント上で何が起きているかを詳細に記録する「ログ収集能力」に依存します。攻撃者は検知を逃れるため、OSの正規ツール（PowerShellなど）を悪用して不正な活動を行うことがあります。これを**ファイルレスマルウェア攻撃**や**環境寄生型（Living Off The Land）攻撃**と呼びます。EDRは、このような正規ツールによる「通常とは異なる振る舞い」を検知できる点が、従来のアンチウイルスソフトに対する大きな優位性です。

(2) IDとパスワードのみの認証では、それらが漏えいした場合に簡単になりすましを許してしまいます。そこで、本人しか持ち得ないスマートフォンへの通知や、指紋認証などを組み合わせた「多要素認証」を導入することで、認証プロセスを強化し、不正アクセスのリスクを大幅に低減します。

**【受験者向け発展解説】**
多要素認証(MFA)は非常に強力ですが、万能ではありません。例えば、フィッシングサイトでID、パスワード、そしてワンタイムパスワードまで入力させて突破する手口や、スマートフォンのプッシュ通知に対して利用者が疲労から安易に「許可」を押してしまう**MFA疲労攻撃**などが存在します。
これらへの対策として、より安全な認証方式である**FIDO (Fast IDentity Online)** や、ログイン時の状況（場所、時間、デバイスなど）を評価してリスクが高い場合のみ追加認証を要求する**リスクベース認証**といった技術が重要視されています。

***

## 令和5年秋期 午後問1：電子メールのセキュリティ対策

### ［設問］1
(1) ウ（誤送信した宛先に添付ファイルとDPWが届き，添付ファイルが復元される。）
(2) 本文メールの伝送経路とは異なる伝送経路でPWメールを送る。

### ［解説］
・用語
*   **PPAP**: パスワード付きZIPファイルをメールで送信し、そのパスワードを別のメールで後から送信するファイル共有手法を指す、日本で生まれた俗称です。

・技術的背景：
(1) PPAP方式の大きな問題点は、ファイルとパスワードが同じ通信経路（電子メール）で送られることです。メールを誤送信してしまった場合、続くパスワード通知メールも同じ宛先に送ってしまう可能性が非常に高く、受信者にファイルが復元されてしまいます。また、通信経路が盗聴されていた場合、両方のメールが攻撃者の手に渡り、容易にファイルを解読されてしまいます。

**【受験者向け発展解説】**
PPAPが「経路が同じ」という問題点に加えて、もう一つセキュリティ上の大きな弱点があります。それは、**パスワード付きZIPファイルはウイルススキャンができない**という点です。メールゲートウェイなどのセキュリティ製品は、暗号化されたZIPファイルの中身を検査できないため、マルウェアがすり抜けて従業員のPCに届いてしまう危険性があります。この点もPPAPが廃止されるべき理由として頻繁に指摘されます。代替策としては、**クラウドストレージのファイル共有リンク（パスワード設定、有効期限設定が可能）**の利用が推奨されています。

(2) 本文メールとパスワード通知メールを、異なる経路（例：一方は電子メール、もう一方はビジネスチャット）で送信することにより、仮に一方の経路が盗聴されたとしても、ファイルとパスワードが同時に漏えいするリスクを低減できます。

**【受験者向け発展解説】**
この対策は「二経路認証」の考え方を応用したものです。しかし、これはPPAPの問題を根本的に解決するものではなく、あくまで緩和策に過ぎません。依然として「ウイルススキャンができない」という問題は残ります。政府機関や多くの企業が「PPAP廃止」を宣言している背景には、こうした複数の問題点があることを理解しておくことが重要です。

---
### ［設問］2
(1) BEC
(2) ア（送信ドメイン認証に失敗したメールを拒否又は隔離する。）

### ［解説］
・用語
*   **BEC (Business Email Compromise / ビジネスメール詐欺)**: 企業の経営者や取引先になりすました偽のメールを従業員に送り付け、送金を指示するなどして金銭を騙し取る詐欺行為です。
*   **送信ドメイン認証 (SPF, DKIM, DMARC)**: メールの送信元ドメインが詐称されていないかを検証するための技術の総称です。

・技術的背景：
(1) 問題文にある「A社の経営幹部になりすまして財務担当者に偽の送金指示のメールを送る」という手口は、ビジネスメール詐欺（BEC）の典型的なシナリオです。

**【受験者向け発展解説】**
BECは、マルウェアの添付や不正なURLへの誘導を行わない、**文面のみのソーシャルエンジニアリング**である場合が多いのが特徴です。そのため、ウイルス対策ソフトやURLフィルタリングといった従来のセキュリティ製品では検知が困難です。送信ドメイン認証が有効な対策となるのはこのためです。

(2) BECなどのなりすましメール対策として、送信ドメイン認証は非常に有効です。SPFやDKIMの認証に失敗したメール、つまり正規のサーバから送られていない可能性が高いメールを、DMARCのポリシーに従って受信拒否したり、迷惑メールフォルダに隔離したりすることで、利用者が騙されるリスクを大幅に低減できます。

**【受験者向け発展解説】**
SPF, DKIM, DMARCの役割分担を明確にしましょう。
*   **SPF (Sender Policy Framework)**: 送信元IPアドレスを検証します。「このドメインからのメールは、このIPアドレスのサーバから送られます」という宣言です。
*   **DKIM (DomainKeys Identified Mail)**: 電子署名でメールの改ざんがないかを検証します。「このメールは確かに私が送ったもので、途中で改ざんされていません」という証明です。
*   **DMARC (Domain-based Message Authentication, Reporting, and Conformance)**: SPFとDKIMの**両方（またはいずれか）**の認証に失敗したメールを**どう扱うか**を、送信側がポリシーとして宣言する仕組みです。ポリシーには `p=none` (何もしない), `p=quarantine` (隔離), `p=reject` (拒否) があり、この設定が重要となります。DMARCはSPFとDKIMを補強する役割と覚えてください。

---
### ［設問］3
(1) c: PTR
(2) 逆引きできないIPアドレスからのメールは、迷惑メールの可能性が高いと判断されるから。

### ［解説］
・用語
*   **DNS (Domain Name System)**: ドメイン名とIPアドレスを対応付ける仕組みです。
*   **逆引き**: IPアドレスからドメイン名を調べることです。
*   **PTRレコード**: 逆引きに使われるDNSレコードです。

・技術的背景：
(1) IPアドレスからドメイン名を問い合わせるDNSの逆引きには、PTRレコードが使用されます。

**【受験者向け発展解説】**
ドメイン名からIPアドレスを調べることを「正引き」といい、Aレコードが使われます。IPアドレスからドメイン名を調べるのが「逆引き」で、PTRレコードが使われます。この「正引き」と「逆引き」はセットで覚えておきましょう。

(2) 多くのメールサーバは、迷惑メール対策の一環として、受信したメールの送信元IPアドレスに対してDNSの逆引きを行います。もし逆引きができない（PTRレコードが設定されていない）場合や、逆引きして得られたドメイン名と、メールのヘッダ情報にあるドメイン名が一致しない場合、そのメールは迷惑メール送信者から送られてきた可能性が高いと判断され、受信を拒否されたり、迷惑メールとして扱われたりすることがあります。

**【受験者向け発展解説】**
この仕組みは **FCrDNS (Forward-confirmed reverse DNS)** または **Full-circle reverse DNS** と呼ばれます。具体的には、(1)送信元IPアドレスを逆引きしてドメイン名Aを取得し、(2)そのドメイン名Aを再度正引きしてIPアドレスBを取得し、(3)元の送信元IPアドレスとIPアドレスBが一致するかを確認する、という手順です。これが一致しない場合、送信者の信頼性が低いと判断されます。SPFなどと並行して利用される古典的ですが有効な迷惑メール対策の一つです。

---
### ［設問］4
エ（メールに電子署名を付け、その電子署名をS/MIMEに対応したメールソフトで検証することによって、送信元の正当性とメールの改ざんの有無を確認する。）

### ［解説］
・用語
*   **S/MIME (Secure/Multipurpose Internet Mail Extensions)**: 電子メールの暗号化と電子署名に関する標準規格です。公開鍵暗号技術を利用して、「盗聴防止（暗号化）」「改ざん検知」「なりすまし防止（送信元の認証）」を実現します。

・技術的背景：
S/MIMEを利用すると、送信者は自身の秘密鍵でメールに電子署名を行います。受信者は、送信者の公開鍵（通常は電子証明書に含まれる）を使ってその署名を検証します。検証に成功すれば、そのメールが確かにその送信者から送られたものであり、途中で改ざんされていないことが証明されます。これにより、送信元の正当性を確認し、なりすましを防止できます。

**【受験者向け発展解説】**
S/MIMEは非常に強力な技術ですが、普及には課題があります。それは、送信者と受信者の双方がS/MIMEに対応したメールソフトを使い、かつ、送信者は事前に自身の電子証明書（公開鍵と秘密鍵のペア）を取得しておく必要があるため、導入のハードルが高い点です。
DKIMも電子署名を利用しますが、S/MIMEとは目的と仕組みが異なります。
*   **DKIM**: 送信**ドメイン**のなりすましを防ぐ。サーバ間で自動的に検証される。
*   **S/MIME**: 送信**者個人**のなりすましを防ぐ。利用者（メールソフト）が検証する。
この違いを理解しておくと、より深い知識となります。

***

## 令和5年春期 午後問1：マルウェア対策

### ［設問］1
(1) a: 潜伏・内部活動, b: C2サーバ
(2) 添付ファイルの拡張子を表示する設定にし、偽装に気付けるようにする。

### ［解説］
・用語
*   **サイバーキルチェーン**: 標的型攻撃などのサイバー攻撃を、偵察から目的実行までの一連の流れとして捉え、段階ごとに分析するモデルです。「潜伏・内部活動」は、攻撃者が内部ネットワークに侵入後、目的達成のために潜行し、情報を収集したり、さらに内部へ侵攻したりする段階を指します。
*   **C2サーバ (コマンド&コントロールサーバ)**: 攻撃者が、マルウェアに感染させたコンピュータ（ボット）に対して指令を送ったり、窃取した情報を送信させたりするために設置する、司令塔の役割を持つサーバです。

・技術的背景：
(1) 攻撃者は、まず標的型攻撃メールなどでPCをマルウェアに感染させ（初期侵入）、その後、PC内部やネットワーク内部で活動を広げます（**a: 潜伏・内部活動**）。感染したPCは、インターネット上にある**b: C2サーバ**と通信を確立し、攻撃者からの遠隔操作を受ける状態になります。

**【受験者向け発展解説】**
「サイバーキルチェーン」は攻撃者目線での攻撃ステップのモデル化です。近年では、より詳細な攻撃者の戦術・技術を体系化した**MITRE ATT&CK (マイターアタック)** フレームワークが注目されています。ATT&CKは、例えば「初期侵入」「潜伏」「権限昇格」「横展開(ラテラルムーブメント)」といった各戦術(Tactics)の中に、具体的な攻撃技術(Techniques)がマッピングされています。EDRやSIEMのアラートが、このATT&CKのどの技術に該当するかを分析することで、攻撃の全体像を把握しやすくなります。今後の試験でATT&CKの考え方に基づく設問が出題される可能性は十分にあります。

(2) 攻撃者は、実行ファイルの拡張子（.exeなど）を文書ファイル（.pdfなど）に見せかけるために、アイコンを偽装したり、ファイル名を「文書.pdf.exe」のように偽装したりします。Windowsのデフォルト設定では既知の拡張子は表示されないため、拡張子を常に表示する設定に変更しておくことで、このような偽装を見破りやすくなります。

**【受験者向け発展解説】**
この手口は「二重拡張子」とも呼ばれます。Windowsの「登録されている拡張子は表示しない」という初期設定を悪用した古典的な手法ですが、依然として有効です。対策として拡張子を表示することは、技術的な対策だけでなく、従業員へのセキュリティ教育（リテラシー向上）の一環としても非常に重要です。

---
### ［設問］2
(1) イ（Webアプリケーションの脆弱性を悪用した攻撃を検知し、遮断する。）
(2) SIEM

### ［解説］
・用語
*   **WAF (Web Application Firewall)**: Webアプリケーションの脆弱性を狙った攻撃（SQLインジェクション、クロスサイトスクリプティングなど）を検知・防御することに特化したファイアウォールです。通信のパケット内容をアプリケーションレベルで解析します。
*   **SIEM (Security Information and Event Management)**: ファイアウォール、WAF、IPS、各種サーバなど、様々な機器やソフトウェアからログを収集・一元管理し、それらを相関分析することで、セキュリティインシデントの兆候を自動的に検知・通知する仕組みです。

・技術的背景：
(1) WAFの主な役割は、Webサーバの前段に設置され、送受信されるHTTP/HTTPS通信を詳細に検査することです。これにより、OSやミドルウェアのレベルではなく、Webアプリケーションそのものの脆弱性を悪用しようとする攻撃を検知し、遮断します。

**【受験者向け発展解説】**
ファイアウォール、IPS/IDS、WAFの防御層の違いを理解することが極めて重要です。
*   **ファイアウォール**: ネットワーク層・トランスポート層で、IPアドレスやポート番号を基に通信を制御します。
*   **IPS/IDS**: ネットワーク層からアプリケーション層にかけて、既知の攻撃パターン（シグネチャ）を検知・防御します。
*   **WAF**: アプリケーション層に特化し、Webアプリケーションのロジックを狙った攻撃（SQLインジェクションなど）を防御します。
これらは排他的な関係ではなく、**多層防御**として組み合わせて利用されるのが一般的です。

(2) FW、WAF、IPSといった個々のセキュリティ機器のログをそれぞれ監視するだけでは、巧妙な攻撃の全体像を把握するのは困難です。SIEMを導入することで、これらのログを統合的に分析し、「FWを通過した通信が、WAFで攻撃と判定され、IPSでも不正な振る舞いを検知した」といった一連のイベントを関連付けて、高度な脅威として認識することが可能になります。

**【受験者向け発展解説】**
SIEMは膨大なログを収集・分析できる強力なツールですが、その反面、検知したアラートの中から本当に対応が必要な「真の脅威」を見つけ出すことが運用上の課題となります。この課題を解決するため、近年ではAI(機械学習)を用いて脅威の分析や優先順位付けを自動化する**UEBA (User and Entity Behavior Analytics)** という機能がSIEMに統合される、もしくは連携して利用されることが増えています。

---
### ［設問］3
(1) ウ（PCやサーバに導入し、ファイル操作やプロセス起動などの動作を監視し、マルウェアが行うような不審な振る舞いを検知する。）
(2) 感染が疑われるPCをネットワークから隔離すること

### ［解説］
・用語
*   **EDR (Endpoint Detection and Response)**: PCやサーバなどのエンドポイント（末端の機器）に導入され、その動作を常時監視し、不審な挙動を検知して管理者への通知や、インシデント対応の支援（影響範囲の調査、隔離など）を行うセキュリティソリューションです。

・技術的背景：
(1) 従来のアンチウイルスソフトが、既知のマルウェアのパターン（シグネチャ）と照合して検知するのに対し、EDRはエンドポイント上のプロセス起動、ファイルアクセス、レジストリ変更、ネットワーク通信といった「振る舞い」を監視します。これにより、パターンファイルでは検知できない未知のマルウェアや、ファイルレスマルウェアによる攻撃も検知できる可能性があります。

**【受験者向け発展解説】**
EDRは「振る舞い検知」が特徴ですが、これには2つのアプローチがあります。一つは、マルウェア特有の悪意のある振る舞いのパターンをルール化して検知する方法。もう一つは、平常時のPCの動作を機械学習で学習し、それとは異なる「異常な振る舞い」を検知する方法です。後者は未知の攻撃手法にも対応できる可能性がありますが、誤検知（正常な操作を異常と判断してしまう）の可能性もあります。

(2) EDRが不審な振る舞いを検知した場合、インシデント対応における初動として最も重要なのは「封じ込め」です。具体的には、被害の拡大（他のサーバやPCへの感染拡大、C2サーバへの情報送信など）を防ぐため、検知したPCをネットワークから物理的または論理的に隔離（遮断）する措置が取られます。

**【受験者向け発展解説】**
EDRの多くは、管理コンソールから遠隔で特定のPCをネットワークから隔離する機能を備えています。これを **Network Isolation** や **Host Isolation** と呼びます。この機能により、担当者が現地に駆けつけることなく、迅速な初動対応（封じ込め）が可能となり、インシデント対応の効率を大幅に向上させます。

***

## 令和4年秋期 午後問1：マルウェアへの対応策

### ［設問］1
(1) イ（マルウェアに感染したPCを社内ネットワークから切り離す。）
(2) 通信ログ

### ［解説］
・技術的背景：
(1) マルウェアへの感染が疑われる場合、インシデント対応の初動として最も優先すべきは、被害拡大の防止（封じ込め）です。感染したPCをネットワークに接続したままにしておくと、他のPCやサーバへ感染を広げたり（横展開、ラテラルムーブメント）、外部のC2サーバと通信して情報を盗み出したりする可能性があります。そのため、速やかにLANケーブルを抜くなどしてネットワークから切り離すことが重要です。

**【受験者向け発展解説】**
攻撃者が侵入後に行う「横展開（ラテラルムーブメント）」は、インシデントの被害を甚大にする大きな要因です。これを防ぐためには、PCを隔離するだけでなく、ネットワークを適切に分割（セグメンテーション）しておくことが有効です。例えば、部署ごとにVLANを分け、VLAN間の通信をファイアウォールで厳しく制限することで、万が一ある部署のPCが感染しても、被害をその部署内に留めることができます。

(2) マルウェアは、外部のC2サーバと通信して攻撃者からの指令を受けたり、窃取した情報を送信したりします。感染PCの通信ログを調査することで、通信先のIPアドレスやドメイン名、通信時刻、通信プロトコルなどを特定でき、攻撃者の手がかりや被害の状況を把握するための重要な情報となります。

**【受験者向け発展解説】**
マルウェアの通信は、HTTP/HTTPS(80/443番ポート)に偽装されていることが非常に多いです。これは、多くの企業でWebアクセスが許可されており、ファイアウォールを通過しやすいためです。そのため、通信ログを調査する際は、プロキシサーバのログが特に重要となります。さらに、近年の通信はほとんどが暗号化(HTTPS)されているため、通信内容を解析するためには、プロキシサーバでSSL/TLS通信を復号（**SSLインスペクション**）する仕組みが必要となる場合があります。

---
### ［設問］2
(1) 特定のアカウントに対して、パスワード認証の失敗が繰り返し記録されている。
(2) c: C2

### ［解説］
・用語
*   **Active Directory (AD)**: Windows Serverの機能の一つで、ネットワーク上のユーザアカウント、コンピュータ、プリンタなどの情報を一元管理する仕組みです。認証やアクセスポリシーの管理も行います。
*   **ブルートフォース攻撃**: パスワードを破るための攻撃手法の一つで、考えられる全ての文字列の組み合わせを総当たりで試行します。
*   **C2サーバ (コマンド&コントロールサーバ)**: マルウェアに感染したPC群（ボットネット）を遠隔から制御するための指令サーバです。

・技術的背景：
(1) 攻撃者がネットワーク内部に侵入した後、権限昇格や横展開を狙って、管理者アカウントなどのパスワードを特定しようとすることがあります。ブルートフォース攻撃やパスワードスプレー攻撃が行われると、ADのログには、特定のアカウントに対する認証失敗のログが短時間に大量に記録されるため、攻撃の兆候として検知できます。

**【受験者向け発展解説】**
ブルートフォース攻撃と似た攻撃に**パスワードスプレー攻撃**があります。
*   **ブルートフォース攻撃**: **一つのアカウント**に対し、多数のパスワードを試行する。（アカウントロックで検知・防御しやすい）
*   **パスワードスプレー攻撃**: **多数のアカウント**に対し、少数のパスワード（例: `Password2025` など推測されやすいもの）を試行する。（アカウントロックを回避しやすく、検知が困難）
Active Directoryのログを監視する際は、このパスワードスプレー攻撃の兆候（短時間に複数アカウントで同じパスワードによる認証失敗が記録される）にも注意する必要があります。

(2) プロキシサーバは、内部ネットワークからインターネットへのHTTP/HTTPS通信を中継します。マルウェアが外部の**c: C2**サーバと通信しようとすると、その通信はプロキシサーバを経由するため、プロキシサーバのログには通信先のURLやIPアドレスが記録されます。これを分析することで、マルウェアの通信先を特定できます。

**【受験者向け発展解説】**
攻撃者は、C2サーバのIPアドレスが特定され、ファイアウォールでブロックされることを想定しています。そのため、通信先を頻繁に変更したり、複数の通信先を用意したりします。また、正規のクラウドサービス（Google DriveやDropboxなど）をC2サーバとして悪用する手口もあります。これは、正規の通信と区別がつきにくく、ドメイン名やIPアドレスでのブロックが困難なため、非常に厄介な攻撃です。

---
### ［設問］3
(1) ウ（他のPCにも同じマルウェアが潜伏していないか。）
(2) エ（特権アカウントのパスワードを変更する。）

### ［解説］
・技術的背景：
(1) 1台のPCでマルウェア感染が確認された場合、そのPCだけが標的であったとは限りません。攻撃者は、最初の侵入拠点からネットワーク内部の他のPCへ感染を広げ（横展開）、より重要な情報があるサーバへのアクセスを試みることが一般的です。そのため、ネットワーク全体を調査し、他に感染したPCがないかを確認することが不可欠です。

**【受験者向け発展解説】**
影響範囲の調査において、EDRは非常に強力なツールとなります。EDRは、検知されたマルウェアのハッシュ値や、C2サーバのIPアドレスなどの情報（**IOC: Indicator of Compromise / 侵害指標**）を基に、組織内の全PCを横断的に検索し、「他に同じマルウェアに感染しているPCはないか」「他に同じC2サーバと通信しているPCはないか」を迅速に特定することができます。

(2) 攻撃者は、一度ネットワーク内に侵入すると、管理者権限などの強力な権限を持つ特権アカウントを乗っ取ることを目指します。特権アカウントが奪われると、被害は甚大なものになります。インシデント発生時には、既知の脆弱性を突かれたり、パスワードが窃取されたりしている可能性があるため、再侵入やさらなる被害拡大を防ぐために、特権アカウントのパスワードを速やかに変更することが極めて重要な対策となります。

**【受験者向け発展解説】**
インシデント対応後は、特権アカウントの管理方法そのものを見直すことが重要です。具体的には、**特権ID管理ソリューション**の導入が考えられます。これは、特権アカウントのパスワードをシステムが一元管理し、利用の都度、貸し出しと自動変更を行ったり、特権IDでの操作内容をすべて記録・監視したりする仕組みです。これにより、不正利用の防止と、事後の追跡性を高めることができます。

***

## 令和4年春期 午後問1：通信販売サイトのセキュリティインシデント対応

### ［設問］1
(1) Webサイトのコンテンツを、Webアプリケーションの脆弱性を悪用して改ざんする攻撃
(2) CMSのプラグインの脆弱性
(3) Webサーバを停止させること

### ［解説］
・用語
*   **Webサイトの改ざん (Defacement)**: 攻撃者がWebサーバに不正侵入し、Webサイトの見た目や内容を書き換える攻撃です。
*   **CMS (Content Management System)**: Webサイトのコンテンツ（テキスト、画像など）を統合的に管理・更新するためのシステム。WordPressなどが有名です。プラグインを追加することで機能を拡張できますが、そのプラグインに脆弱性が存在することがあります。

・技術的背景：
(1) 問題文にある「Webアプリケーションの脆弱性を悪用し、Webサイトのコンテンツを書き換えた上で、閲覧者を不正なWebサイトへ誘導する」という手口は、Webサイトの改ざん攻撃に該当します。

**【受験者向け発展解説】**
Webサイトの改ざんは、見た目を書き換える愉快犯的なものから、閲覧者をマルウェア配布サイトへ誘導する**ドライブバイダウンロード攻撃**の踏み台にするなど、より悪質なものまで様々です。後者の場合、自社が被害者であると同時に、サイト閲覧者を危険に晒す加害者にもなってしまうため、迅速な対応が求められます。

(2) 近年のWebサイトはCMSを利用して構築されることが多く、その豊富なプラグインが攻撃の標的となりやすいです。プラグインの開発者が想定していなかったような入力データによって、意図しないプログラムが実行され、サーバの制御を奪われるなどの被害につながります。

**【受験者向け発展解説】**
CMS本体だけでなく、プラグインやテーマにも脆弱性が存在します。これらは様々な開発者によって作られているため、品質も様々です。CMSを安全に運用するためには、本体、プラグイン、テーマのバージョンを常に最新に保ち、不要なプラグインは削除することが基本です。また、利用しているソフトウェアのコンポーネントとそのバージョンを一覧化した**SBOM (Software Bill of Materials)** を管理し、脆弱性情報に迅速に対応できる体制を整えることが重要になっています。

(3) セキュリティインシデント発生時の初動対応は「封じ込め」であり、被害の拡大を防ぐことが最優先です。Webサイトが改ざんされ、閲覧者が不正サイトに誘導されている状況では、これ以上の被害者を出さないために、直ちにWebサーバを停止し、サイトを公開停止にすることが適切な判断となります。

**【受験者向け発展解説】**
Webサーバを停止する際には、**メモリダンプの取得**を検討することが重要です。メモリ上には、ディスクには書き込まれていない攻撃の痕跡（実行中の不正なプロセス、通信情報など）が残っている場合があります。サーバの電源を落としてしまうとこれらの情報は失われてしまうため、シャットダウンの前にメモリダンプを取得しておくことで、後の詳細な原因調査（デジタルフォレンジック）に役立ちます。

---
### ［設問］2
(1) エ（Webサーバのアクセスログを調査し，Webサイトのどのファイルが改ざんされたかを特定する。）
(2) 侵入経路となった脆弱性とは別の脆弱性を悪用してバックドアを設置した。

### ［解説］
・用語
*   **アクセスログ**: Webサーバに誰が、いつ、どのファイルにアクセスしたかなどを記録したファイルです。インシデント発生時の原因調査において極めて重要な情報源となります。
*   **バックドア**: 攻撃者が一度侵入したサーバに対して、正規の認証手順を回避して再度容易に侵入できるように設置する裏口のことです。

・技術的背景：
(1) インシデントの被害範囲を正確に把握するためには、証拠（ログ）に基づく調査が必要です。Webサーバのアクセスログを時系列で分析することで、攻撃者がいつ、どのIPアドレスからアクセスし、どのファイルを改ざん（アップロードや書き換え）したのかを特定することができます。

**【受験者向け発展解説】**
アクセスログの分析は、インシデント調査の基本ですが、ログが正確に出力されるように設定しておくことが大前提です。例えば、POSTリクエストのボディ部分（ユーザがフォームに入力した内容など）をログに記録する設定や、ログのローテーション、十分な期間の保存といった、平時からのログ管理が重要となります。

(2) 攻撃者は、最初に利用した脆弱性がセキュリティパッチなどで塞がれてしまう場合に備え、再侵入を容易にするためにバックドアを設置することが常套手段です。復旧作業においては、改ざんされたファイルを元に戻すだけでなく、設置されたバックドアを完全に除去しなければ、すぐに再侵入を許してしまいます。

**【受験者向け発展解説】**
バックドアは、一見すると無害なファイルに見せかけて設置されたり、既存の正規ファイルの一部を書き換える形で巧妙に隠されたりします。そのため、バックドアの発見は非常に困難な場合があります。復旧の際には、改ざんされたファイルだけを元に戻すのではなく、クリーンな状態であることが保証されたバックアップからシステム全体をリストア（再構築）するのが最も確実な方法です。

---
### ［設問］3
(1) 暗号化
(2) トークナイゼーション

### ［解説］
・用語
*   **暗号化 (Encryption)**: データを特定のルール（アルゴリズム）に従って、第三者には意味の分からない形式に変換することです。復号鍵がなければ元のデータに戻すことはできません。
*   **トークナイゼーション (Tokenization)**: クレジットカード番号のような機密性の高いデータを、それ自体は意味を持たない別の値（トークン）に置き換えて利用する技術です。万が一トークンが漏えいしても、元のクレジットカード番号を知られることはありません。

・技術的背景：
(1) 個人情報などの機密データを保存する際の基本的なセキュリティ対策は暗号化です。万が一、不正アクセスによってデータファイルが窃取されたとしても、データが暗号化されていれば、中身を読み取られることを防げます。

**【受験者向け発展解説】**
暗号化においては、暗号アルゴリズムの強度だけでなく、**鍵の管理**が極めて重要です。データを暗호화していても、その復号に必要な鍵が同じサーバに平文で保存されていては意味がありません。暗号鍵は、**HSM (Hardware Security Module)** のような専用のハードウェアで厳重に管理したり、クラウドのキーマネジメントサービスを利用したりすることが推奨されます。

(2) クレジットカード業界のセキュリティ基準であるPCI DSSでは、トークナイゼーションの利用が推奨されています。ECサイト側では実際のカード番号の代わりにトークンを保持し、決済が必要な時だけ決済代行会社にトークンを渡します。決済代行会社がトークンを実際のカード番号に復元して決済処理を行うため、ECサイト事業者はカード番号を自社で保持する必要がなくなり、情報漏えいのリスクを大幅に低減できます。

**【受験者向け発展解説】**
「暗号化」と「トークナイゼーション」の違いを明確に理解しましょう。
*   **暗号化**: 元のデータと暗号化されたデータは、数学的な関係性を持ちます。鍵があれば元のデータに**復元可能**です。
*   **トークナイゼーション**: 元のデータ（カード番号）とトークンには数学的な関係性がありません。元のデータは安全な場所（決済代行会社など）に保管され、全く別の無意味な値（トークン）に置き換えられます。トークンから元のデータを**復元することは原理的に不可能**です。
この特性により、トークナイゼーションは、ECサイトなどが「自社システムでカード情報を保持しない（非保持化）」を実現するための強力な手段となります。

***

## 令和3年秋期 午後問1：オフィスのセキュリティ対策

### ［設問］1
(1) フィッシング
(2) ア（IDとパスワードによる認証に加え，利用者のスマートフォンに通知を送るなど，複数の要素を組み合わせた認証を行う。）

### ［解説］
・用語
*   **フィッシング (Phishing)**: 金融機関や有名な企業などを装った偽の電子メールやSMSを送りつけ、偽のWebサイトに誘導し、ID、パスワード、クレジットカード番号などの個人情報を詐取する行為です。
*   **多要素認証 (MFA: Multi-Factor Authentication)**: 認証の三要素である「知識情報（ID/パスワードなど）」「所持情報（スマートフォン、ICカードなど）」「生体情報（指紋、顔など）」のうち、二つ以上を組み合わせて認証を行う方式です。

・技術的背景：
(1) 問題文にある「受信者をだましてURLをクリックさせ、偽のWebサイトにIDとパスワードを入力させる」という手口は、フィッシングの典型的なシナリオです。

**【受験者向け発展解説】**
フィッシングには、不特定多数を狙うばらまき型のものだけでなく、特定の個人や組織を狙って巧妙に偽装された**スピアフィッシング**や、企業のCEOなど幹部になりすます**ホエーリング（鯨釣り）**といった種類があります。攻撃対象が絞られるほど、メールの内容は巧妙になり、見破ることが困難になります。

(2) IDとパスワードによる認証のみでは、それらがフィッシングなどによって漏えいした場合、簡単になりすましを許してしまいます。そこで、本人しか持っていないスマートフォンへのワンタイムパスワード通知や承認要求（所持情報）を組み合わせた多要素認証を導入することで、たとえIDとパスワードが盗まれても不正ログインを防ぐことができ、セキュリティが大幅に向上します。

**【受験者向け発展解説】**
（令和6年春期の解説と同様）多要素認証(MFA)は非常に強力ですが、**MFA疲労攻撃**などの新たな脅威も出てきています。対策として、フィッシング耐性の高い**FIDO (Fast IDentity Online)** や、ログイン時のコンテキスト（状況）を評価する**リスクベース認証**が重要です。リスクベース認証は、例えば「普段と違う国からのアクセス」や「深夜のアクセス」といったリスクを検知した場合にのみ追加認証を求めることで、利便性とセキュリティを両立します。

---
### ［設問］2
(1) 中間者攻撃
(2) 通信相手が正当なサーバであることを確認するため

### ［解説］
・用語
*   **中間者攻撃 (MITM: Man-in-the-Middle Attack)**: 通信を行う二者の間に攻撃者が割り込み、両者が交換するメッセージを盗聴、改ざん、中継する攻撃です。通信している当事者は、攻撃者と通信していることに気づかない場合があります。
*   **サーバ証明書**: Webサイトの運営者の実在性を証明し、ブラウザとWebサーバ間の通信を暗号化（SSL/TLS通信）するために利用される電子証明書です。信頼できる第三者機関（認証局）によって発行されます。

・技術的背景：
(1) 攻撃者が設置した不正なWi-Fiアクセスポイントに接続してしまうと、利用者の通信はすべて攻撃者の機器を経由することになります。これにより、攻撃者は通信内容を盗聴したり、偽のサイトに誘導したりする中間者攻撃を行うことが可能になります。

**【受験者向け発展解説】**
不正Wi-Fiアクセスポイントは、正規のアクセスポイントと同じSSID（Wi-Fiの名前）を名乗ることがあります。これを**悪魔の双子（Evil Twin）攻撃**と呼びます。利用者のスマートフォンなどが、過去に接続したことがあるSSIDに自動的に再接続する機能を悪用するもので、利用者は気づかないうちに攻撃者のアクセスポイントに接続させられてしまいます。

(2) SSL/TLS通信では、サーバは自身のサーバ証明書をクライアント（ブラウザ）に提示します。クライアントは、その証明書が信頼できる認証局によって発行されたものであるか、証明書に記載されたドメイン名（コモンネーム）がアクセス先のドメイン名と一致するかなどを検証します。これにより、中間者によるなりすましではない、正当なサーバと通信していることを確認できます。

**【受験者向け発展解説】**
ブラウザによるサーバ証明書の検証は非常に重要ですが、利用者が警告を無視してしまうと意味がありません。また、攻撃者が正規の認証局からドメイン認証(DV)証明書を不正に取得し、フィッシングサイトをHTTPS化するケースも増えています。より厳格な審査を経て発行され、ブラウザのアドレスバーに組織名が表示される**EV SSL証明書**は、このようなフィッシングサイトとの見分けに役立ちます。

---
### ［設問］3
(1) VLAN
(2) エ（マルウェアに感染したPCが，他のセグメントのサーバにアクセスすることを防止できる。）

### ［解説］
・用語
*   **VLAN (Virtual LAN)**: 物理的な接続形態とは独立して、スイッチの機能を利用して仮想的に複数のLANセグメント（ブロードキャストドメイン）を構築する技術です。

・技術的背景：
(1) VLANを利用することで、1台のスイッチを論理的に複数のスイッチがあるかのように分割できます。これにより、同じスイッチに接続されていても、部署ごとやサーバ群ごとにネットワークを分離することが可能になります。

**【受験者向け発展解説】**
VLANと似た概念に**サブネット**があります。VLANがスイッチ（レイヤ2）レベルでのネットワーク分割であるのに対し、サブネットはルータ（レイヤ3）レベルでの分割です。一般的に、一つのVLANに一つのサブネットを対応させてネットワークを設計します。このネットワーク分割（セグメンテーション）が、後述のセキュリティ向上に繋がります。

(2) ネットワークをVLANでセグメントに分割し、セグメント間の通信をファイアウォールなどで適切に制御することで、セキュリティを向上させることができます。例えば、あるセグメントのPCがマルウェアに感染しても、他のセグメントへの不要な通信が遮断されるため、感染がネットワーク全体に広がる（横展開）のを防ぎ、被害を局所化する効果があります。

**【受験者向け発展解説】**
この考え方をさらに進めたものが**マイクロセグメンテーション**です。これは、VLANよりもさらに細かい単位（例えば、サーバ1台ごと）でネットワークを論理的に分離し、最小権限の原則に基づいてサーバ間の通信を厳密に制御する技術です。これにより、たとえ攻撃者がネットワーク内部に侵入したとしても、サーバからサーバへの横展開を極めて困難にし、被害を最小限に抑え込むことができます。特に仮想化基盤やクラウド環境で重要なセキュリティ技術となっています。

***

## 令和3年春期 午後問1：DNSのセキュリティ対策

### ［設問］1
(1) キャッシュDNSサーバ
(2) 再帰的な問合せ
(3) DNSキャッシュポイズニング

### ［解説］
・用語
*   **キャッシュDNSサーバ (フルサービスリゾルバ)**: PCなどのクライアントからの名前解決の要求を受け付け、権威DNSサーバへの問い合わせを代行し、結果をクライアントに返すとともに、一度問い合わせた結果を一定期間キャッシュ（保存）する機能を持つDNSサーバです。
*   **再帰的な問合せ (Recursive Query)**: クライアントからキャッシュDNSサーバに対して行われる問い合わせ方式です。キャッシュDNSサーバは、自身で答えられない場合、ルートDNSサーバから順に他のDNSサーバへ問い合わせを繰り返し（反復問合せ）、最終的な答えを見つけてクライアントに返します。
*   **DNSキャッシュポイズニング (DNS Cache Poisoning)**: キャッシュDNSサーバのキャッシュに偽のDNS情報を注入する攻撃です。これにより、利用者を偽のWebサイトへ誘導することが可能になります。

・技術的背景：
(1) 利用者PCのDNS設定で指定されるDNSサーバは、一般的にプロバイダなどが提供するキャッシュDNSサーバです。このサーバが名前解決の全てを代行します。

**【受験者向け発展解説】**
キャッシュDNSサーバと、自ドメインの情報を管理する**権威DNSサーバ（コンテンツDNSサーバ）**の役割の違いを明確に区別することが重要です。キャッシュDNSサーバは「聞きに行く」側、権威DNSサーバは「答える」側です。企業などでは、外部からの問い合わせに答える権威DNSサーバ（外部DNSサーバ）と、社内からの問い合わせだけを処理するキャッシュDNSサーバ（内部DNSサーバ）を分離して運用するのが一般的です。

(2) PCからキャッシュDNSサーバへの問い合わせは「このドメイン名のIPアドレスを教えてください」という形式の「再帰的な問合せ」です。

**【受験者向け発展解説】**
キャッシュDNSサーバが権威DNSサーバに対して行う問い合わせは**反復的な問合せ（Iterative Query）**と呼ばれます。「jpドメインのことは、このサーバに聞いて」「example.jpのことは、あのサーバに聞いて」というように、たらい回しにされながら最終的な答えにたどり着きます。この「再帰的」と「反復的」の使い分けを理解しておきましょう。

(3) 攻撃者は、キャッシュDNSサーバが権威DNSサーバに問い合わせているタイミングを狙って、正規の応答よりも早く偽の応答を送りつけます。キャッシュDNSサーバがこの偽の応答を信じてキャッシュしてしまうと、同じ問い合わせをした他の利用者も偽サイトに誘導されてしまいます。

**【受験者向け発展解説】**
この攻撃は、DNSの応答に含まれるトランザクションIDを推測する必要があるため、別名**カミンスキー攻撃**とも呼ばれる手法が有名です。攻撃を成功させるためには、タイミングとIDの両方を一致させる必要があります。

---
### ［設問］2
(1) 送信元ポート番号をランダムに選択する。
(2) DNSSEC

### ［解説］
・用語
*   **DNSSEC (DNS Security Extensions)**: DNSの応答が正当なものであること（送信元が正しいこと）と、改ざんされていないこと（完全性）を保証するための拡張機能です。電子署名（公開鍵暗号技術）を利用してDNS応答の信頼性を高めます。

・技術的背景：
(1) DNSキャッシュポイズニング攻撃では、攻撃者はDNSの応答を偽装します。このとき、偽装応答が正規のものとして受け入れられるためには、トランザクションIDだけでなく、送信元ポート番号も一致させる必要があります。送信元ポート番号を固定ではなくランダムにすることで、攻撃者が推測すべき組み合わせが増え、攻撃の成功率を下げることができます。これは「ソースポートランダマイゼーション」と呼ばれます。

**【受験者向け発展解説】**
ソースポートランダマイゼーションは、DNSキャッシュポイズニング攻撃を困難にはしますが、完全に防ぐことはできません。あくまで緩和策の一つです。根本的な対策は、次項のDNSSECとなります。

(2) DNSSECは、DNSキャッシュポイズニングへの根本的な対策とされています。権威DNSサーバは、管理するDNS情報（ゾーン情報）に自身の秘密鍵で電子署名を付与して応答します。キャッシュDNSサーバは、予め信頼している公開鍵を使ってその署名を検証することで、応答が正当な管理者から送られ、途中で改ざんされていないことを確認できます。

**【受験者向け発展解説】**
DNSSECは、DNSの応答に「**信頼性の鎖（Chain of Trust）**」をもたらします。キャッシュDNSサーバは、ルートDNSサーバの公開鍵を起点として、トップレベルドメイン（.jpなど）、セカンドレベルドメイン（example.jpなど）へと順に署名を検証していきます。これにより、応答が偽造されたものではないことを数学的に保証できます。ただし、DNSSECは応答が暗号化されるわけではないため、**盗聴（プライバシー）対策にはならない**点に注意が必要です。プライバシー対策としては**DNS over HTTPS (DoH)** や **DNS over TLS (DoT)** といった技術があります。

---
### ［設問］3
(1) ア（DNSサーバが処理できる問合せの数を上回る問合せを，DNSサーバに送り付ける。）
(2) DNS水責め攻撃（ランダムサブドメイン攻撃）
(3) RPZ (Response Policy Zone)

### ［解説］
・用語
*   **DoS攻撃 (Denial of Service Attack)**: 標的のサーバに対して大量の通信を送りつけるなどして過剰な負荷をかけ、サービスを提供不能な状態に追い込む攻撃です。
*   **DNS水責め攻撃 (ランダムサブドメイン攻撃)**: 攻撃対象のドメインに対して、存在しないランダムなサブドメイン（例: `abcde.example.com`, `fghij.example.com`）の問い合わせを大量に送りつける攻撃です。キャッシュDNSサーバはこれらの問い合わせをキャッシュしていないため、都度、権威DNSサーバへ問い合わせを行い、結果として権威DNSサーバを高負荷状態に陥らせます。
*   **RPZ (Response Policy Zone)**: DNSサーバの機能の一つで、管理者が定義したポリシー（ゾーン情報）に基づき、特定のドメイン名に対する問い合わせの結果を書き換えたり、問い合わせ自体をブロックしたりする仕組みです。

・技術的背景：
(1) DoS攻撃は、標的が処理しきれないほどの大量の要求を送りつけることで、正規の利用者がサービスを使えなくする攻撃です。選択肢アは、このDoS攻撃の基本的な説明です。

**【受験者向け発展解説】**
複数の攻撃元（ボットネットなど）から一斉に行われるDoS攻撃を **DDoS (Distributed Denial of Service) 攻撃**と呼びます。現代のDoS攻撃のほとんどはDDoS攻撃です。

(2) DNS水責め攻撃は、標的の権威DNSサーバをダウンさせることを目的としたDoS攻撃の一種です。攻撃者は、多数のボットPCから、標的ドメインの存在しないサブドメインの名前解決を、複数のキャッシュDNSサーバに要求します。これにより、問い合わせが標的の権威DNSサーバに集中し、過負荷で応答不能となります。

**【受験者向け発展解説】**
この攻撃が厄介なのは、問い合わせ元が正規のキャッシュDNSサーバであるため、攻撃元のIPアドレスで単純にフィルタリングすることが難しい点です。攻撃者は直接、権威DNSサーバを攻撃するのではなく、世界中のキャッシュDNSサーバを「踏み台」にして攻撃を増幅させているのです。

(3) RPZは、DNSサーバの応答を制御するための機能です。DNS水責め攻撃を受けている場合、攻撃に使われている問い合わせパターンのドメイン（例えば `*.example.com` など）をRPZに登録することで、その問い合わせに対して権威DNSサーバへ問い合わせることなく、キャッシュDNSサーバ側で応答を返したり（NXDOMAIN: 存在しないドメイン）、問い合わせを破棄したりできます。これにより、権威DNSサーバの負荷を軽減できます。

**【受験者向け発展解説】**
RPZは、マルウェアが通信するC2サーバのドメイン名や、フィッシングサイトのドメイン名をブラックリストとして登録し、社内の利用者がそれらの危険なサイトにアクセスするのをDNSレベルでブロックするためにも利用されます。これは、DNSフィルタリングやDNSファイアウォールとも呼ばれ、SWGなどと連携・補完する形でセキュリティを強化します。

***

## 令和2年秋期 午後問1：内部不正による情報漏えいの対策

### ［設問］1
(1) ア（業務上必要のない秘密情報へのアクセスを禁止する。）
(2) DLP

### ［解説］
・用語
*   **最小権限の原則 (Principle of Least Privilege)**: ユーザやプログラムに、業務遂行に必要な最小限の権限のみを与えるというセキュリティの基本原則です。
*   **DLP (Data Loss Prevention / Data Leakage Prevention)**: 組織内部の機密情報や個人情報を識別・監視し、それらが外部に不正に送信されたり、許可なく持ち出されたりするのを検知・ブロックするシステムです。

・技術的背景：
(1) 内部不正による情報漏えいを防ぐための基本的な考え方が「最小権限の原則」です。従業員に対して、担当業務に関係のない情報へのアクセス権を与えないことで、仮に不正な意図を持ったとしても、漏えいさせることができる情報の範囲を限定し、リスクを低減します。

**【受験者向け発展解説】**
最小権限の原則を実現するためには、適切な**アクセス制御**モデルを導入する必要があります。代表的なものに、役割に基づいて権限を割り当てる **RBAC (Role-Based Access Control)** があります。例えば、「営業担当」という役割には「顧客データベースの閲覧権限」を与え、「経理担当」という役割には「財務システムの操作権限」を与える、といった形で管理します。

(2) DLPは、データの「内容」を検査する点が特徴です。例えば、社外へのメール送信やUSBメモリへのファイルコピーが行われる際に、ファイル内に「社外秘」というキーワードや、特定のフォーマット（マイナンバー、クレジットカード番号など）の文字列が含まれていないかをチェックします。ポリシーに違反する操作を検知した場合、その操作をブロックしたり、管理者に警告したりします。

**【受験者向け発展解説】**
DLPには、ネットワークの出口を監視する**ネットワークDLP**、PCなどのエンドポイントを監視する**エンドポイントDLP**、ファイルサーバやデータベースを監視する**ストレージDLP**など、監視対象に応じて様々な種類があります。CASBにもDLP機能が統合されていることが多く、クラウドサービス（Microsoft 365やGoogle Workspaceなど）との間でやり取りされる機密情報を監視・制御することができます。

---
### ［設問］2
(1) PCの操作を記録し、不審な操作をリアルタイムに検知する。
(2) イ（退職後に元従業員のアカウントが不正に利用されることを防ぐ。）
(3) ウ（不正が行われた場合に、ログから操作者を特定し、否定できないようにする。）

### ［解説］
・技術的背景：
(1) PC操作ログ監視ツールは、従業員がPC上でどのような操作（ファイルアクセス、アプリケーション利用、Webサイト閲覧、印刷など）を行ったかを詳細に記録します。これにより、平常時と異なる不審な操作（例: 深夜の大量データアクセス、機密情報フォルダへの頻繁なアクセスなど）をリアルタイムで検知し、インシデントの予兆を捉えることができます。

**【受験者向け発展解説】**
このようなユーザの振る舞いを分析して脅威を検知する技術は **UEBA (User and Entity Behavior Analytics)** と呼ばれます。UEBAは、平常時のユーザ操作のベースラインを学習し、それから逸脱する異常な行動（例：普段アクセスしないサーバへの大量アクセス、退職予定者の急なデータダウンロードなど）を検知することで、内部不正の兆候を早期に発見することを目指します。SIEMやDLPにUEBAの機能が統合されることが増えています。

(2) 退職した従業員のアカウントを削除せずに放置しておくと、その元従業員本人や、アカウント情報を知る第三者によって不正にアクセスされ、情報漏えいやシステム破壊につながる危険性があります。そのため、退職や異動の際には、不要になったアカウントを速やかに削除または無効化するプロセスを確立することが重要です。

**【受験者向け発展解説】**
これは、従業員の入社から退職までの一連のアカウント管理、すなわち**IDライフサイクル管理**の重要性を示しています。人事システムと連携し、入社時には自動でアカウントを作成し、異動時には権限を適切に変更し、退職時には速やかにアカウントを無効化する、といったプロセスを自動化する**ID管理（IAM: Identity and Access Management）**システムがこれを実現します。

(3) ログを取得・管理する目的の一つに「否認防止」があります。誰が、いつ、何を行ったかという客観的な証拠（操作ログ）を保全しておくことで、不正行為が発生した際に、その行為者が「自分はやっていない」と主張することを困難にし、責任の所在を明確にすることができます。これは不正行為に対する抑止力としても機能します。

**【受験者向け発展解説**】
否認防止のためには、ログが改ざんされていないこと（**完全性**）を保証することが重要です。そのため、ログサーバには厳格なアクセス制御を施すとともに、収集したログのハッシュ値を定期的に計算・保存したり、**WORM (Write Once Read Many)** 機能を持つストレージにログを書き込み、一度書き込んだら変更・削除できないようにしたりする対策が取られます。

***

## 令和1年秋期 午後問1：標的型サイバー攻撃

### ［設問］1
(1) イ（受信者が業務に関係するメールであると誤認し、添付ファイルを開封させる。）
(2) 潜伏・内部活動
(3) C2サーバ

### ［解説］
・用語
*   **標的型攻撃**: 特定の組織や個人を標的として、その標が持つ情報を窃取することなどを目的に、周到な準備のもとで実行されるサイバー攻撃です。
*   **サイバーキルチェーン**: 標的型攻撃を段階的にモデル化したもので、「偵察」「武器化」「配送」「攻撃」「インストール」「遠隔操作」「目的の実行」といったフェーズで構成されます。
*   **C2サーバ (コマンド&コントロールサーバ)**: マルウェアが感染したコンピュータ（ボット）に対して、攻撃者が指令を送ったり、情報を収集させたりするための司令塔となるサーバです。

・技術的背景：
(1) 標的型攻撃メールは、不特定多数に送られる迷惑メールとは異なり、標的組織の業務内容や取引先とのやり取りなどを事前に調査した上で、巧妙に偽装されています。これにより、受信者が本物の業務メールと信じ込み、警戒心なく添付ファイルを開いたり、リンクをクリックしたりするように仕向けます。

**【受験者向け発展解説】**
標的型攻撃の偵察段階では、SNSや公開情報から組織の情報を収集する **OSINT (Open Source Intelligence)** が活用されます。攻撃者はこれにより、組織の役職者名、メールアドレス、取引先情報などを把握し、極めて信憑性の高いメール文面を作成します。対策としては、技術的な対策だけでなく、このような攻撃手口を従業員に周知する**標的型攻撃メール訓練**などのセキュリティ教育が不可欠です。

(2) 「潜伏・内部活動」は、攻撃の初期段階でマルウェアに感染させたPCを足がかりに、ネットワーク内部の情報を探索し、さらに重要なサーバへと侵入を拡大していく活動フェーズを指します。この段階では、攻撃者は自身の活動を隠蔽し、管理者などに検知されないように静かに行動します。

**【受験者向け発展解説】**
この「潜伏・内部活動」段階における侵入拡大活動は**ラテラルムーブメント（横展開）** と呼ばれます。攻撃者は、OSの正規ツール（PowerShell, PsExecなど）を悪用して活動することが多く、これは**環境寄生型（Living Off The Land）攻撃**と呼ばれます。EDRは、このような正規ツールによる異常な振る舞いを検知することに長けています。

(3) マルウェアは、PCに感染した後、外部に設置されたC2サーバと通信を確立しようとします。この通信が成功すると、PCは攻撃者の遠隔操作下に置かれ、ファイルの窃取、キー入力情報の送信、他のマルウェアのダウンロードといった不正な活動を指示されることになります。

**【受験者向け発展解説】**
C2サーバとの通信を隠蔽するため、マルウェアはDNSクエリのTXTレコードにコマンドを埋め込んで通信する**DNSトンネリング**や、正規のWebサイト（SNS、ブログサービスなど）を中継して通信するなど、巧妙な手口を用います。これらの異常な通信を検知するには、プロキシサーバやDNSサーバのログを詳細に分析する**出口対策（Egress Filtering）** が重要となります。

---
### ［設問］2
(1) ログインしているアカウントの権限でアクセスできる範囲
(2) プロキシサーバ
(3) イ（マルウェアの通信先を特定し、FWなどでそのIPアドレスとの通信を遮断する。）

### ［解説］
・用語
*   **プロキシサーバ**: 内部ネットワークのコンピュータの代理としてインターネットに接続するサーバです。全てのWebアクセスがプロキシサーバを経由するため、アクセスログの一元管理や、不正なサイトへのアクセスをフィルタリングすることが可能になります。
*   **ファイアウォール (FW)**: ネットワークの境界に設置され、予め定義されたルール（ポリシー）に基づいて、通過させる通信と遮断する通信を判断・制御するセキュリティ機器です。

・技術的背景：
(1) マルウェアは、PCに感染した時点では、そのPCにログインしているユーザのアカウント権限しか持っていません。そのため、そのユーザがアクセスできるファイルや共有フォルダの範囲内でしか情報を窃取できません。攻撃者はここから、管理者権限などを奪取する「権限昇格」を試みます。

**【受験者向け発展解説】**
「権限昇格」には、OSやミドルウェアの脆弱性を悪用してシステムの管理者権限（rootやSYSTEM）を奪う**垂直方向の権限昇格**と、他のユーザ（特に管理者）のID/パスワードを窃取してそのユーザになりすます**水平方向の権限昇格**があります。攻撃者はこれらの手法を駆使して、最終的に**Active Directoryのドメイン管理者**などの特権アカウントを狙います。

(2) 社内PCからインターネットへのHTTP/HTTPS通信がプロキシサーバを経由するように設定されている環境では、マルウェアがC2サーバと通信しようとした際も、その通信はプロキシサーバのログに記録されます。このログを分析することで、マルウェアの通信先（ドメイン名やIPアドレス）を特定できます。

**【受験者向け発展解説】**
（令和4年秋期の解説と同様）近年のC2通信はほとんどがHTTPSで暗号化されています。プロキシサーバで通信先を特定できても、通信内容までは把握できません。そのため、通信内容まで検査する必要がある場合は、プロキシサーバで暗号を一旦解読して検査する**SSL/TLSインスペクション（SSL復号）** の仕組みを導入する必要があります。ただし、プライバシーへの配慮など導入には注意が必要です。

(3) マルウェアの通信先が特定できたら、次に行うべきは「封じ込め」です。ファイアウォールやプロキシサーバの設定で、特定したIPアドレスやドメインへの通信を全て遮断します。これにより、マルウェアがC2サーバから新たな指令を受け取ることや、情報を外部に送信することを防ぎ、被害の拡大を食い止めます。

**【受験者向け発展解説】**
特定したC2サーバのIPアドレスやドメイン名などの情報は**IOC (Indicator of Compromise / 侵害指標)** と呼ばれます。このIOC情報を、ファイアウォールやEDR、SIEMなどのセキュリティ製品に登録することで、組織全体で同様の脅威を迅速に検知・ブロックする体制を整えることができます。脅威情報を組織内で共有・活用する**サイバー脅威インテリジェンス (CTI)** の考え方につながります。

***

## 平成31年春期 午後問1：ECサイトの利用者認証

### ［設問］1
(1) 辞書攻撃
(2) パスワードリスト攻撃

### ［解説］
・用語
*   **辞書攻撃**: パスワードとしてよく使われる単語や人名などを集めたファイル（辞書ファイル）を用意し、そのリストにある単語を順番に試していくことでパスワードを破ろうとする手法です。
*   **パスワードリスト攻撃**: 他のサービスから漏えいしたIDとパスワードのリストを利用し、標的のサービスに対してログインを試行する攻撃です。多くのユーザが複数のサービスで同じパスワードを使い回していることを悪用します。

・技術的背景：
(1) 辞書攻撃は、ブルートフォース攻撃（総当たり攻撃）の一種ですが、完全にランダムな文字列ではなく、意味のある単語に絞って試行するため、比較的短時間で単純なパスワードを破れる可能性があります。

**【受験者向け発展解説】**
辞書攻撃の進化形として、辞書にある単語に数字や記号を組み合わせる（例: password → password123, P@ssword!）といったルールに基づいて試行する**ハイブリッド攻撃**もあります。パスワードポリシーで複雑さを要求しても、単純な組み合わせでは破られる可能性があることを示唆しています。

(2) パスワードリスト攻撃は、攻撃者にとって非常に効率的な手法です。攻撃者自身がパスワードを解読する必要がなく、既に入手したリストを使ってログインを試すだけだからです。ユーザ側がサービスごとに異なるパスワードを設定していれば、この攻撃による被害は防げます。

**【受験者向け発展解説】**
パスワードリスト攻撃と似た手口に**クレデンシャルスタッフィング**があります。ほぼ同義で使われますが、クレデンシャルスタッフィングは、パスワードリスト攻撃を大規模かつ自動化されたツールで行うニュアンスで使われることが多いです。この攻撃が成功してしまう根本原因は「**パスワードの使い回し**」にあります。サービス提供者側は、多要素認証の導入などで対策すると同時に、利用者に対してパスワードの使い回しをしないよう啓発することが重要です。

---
### ［設問］2
(1) ア（ログイン試行を繰り返すIPアドレスからのアクセスを，一定時間，拒否する。）
(2) CAPTCHA
(3) リスクベース認証

### ［解説］
・用語
*   **CAPTCHA**: 歪んだ文字や画像などを表示し、人間にそれを判読させて入力させることで、アクセスしてきたのが人間かコンピュータプログラム（ボット）かを判別する仕組みです。
*   **リスクベース認証**: ログイン時のIPアドレス、地域、時間帯、使用しているブラウザ、普段と異なる操作パターンなど、様々な要素を分析してリスクを評価し、リスクが高いと判断された場合にのみ、追加の認証（秘密の質問、ワンタイムパスワードなど）を要求する認証方式です。

・技術的背景：
(1) 同一のIPアドレスから短時間に大量のログイン試行がある場合、それはプログラムによる自動的な攻撃（ブルートフォース攻撃やパスワードリスト攻撃）である可能性が非常に高いです。そのため、そのようなIPアドレスからのアクセスを一時的に遮断することは、攻撃を緩和する有効な対策となります。

**【受験者向け発展解説】**
この対策は有効ですが、攻撃者が多数のIPアドレス（ボットネットなど）を使い分けて攻撃してきた場合、単一のIPアドレスを遮断するだけでは効果が薄くなります。そのため、IPアドレスだけでなく、他の要素（ユーザエージェント、アクセスパターンなど）も考慮して不正アクセスを検知する仕組みが求められます。

(2) CAPTCHAは、自動化されたプログラムによる大量のログイン試行やアカウント作成を防ぐために導入されます。プログラムには歪んだ文字の判読が困難であるため、人間による正規の操作であることを確認できます。

**【受験者向け発展解説】**
近年では、AI技術の向上により、歪んだ文字のCAPTCHAも突破されるケースが増えています。そのため、「私はロボットではありません」のチェックボックスをクリックさせたり、複数の画像の中から「信号機」を選ばせたりする**reCAPTCHA**のような、より高度な仕組みが主流になっています。

(3) リスクベース認証は、セキュリティと利便性のバランスを取るための仕組みです。普段と同じ環境からのアクセス（低リスク）であればIDとパスワードのみでログインさせ、深夜の海外からのアクセス（高リスク）のような異常な振る舞いを検知した場合にのみ追加認証を要求します。これにより、ユーザに過度な負担をかけることなく、セキュリティを強化できます。

**【受験者向け発展解説】**
リスクベース認証は**適応型認証（Adaptive Authentication）** とも呼ばれます。この認証方式は、ゼロトラストアーキテクチャにおいても重要な役割を果たします。アクセスの都度、ユーザやデバイスのコンテキスト（状況）を評価し、リスクに応じてリアルタイムにアクセス可否を判断したり、要求する認証レベルを動的に変更したりすることで、きめ細やかなアクセス制御を実現します。

---
### ［設問］3
(1) SMS
(2) 盗聴されるおそれがある公衆無線LAN上で，認証情報を保護するため
(3) ウ（Webサイトの運営組織の実在性）

### ［解説］
・用語
*   **SMS (Short Message Service)**: 携帯電話番号を宛先として短いテキストメッセージを送受信するサービスです。
*   **SSL/TLS**: インターネット上でデータを暗号化して送受信するプロトコルです。通信内容の盗聴や改ざんを防ぎます。
*   **サーバ証明書 (SSLサーバ証明書)**: SSL/TLS通信において、Webサイトの運営者の実在性を証明し、ブラウザとサーバ間の通信を暗号化するために使用される電子証明書です。信頼された第三者機関である認証局（CA）が発行します。

・技術的背景：
(1) ワンタイムパスワードを通知する方法として、SMSは広く利用されています。携帯電話番号は本人との結びつきが強く、また、パスワードを入力するPCとは別のデバイス（スマートフォン）に届くため、二経路認証を実現でき、セキュリティが高まります。

**【受験者向け発展解説】**
SMS認証は手軽ですが、**SIMスワップ詐欺**（攻撃者が通信事業者を騙してSIMカードを再発行させ、電話番号を乗っ取る）などの攻撃に対して脆弱な側面もあります。そのため、より安全な多要素認証の手段として、スマートフォンアプリで生成するワンタイムパスワード（**TOTP: Time-based One-Time Password**）や、プッシュ通知への応答、**FIDO**のような物理的なセキュリティキーの利用が推奨されています。

(2) カフェなどの公衆無線LANは、通信が暗号化されていない場合が多く、同じアクセスポイントに接続している悪意のある第三者に通信内容を盗聴（パケットキャプチャ）される危険性があります。WebサイトがSSL/TLSに対応していれば、たとえ盗聴されても通信内容が暗号化されているため、IDやパスワードなどの重要な情報が漏えいするのを防ぐことができます。

**【受験者向け発展解説】**
Webサイト全体を常にSSL/TLSで暗号化することを**常時SSL/TLS化（Always On SSL/TLS）** と呼びます。以前はログインページなど特定のページのみを暗号化するサイトもありましたが、現在ではサイトの信頼性向上や、後述する中間者攻撃の防止のため、全てのページを暗号化することが標準となっています。

(3) ブラウザがサーバ証明書を検証する際、その証明書が信頼できる認証局から発行されているかを確認します。これにより、利用者は、自分がアクセスしているWebサイトが、偽のフィッシングサイトなどではなく、本物の運営組織によって運営されていることを確認できます。

**【受験者向け発展解説】**
サーバ証明書には、検証レベルに応じて3つの種類があります。
*   **DV (Domain Validation)**: ドメインの所有権のみを確認。最も手軽だが信頼性は低い。
*   **OV (Organization Validation)**: 組織の実在性を確認。
*   **EV (Extended Validation)**: 最も厳格な審査基準で組織の実在性を確認。
フィッシングサイトでもDV証明書は取得可能なため、利用者はアドレスバーの表示などを確認し、サイトの信頼性を判断する必要があります。

***

## 平成30年秋期 午後問1：インターネットサービス向けサーバのセキュリティ対策

### ［設問］1
(1) 最小権限の原則
(2) ア（OSやソフトウェアの脆弱性を解消する。）
(3) プログラムの脆弱性を悪用され，サーバの操作権限を奪われる。

### ［解説］
・用語
*   **最小権限の原則**: ユーザやプログラムに与える権限は、その役割を果たすために必要な最小限度に留めるべきであるというセキュリティの基本原則です。
*   **脆弱性 (Vulnerability)**: コンピュータのOSやソフトウェアにおいて、プログラムの不具合や設計上のミスが原因で発生する、情報セキュリティ上の欠陥のことです。

・技術的背景：
(1) Webサーバのプログラムをroot（管理者）権限で実行すると、そのプログラムに脆弱性があった場合に、サーバの全ての権限を攻撃者に奪われてしまいます。一般ユーザ権限で実行しておけば、万が一乗っ取られても、被害をそのユーザの権限範囲内に限定することができます。

**【受験者向け発展解説】**
これはサーバセキュリティの基本中の基本です。同様に、データベースへの接続も、管理者(root)権限ではなく、アプリケーションが必要とする操作（参照、更新など）のみが許可された専用のユーザ権限で行うべきです。これにより、SQLインジェクションなどの攻撃を受けた際の被害を最小限に抑えることができます。

(2) ソフトウェアの脆弱性は、サイバー攻撃の主要な侵入経路となります。開発元から提供されるセキュリティパッチを適用することで、既知の脆弱性を塞ぎ、攻撃されるリスクを低減することができます。これはサーバを運用する上で最も基本的な対策の一つです。

**【受験者向け発展解説**】
脆弱性情報の管理には **CVE (Common Vulnerabilities and Exposures)** 識別子が用いられます。また、脆弱性の深刻度は **CVSS (Common Vulnerability Scoring System)** という共通の評価手法でスコアリングされます。システム管理者は、これらの情報を基に、適用するパッチの優先順位を判断します。**脆弱性管理**は、脆弱性の特定、評価、対処、報告という一連のプロセスを指す重要な活動です。

(3) プログラムに脆弱性（例：バッファオーバーフローなど）が存在すると、攻撃者は巧妙に細工したデータを送り込むことで、プログラムを異常動作させ、最終的にはサーバ上で任意のコマンドを実行できる権限（シェル）を奪取することがあります。

**【受験者向け発展解説】**
任意のコマンドを実行できる権限を奪われることを**リモートコード実行（RCE: Remote Code Execution）** と呼びます。これは最も深刻な脆弱性の一つです。バッファオーバーフロー以外にも、OSコマンドインジェクションや、安全でないデシリアライゼーションといった脆弱性がRCEにつながる可能性があります。

---
### ［設問］2
(1) SQLインジェクション
(2) WAF (Web Application Firewall)
(3) プレースホルダ

### ［解説］
・用語
*   **SQLインジェクション**: Webアプリケーションの脆弱性を利用する攻撃手法の一つです。入力フォームなどに不正なSQL文の断片を入力することで、データベースを不正に操作します。
*   **WAF (Web Application Firewall)**: Webアプリケーションの前面に設置され、通信内容をアプリケーションレベルで解析し、SQLインジェクションやクロスサイトスクリプティングといった攻撃パターンを検知・遮断するセキュリティ機器です。
*   **プレースホルダ (Placeholder)**: SQL文を組み立てる際に、外部から入力される値を後から安全に埋め込むための仕組みです。入力値をSQL文の一部（構文）としてではなく、単なる値（データ）として扱うため、SQLインジェクションを防ぐことができます。「バインド機構」とも呼ばれます。

・技術的背景：
(1) 問題文の「Webページから入力された文字列を使ってSQL文を組み立てている」という箇所で、入力値のチェック（サニタイジング）が不十分な場合にSQLインジェクションの脆弱性が生まれます。攻撃者は、ユーザIDの入力欄に ` ' OR 'A'='A ` といった文字列を入力し、認証を回避するなどの不正操作を行います。

**【受験者向け発展解説】**
SQLインジェクションには、データベースからの応答結果を直接表示させる**エラーベースSQLインジェクション**や、表示内容の真偽を利用して情報を窃取する**ブラインドSQLインジェクション**など、様々な種類があります。特に後者は検知が難しく、攻撃が長期化する傾向があります。

(2) WAFは、SQLインジェクション攻撃でよく使われるSQL文のキーワード（`SELECT`, `UNION`, `OR`など）や記号（`'` , `--`など）のパターンを検知ルールとして持っており、そのようなパターンを含む通信を遮断することで、Webアプリケーションを保護します。

**【受験者向け発展解説】**
WAFには、不正なパターンを検知する**ブラックリスト（シグネチャ）方式**と、許可されたパターン以外を全て拒否する**ホワイトリスト方式**があります。ブラックリスト方式は未知の攻撃に弱い一方、ホワイトリスト方式は誤検知が多くなる可能性があります。両者を組み合わせたり、AI(機械学習)で通信パターンを学習して異常を検知したりする、より高度なWAFも登場しています。

(3) プレースホルダは、SQLインジェクションに対する最も効果的で推奨される対策です。プログラムコード上では、SQL文の中に `?` などの記号を仮置きしておき、後から実際の値を「バインド」します。これにより、入力値がSQL文の構造に影響を与えることがなくなり、攻撃が成立しなくなります。

**【受験者向け発展解説】**
プレースホルダは「**静的プレースホルダ**」と「**動的プレースホルダ（エミュレーション）**」に大別されます。静的プレースホルダは、SQL文の構造と値を完全に分離してデータベースエンジンに渡すため、最も安全です。一方、動的プレースホルダは、プログラム側で値をエスケープ処理してからSQL文を組み立てるため、実装に不備があると脆弱性が残る可能性があります。可能な限り静的プレースホルダを利用することが推奨されます。

---
### ［設問］3
(1) ウ（サーバで稼働させるサービスに必要なポート番号だけを空け，他のポート番号へのアクセスは拒否する。）
(2) ファイルのハッシュ値を定期的に計算し、前回計算したハッシュ値と一致することを確認する。

### ［解説］
・用語
*   **ポート**: コンピュータが通信を行う際の、プログラムの種類を識別するための番号です。例えば、Web通信(HTTP)は80番、HTTPSは443番ポートを使います。
*   **ハッシュ値 (メッセージダイジェスト)**: あるデータから、ハッシュ関数という計算手順によって得られる、固定長のユニークな値です。元のデータが1ビットでも異なれば、ハッシュ値は全く異なる値になります。データの完全性（改ざんされていないこと）を確認するために利用されます。

・技術的背景：
(1) サーバのセキュリティ設定の基本は、不要なサービスを停止し、不要なポートを閉じることです。公開する必要のあるサービス（Webサーバなら80番や443番ポート）以外のポートを閉じておくことで、攻撃者が他のサービスの脆弱性を突いて侵入しようとする際の攻撃経路（アタックサーフェス）を減らすことができます。

**【受験者向け発展解説】**
この考え方は**サーバの要塞化（ハーデニング）** と呼ばれる活動の一部です。不要なポートを閉じるだけでなく、不要なソフトウェアのアンインストール、不要なアカウントの削除、デフォルトパスワードの変更、ログ設定の強化など、様々な設定を見直してサーバを堅牢にすることが含まれます。

(2) Webサイトのコンテンツファイル（HTML、画像ファイルなど）が改ざんされていないかを確認するためには、ハッシュ値を利用するのが有効です。正常な状態のファイルのハッシュ値を計算して保存しておき、定期的に現在のファイルのハッシュ値と比較します。もし値が異なっていれば、ファイルが何者かによって改ざんされたことを検知できます。これは、改ざん検知システム（Tripwireなど）で利用されている基本的な仕組みです。

**【受験者向け発展解説】**
このような改ざん検知システムは **FIM (File Integrity Monitoring)** と呼ばれます。FIMは、ファイルのハッシュ値だけでなく、ファイルの属性（パーミッション、所有者など）や設定ファイル（レジストリなど）の変更も監視することができます。PCI DSSなどのセキュリティ基準では、重要なシステムファイルに対するFIMの導入が要件とされています。

***

## 平成30年春期 午後問1：マルウェア感染への対応

### ［設問］1
(1) ア（感染したPCをネットワークから切り離す。）
(2) ウ（FWのログを調査し，不審なIPアドレスへの通信を遮断する。）
(3) 業務への影響の大きさ

### ［解説］
・技術的背景：
(1) マルウェア感染が判明した際の初動対応として最も重要なのは「封じ込め」です。感染したPCをネットワークに接続したままにしておくと、他のPCやサーバに感染を広げたり（横展開）、外部のC2サーバと通信して情報を漏えいさせたりする可能性があります。そのため、LANケーブルを抜くなどして、速やかにネットワークから物理的に隔離する必要があります。

**【受験者向け発展解説】**
インシデント対応の優先順位は、**1. 封じ込め、2. 証拠保全、3. 復旧** の順で考えるのが基本です。慌ててPCの電源を切ってしまうと、メモリ上に残っていた攻撃の痕跡が消えてしまう（証拠が失われる）可能性があります。理想的な手順は、まずネットワークから切り離して被害拡大を防ぎ（封じ込め）、次にメモリダンプやディスクイメージを取得して証拠を保全し、その後に再インストールなどの復旧作業に移ることです。

(2) マルウェアは外部のC2サーバと通信します。その通信は社内ネットワークの出口にあるファイアウォール(FW)を通過するため、FWの通信ログを調査することで、マルウェアの通信先IPアドレスを特定できます。通信先が判明したら、FWの設定でそのIPアドレス宛の通信を全て遮断し、これ以上の情報漏えいや遠隔操作を防ぎます。

**【受験者向け発展解説】**
FWのログだけでなく、**プロキシサーバ**や**DNSサーバ**のログも調査対象として極めて重要です。FWのログでは宛先IPアドレスしか分からない場合でも、プロキシのログを見れば宛先のドメイン名（URL）が、DNSのログを見れば名前解決しようとしたドメイン名が分かります。これらを組み合わせることで、攻撃者のインフラをより正確に特定できます。

(3) どのPCから復旧作業を開始するかを判断する際には、インシデントが業務に与える影響の大きさを考慮する必要があります。例えば、会社の基幹業務を担うサーバや、多くの社員が利用するファイルサーバなどが感染していた場合、それを放置すると業務全体が停止する恐れがあります。そのため、影響が大きく、かつ、復旧が急がれるシステムから優先的に対応するのが一般的です。

**【受験者向け発展解説】**
このような判断を迅速かつ的確に行うためには、平時から**資産管理**と**BIA (Business Impact Analysis / 事業影響度分析)** を行っておくことが重要です。どのサーバがどの業務を担っており、それが停止した場合に事業にどれくらいの損失（金銭的、信用的）が発生するのかを事前に評価しておくことで、有事の際に適切なトリアージ（優先順位付け）が可能になります。

---
### ［設問］2
(1) 脆弱性
(2) イ（脆弱性に対処するための修正プログラム）
(3) サンドボックス

### ［解説］
・用語
*   **脆弱性 (Vulnerability)**: OSやソフトウェアに存在する、セキュリティ上の欠陥や弱点です。
*   **セキュリティパッチ**: 脆弱性を修正するために、ソフトウェアのベンダーから提供されるプログラムのことです。
*   **サンドボックス (Sandbox)**: 通常のシステム環境から隔離された、安全な仮想環境のことです。外部から受け取った不審なファイルをサンドボックス内で実行し、その振る舞いを観察することで、ファイルがマルウェアであるかどうかを安全に判定できます。

・技術的背景：
(1) マルウェアは、OSやアプリケーションソフトウェアに存在するセキュリティ上の弱点、すなわち「脆弱性」を悪用してコンピュータに感染します。

**【受験者向け発展解説】**
脆弱性には、ソフトウェアのバグだけでなく、**設定不備**も含まれます。例えば、推測しやすいパスワードが設定されている、不要なサービスが起動している、といった状態も広義の脆弱性です。パッチ適用だけでなく、設定を見直す**サーバハーデニング**も脆弱性対策の重要な要素です。

(2) ソフトウェアベンダーは、自社製品に脆弱性が発見されると、それを修正するためのプログラム、すなわち「セキュリティパッチ」を開発し、ユーザに提供します。利用者はこれを適用することで、脆弱性を解消し、攻撃を防ぐことができます。

**【受験者向け発展解説】**
ベンダーからのサポートが終了した**EOL (End of Life)** や **EOS (End of Support)** の製品は、新たな脆弱性が発見されてもセキュリティパッチが提供されません。このような製品を使い続けることは非常にリスクが高いため、計画的に後継製品へ移行することが不可欠です。どうしても使い続ける必要がある場合は、**仮想パッチ（IPS/WAFなどによる代替的な防御策）** の適用や、ネットワークからの隔離といった追加の対策が必要になります。

(3) サンドボックスは、未知のマルウェアを検出するための有効な手段です。受信したメールの添付ファイルなどを、実際にユーザが使用する環境とは隔離されたサンドボックス内で仮想的に開いてみます。もしそのファイルが、不審な外部通信を始めたり、システムファイルを書き換えようとしたりするなどの悪意のある振る舞いを見せた場合、マルウェアであると判定してブロックすることができます。

**【受験者向け発展解説】**
サンドボックスは強力ですが、攻撃者側も対策を進めています。マルウェアの中には、自身が仮想環境（サンドボックス）で実行されていることを検知し、その場合は悪意のある振る舞いをせずに潜伏する**サンドボックス回避機能**を持つものがあります。そのため、サンドボックスによる検知をすり抜けるマルウェアも存在することを理解しておく必要があります。

***

## 平成29年秋期 午後問1：個人情報保護の強化

### ［設問］1
(1) 特定の個人を識別できないように個人情報を加工すること
(2) 目的外利用の禁止
(3) ア（データの暗号化）

### ［解説］
・用語
*   **匿名加工情報**: 個人情報保護法で定義されている、特定の個人を識別できないように個人情報を加工し、かつ、その個人情報を復元できないようにした情報のことです。
*   **目的外利用の禁止**: 個人情報を取り扱う事業者は、あらかじめ本人の同意を得ないで、特定された利用目的の達成に必要な範囲を超えて、個人情報を取り扱ってはならない、という個人情報保護法の原則です。

・技術的背景：
(1) ビッグデータ活用など、パーソナルデータの利活用を促進するため、個人情報保護法では、適切な加工（氏名の削除、住所の一般化など）を施すことで、本人の同意なく第三者提供などが可能になる「匿名加工情報」の仕組みが設けられています。

**【受験者向け発展解説】**
匿名加工情報と似た概念に**仮名加工情報**があります。
*   **匿名加工情報**: 他の情報と照合しても個人を識別できない。第三者提供が可能。
*   **仮名加工情報**: 他の情報と照合すれば個人を識別できる。内部での分析などに利用が限定され、原則として第三者提供は禁止。
この二つの違いは、個人情報保護法改正の重要ポイントであり、試験で問われる可能性があります。

(2) 個人情報保護法では、個人情報を取得する際に、その利用目的を具体的に特定し、本人に通知または公表することが義務付けられています。そして、その特定した目的の範囲を超えて個人情報を利用することは、原則として禁止されています。

**【受験者向け発展解説】**
この「利用目的の特定」は、プライバシーポリシーなどで公表されます。個人情報保護法では、本人から自身の情報の開示、訂正、利用停止などを求められた場合に、事業者が応じる義務も定めています。これらは技術的な話だけでなく、法律上の要件として理解しておく必要があります。

(3) PCの紛失や盗難による情報漏えいを防ぐための最も基本的な技術的対策は、ハードディスク（HDD）やSSD全体を暗号化することです。たとえPCが第三者の手に渡っても、データが暗号化されていれば、パスワードなどがなければ中身を読み出すことは極めて困難であり、情報の機密性を保護できます。

**【受験者向け発展解説】**
Windowsの**BitLocker**やmacOSの**FileVault**は、OSに標準で搭載されているディスク全体の暗号化機能です。これらの機能を利用することが、PCの紛失・盗難対策の第一歩となります。さらに、USBメモリなどの外部記憶媒体についても、暗号化機能付きの製品を利用したり、DLP製品で暗号化されていない媒体への書き込みを禁止したりする対策が有効です。

---
### ［設問］2
(1) イ（Webサーバへのアクセスを一元管理し，不正なアクセスを検知し，遮断する。）
(2) クロスサイトスクリプティング

### ［解説］
・用語
*   **リバースプロキシ**: 外部からのインターネットアクセスを一旦受け付け、背後にある複数のWebサーバにリクエストを振り分けるサーバです。Webサーバの負荷分散や、セキュリティ対策（不正アクセスの検知・遮断）の目的で利用されます。
*   **クロスサイトスクリプティング (XSS)**: 脆弱性のあるWebサイトの入力フォームなどに、悪意のあるスクリプトを埋め込む攻撃です。そのページを閲覧した他のユーザのブラウザ上でスクリプトが実行され、クッキー情報が盗まれたり、偽のページが表示されたりする被害が発生します。

・技術的背景：
(1) リバースプロキシをWebサーバの前段に設置することで、全てのアクセスをそこで集約できます。リバースプロキシにWAF（Web Application Firewall）のような機能を持たせることで、不正なリクエストを検知して遮断したり、アクセスログを一元的に管理したりすることが可能になり、Webサーバ群全体のセキュリティを効率的に強化できます。

**【受験者向け発展解説】**
リバースプロキシの主な役割は、**負荷分散（ロードバランシング）**、**SSL/TLS終端（SSLアクセラレーション）**、そして**セキュリティ**の3つです。SSL/TLS終端とは、リバースプロキシがクライアントとの暗号化通信を一旦解読し、背後のWebサーバとは平文で通信する機能です。これにより、Webサーバの暗号化処理の負荷を軽減できます。

(2) クロスサイトスクリプティングは、Webサイトの入力フォームなどに入力された内容を、適切にエスケープ処理（無害化）せずにそのまま画面に表示してしまう場合に発生します。攻撃者は、 `<script>alert('XSS')</script>` のようなスクリプトを埋め込み、他のユーザの意図しない動作を引き起こさせます。

**【受験者向け発展解説】**
XSSにはいくつかの種類があります。
*   **格納型（Stored）XSS**: 攻撃スクリプトがデータベースなどに保存され、そのページを閲覧した不特定多数のユーザが被害に遭う。
*   **反射型（Reflected）XSS**: 攻撃スクリプトが含まれたURLをユーザにクリックさせ、そのユーザのブラウザ上でのみ実行される。
*   **DOM-Based XSS**: サーバ側は関与せず、ブラウザ上でのJavaScriptの処理の不備を突いて実行される。
特に格納型XSSは被害が広範囲に及ぶため危険度が高いとされています。

---
### ［設問］3
(1) SQLインジェクション攻撃
(2) ログの定期的な監視を自動化し，不正の兆候を早期に検知するため
(3) ウ（複数のサーバのログを収集し，それらを関連付けて分析することによって，不正アクセスを検出する。）

### ［解説］
・用語
*   **SQLインジェクション**: Webアプリケーションへの入力値として、不正なSQL文の断片を送り込み、データベースを不正に操作する攻撃です。
*   **SIEM (Security Information and Event Management)**: 各種のサーバやネットワーク機器、セキュリティ製品などからログを収集・一元管理し、それらを自動的に相関分析することで、セキュリティインシデントの兆候を検知・通知するシステムです。

・技術的背景：
(1) エラーメッセージにSQL文やデータベースの情報がそのまま表示されてしまうと、攻撃者はそれをヒントにして、データベースの構造を推測したり、SQLインジェクション攻撃を試みたりすることが容易になります。これは、攻撃者に内部情報（脆弱性）を教えているのと同じことです。

**【受験者向け発展解説】**
このような、エラーメッセージなどからシステムの内部情報が漏れてしまう状態を**情報漏洩（Information Disclosure）** の脆弱性と呼びます。エラーメッセージは、利用者には汎用的なメッセージ（「エラーが発生しました」など）のみを表示し、詳細な情報はサーバのログにのみ記録するように実装することが重要です。

(2) 大量のログを目視で常に監視し続けるのは現実的ではありません。SIEMを導入し、ログの収集・分析を自動化することで、人手では見逃してしまうようなインシデントの予兆（例: 短時間での大量のエラーログ、深夜の管理者アクセスなど）を迅速に検知し、早期対応につなげることができます。

**【受験者向け発展解説】**
SIEMを効果的に運用するためには、平常時のログのパターンを把握しておくことが重要です。何が「正常」かを知らなければ、「異常」を検知することはできません。そのため、導入時には、検知ルールのチューニング（誤検知を減らし、検知漏れをなくす作業）が必要となります。

(3) SIEMの大きな特徴は、異なる種類のログを関連付けて分析（相関分析）できる点です。例えば、「ファイアウォールで不審なIPアドレスからのアクセスを検知」し、同時刻に「Webサーバで認証エラーが多発」し、さらに「データベースサーバで普段はないテーブルへのアクセス」があった、といった一連のイベントを結びつけて、単一のログでは分からない巧妙な攻撃として検知することが可能になります。

**【受験者向け発展解説】**
（令和6年秋期の解説と同様）SIEMは脅威検知の強力なプラットフォームですが、検知後の対応は人手で行う必要があります。この対応プロセスを自動化・効率化するのが**SOAR (Security Orchestration, Automation and Response)** です。SIEMとSOARを連携させることで、「検知」から「対応」までの一連の流れを迅速化することができます。

***

## 平成29年春期 午後問1：マルウェア対策

### ［設問］1
(1) 標的型攻撃
(2) サンドボックス
(3) C2サーバ

### ［解説］
・用語
*   **標的型攻撃**: 特定の組織を狙い、その組織の関係者を装ったメールを送るなど、巧妙な手口でマルウェアに感染させ、内部情報を窃取する攻撃です。
*   **サンドボックス**: システムから隔離された安全な仮想環境です。不審なファイルをこの中で実行し、その振る舞いを監視することで、マルウェアかどうかを安全に判定します。
*   **C2サーバ (コマンド&コントロールサーバ)**: マルウェアに感染したコンピュータを遠隔操作するための指令サーバです。攻撃者はこのサーバを介して、感染PCに命令を送ったり、盗んだ情報を収集したりします。

・技術的背景：
(1) 問題文にある「特定の組織を標的」とし、「業務に関係がありそうな件名や本文で送信」する手口は、標的型攻撃の典型的な特徴です。

**【受験者向け発展解説】**
標的型攻撃メールの手口は年々巧妙化しており、実際にやり取りされているメールの返信を装う**スレッドハイジャッキング**や、正規のファイル共有サービスからマルウェアをダウンロードさせる手口などが使われます。技術的な対策と同時に、従業員が「少しでも怪しいと思ったら報告する」という意識を持つことが重要です。

(2) 未知のマルウェアは、従来のパターンマッチング方式のアンチウイルスソフトでは検知できません。サンドボックスは、ファイルを実行した際の実際の「振る舞い」（特定のファイルを作成する、外部と通信しようとする等）を基にマルウェアかどうかを判断するため、未知の脅威に対しても有効な対策となります。

**【受験者向け発展解説】**
（平成30年春期の解説と同様）サンドボックス技術は、メールゲートウェイやSWG、EDRなど、様々なセキュリティ製品に組み込まれています。攻撃者側もサンドボックスを回避する技術を開発しており、両者はいたちごっこの関係にあります。そのため、サンドボックスだけで安心するのではなく、多層的な防御を行うことが不可欠です。

(3) マルウェアに感染したPCは、外部のC2サーバと定期的に通信（コールバック）を行い、攻撃者からの指令を待ちます。この通信を検知・遮断することが、マルウェア感染後の対策として非常に重要です。

**【受験者向け発展解説】**
C2サーバとの通信を検知するための情報として、**サイバー脅威インテリジェンス（CTI）** が活用されます。これは、他の組織で確認された攻撃で使われたC2サーバのIPアドレスやドメイン名のリスト（ブラックリスト）などを提供するサービスです。この情報を自社のファイアウォールやプロキシサーバに適用することで、未知のマルウェアであっても、その通信先から脅威を検知・ブロックできる可能性があります。

---
### ［設問］2
(1) イ（マルウェアの通信をプロキシサーバで中継し，通信内容を記録する。）
(2) 通信先を特定し，FWでその通信を遮断するため

### ［解説］
・用語
*   **プロキシサーバ**: 社内ネットワークからインターネットへのアクセスを代理で行うサーバです。通信を一元的に管理・監視できます。
*   **ファイアウォール (FW)**: ネットワークの境界で、ルールに基づいて通信を許可・遮断するセキュリティ機器です。

・技術的背景：
(1) マルウェアの通信内容や通信先の詳細を調査するためには、その通信を一度プロキシサーバで受け、内容を解析（SSLデコードなど）した上でログに記録する方法が有効です。これにより、暗号化された通信の内容も把握できる場合があります。

**【受験者向け発展解説】**
マルウェアの通信を調査する際には、感染PCを隔離した調査用の専用ネットワークセグメントに接続し、その通信をすべてキャプチャ・分析することがあります。この際、マルウェアに外部のC2サーバが実在するかのように見せかけるために、偽のDNSサーバやWebサーバを用意して応答を返す環境を**マルウェア解析環境**と呼びます。

(2) プロキシサーバやFWのログを分析してマルウェアの通信先（C2サーバのIPアドレスやドメイン名）を特定できれば、FWでその宛先への通信を全てブロックすることができます。これにより、マルウェアは外部の指令を受けられなくなり、情報漏えいを防ぐ「封じ込め」が可能になります。

**【受験者向け発展解説】**
通信先をブロックすることは有効な「封じ込め」ですが、攻撃者は通信先を頻繁に変えたり、多数用意したりするため、いたちごっこになる可能性があります。そのため、通信をブロックすると同時に、EDRなどで感染したPC自体を特定し、ネットワークから隔離したり、マルウェアを駆除したりする「根絶」に向けた活動を並行して進める必要があります。

---
### ［設問］3
(1) 実行ファイルが添付されたメールを受信した場合，実行ファイルを削除する。
(2) エ（マルウェアの感染が他のPCに拡大するのを防ぐ。）

### ［解説］
・技術的背景：
(1) 実行形式のファイル（.exe, .scr, .cplなど）は、マルウェアを直接送り込む手口として非常に多用されます。業務上、そのようなファイルをメールでやり取りする必要性が低いのであれば、メールゲートウェイで一律に添付された実行ファイルを削除（または隔離）する設定は、単純かつ効果的なマルウェア感染防止策となります。

**【受験者向け発展解説】**
実行ファイルだけでなく、マクロ付きのOffice文書（.docm, .xlsmなど）もマルウェアの感染経路として非常に多用されます。そのため、メールゲートウェイでマクロを自動的に除去する機能や、PC側でOffice文書のマクロをデフォルトで無効化する設定も、同様に効果的な対策となります。近年では、実行ファイルをZIPで圧縮し、さらにパスワードをかけることでウイルススキャンを回避する手口も増えています。

(2) マルウェアの中には、感染したPCを起点として、ネットワーク内の他のPCの脆弱性を探して感染を広げる「ワーム」のような機能を持つものがあります。PCをネットワークから切り離す「隔離」は、このような横方向への感染拡大（ラテラルムーブメント）を防ぎ、被害を最小限に食い止めるための最も基本的かつ重要な「封じ込め」措置です。

**【受験者向け発展解説】**
（令和4年秋期の解説と同様）ラテラルムーブメントを防ぐためには、PCの隔離といった事後対策だけでなく、平時からのネットワーク設計が重要です。**ネットワークセグメンテーション（VLANなど）**によってネットワークを分割し、セグメント間の通信を厳しく制限しておくことで、万が一マルウェアが侵入しても、被害を特定のセグメント内に封じ込めることができます。

***

## 平成28年秋期 午後問1：生体認証システムの導入

### ［設問］1
(1) 本人拒否率（FRR）
(2) 他人受入率（FAR）
(3) a: 低く, b: 高く

### ［解説］
・用語
*   **生体認証 (バイオメトリクス)**: 指紋、顔、静脈、虹彩といった、個人の身体的または行動的特徴を用いて本人認証を行う技術です。
*   **本人拒否率 (FRR: False Rejection Rate)**: 本人であるにもかかわらず、誤って認証が拒否されてしまう確率です。「タイプ1エラー」とも呼ばれます。
*   **他人受入率 (FAR: False Acceptance Rate)**: 他人であるにもかかわらず、誤って認証が許可されてしまう確率です。「タイプ2エラー」とも呼ばれます。

・技術的背景：
(1)〜(3) 生体認証システムでは、FRRとFARはトレードオフの関係にあります。認証の厳格度を高めると、他人を受け入れてしまう確率（FAR）は低くなりますが、その分、本人であっても指の状態などによってはじかれてしまう確率（FRR）が高くなり、利便性が損なわれます。逆に、認証の厳格度を下げると、本人が通りやすくなりFRRは低くなりますが、他人が誤って通ってしまうFARが高くなり、セキュリティが低下します。システムを導入する際は、求めるセキュリティレベルと利便性のバランスを考慮して、この閾値を調整する必要があります。

**【受験者向け発展解説】**
このFRRとFARのトレードオフの関係をグラフにしたものを**ROC曲線（Receiver Operating Characteristic curve）** と呼びます。FRRとFARが交差する点を**EER (Equal Error Rate / 等価エラー率)** といい、この値が低いほど、その生体認証システムの認証精度が高いと評価されます。試験でFARとFRRの関係性が問われた際は、このトレードオフの関係を思い出せば解答できます。

---
### ［設問］2
(1) マニューシャ
(2) 特徴情報をDBに登録しておき、認証時に入力された生体情報から抽出した特徴情報と照合する。
(3) 生体情報そのものをDBに保存しないので、漏えいしても元々の生体情報が復元できない。

### ［解説］
・用語
*   **マニューシャ (Minutiae)**: 指紋の隆線が分岐している点（分岐点）や、途切れている点（端点）といった特徴点のことです。

・技術的背景：
(1) 指紋認証システムでは、指紋の画像そのものではなく、マニューシャの位置や角度、隆線間の関係性といった特徴情報を抽出して、認証に利用します。

**【受験者向け発展解説】**
指紋認証には、マニューシャ方式の他に、指紋全体の模様（パターン）を照合する**パターンマッチング方式**もあります。マニューシャ方式は計算量が少なく高速ですが、指の一部しか読み取れない場合や、指紋が不鮮明な場合に弱いという特徴があります。両者を組み合わせたハイブリッド方式も存在します。

(2) 生体認証システムでは、まず利用者の生体情報から特徴情報を抽出し、テンプレートとしてデータベースに登録しておきます（事前登録）。認証時には、カメラやセンサーから読み取った生体情報から同様に特徴情報を抽出し、データベースに登録されたテンプレートと照合して、一致度（スコア）が閾値以上であれば本人と判断します。

**【受験者向け発展解説】**
生体認証の認証方式には、サーバで特徴情報を照合する**サーバ認証方式**と、ICカードやスマートフォン端末内で照合を行う**デバイス認証方式**があります。後者は、生体情報が端末の外に出ないため、プライバシー保護の観点から優れています。パスワードレス認証規格である**FIDO**は、このデバイス認証方式をベースにしています。

(3) 生体情報は、パスワードと違って変更することができない、究極の個人情報です。そのため、指紋の画像データそのものをデータベースに保存するのは、漏えい時のリスクが非常に高いです。特徴情報（マニューシャ）だけを保存しておけば、万が一そのデータが漏えいしても、そこから元の指紋画像を復元することは極めて困難なため、より安全にシステムを運用できます。

**【受験者向け発展解説】**
特徴情報であっても、漏えいした際のリスクはゼロではありません。そのため、特徴情報をさらに暗号化したり、**キャンセラブル生体認証**という技術を用いたりすることがあります。これは、元の生体情報から生成した特徴情報を、意図的に歪ませた（変換した）上で登録する技術です。万が一漏えいしても、変換パラメータを変更して再登録することで、元の特徴情報を無効化できるため、パスワードのように「変更可能」な生体認証を実現できます。

***

## 平成28年春期 午後問1：Webサイトを用いた書籍販売システムのセキュリティ

### ［設問］1
(1) クロスサイトスクリプティング
(2) Webサイトのフォームに入力されたスクリプトが、他の利用者のブラウザで実行される。
(3) 入力された文字をHTMLタグとして解釈されないように、別の文字列に置き換える。

### ［解説］
・用語
*   **クロスサイトスクリプティング (XSS)**: 脆弱性のあるWebサイトの掲示板や入力フォームなどに、攻撃者が悪意のあるスクリプトを埋め込み、そのページを閲覧した他のユーザのブラウザ上でスクリプトを実行させる攻撃です。
*   **エスケープ処理 (サニタイジング)**: `<` や `>` といった、HTMLにおいて特別な意味を持つ文字を、単なる文字列として表示される `&lt;` や `&gt;` といった別の文字列（HTMLエンティティ）に変換する処理です。

・技術的背景：
(1) 問題文にある「書籍の紹介文に悪意のあるスクリプトを埋め込み」「紹介文を閲覧した他の利用者のWebブラウザ上で実行」という手口は、クロスサイトスクリプティング（特に、保存型XSS）の典型的なシナリオです。

**【受験者向け発展解説】**
（平成29年秋期の解説と同様）XSSには**格納型（Stored）**、**反射型（Reflected）**、**DOM-Based**の3種類があり、この設問は格納型XSSに該当します。それぞれの特徴と違いを理解しておくことが重要です。

(2) 攻撃者が埋め込んだスクリプトは、Webサイトのデータベースに保存されます。そして、他のユーザがその書籍の紹介ページを閲覧しようとすると、Webサーバはデータベースからスクリプトが埋め込まれた紹介文を取り出し、そのままHTMLの一部としてユーザのブラウザに送信します。ブラウザはそれを信頼されたWebサイトからのスクリプトとして実行してしまい、クッキー情報の窃取などの被害が発生します。

**【受験者向け発展解説**】
XSS攻撃によって盗まれることが多いのが、ユーザのセッション情報を保持した**Cookie**です。攻撃者は、`document.cookie` といったJavaScriptを用いてCookieを読み取り、自身のサーバに送信するスクリプトを埋め込みます。これにより、ユーザになりすます**セッションハイジャック**攻撃が可能になります。

(3) XSSの最も基本的な対策は、利用者からの入力値をWebページに出力する際に、エスケープ処理を施すことです。例えば、 `<script>` という入力は `&lt;script&gt;` に変換されます。これにより、ブラウザはこれをスクリプトとして実行せず、単なる文字列として画面に表示するため、攻撃が成立しなくなります。

**【受験者向け発展解説】**
エスケープ処理は、出力する場所（コンテキスト）に応じて適切な方法を選択する必要があります。HTMLのボディ部分に出力する場合（HTMLエスケープ）、JavaScriptのコード内に出力する場合（JavaScriptエスケープ）、URLのパラメータとして出力する場合（URLエンコード）など、それぞれ異なる処理が必要です。これを怠ると、対策が不十分となり脆弱性が残ってしまいます。フレームワークなどが提供する自動エスケープ機能を利用することが推奨されます。

---
### ［設問］2
(1) SQLインジェクション
(2) プレースホルダ

### ［解説］
・用語
*   **SQLインジェクション**: Webアプリケーションが想定していない不正なSQL文を意図的に入力することで、データベースを不正に操作する攻撃です。
*   **プレースホルダ (バインド機構)**: SQL文を組み立てる際に、外部から入力される値を後から安全に埋め込むための仕組みです。入力値がSQL文の構文として解釈されるのを防ぎます。

・技術的背景：
(1) 利用者からの入力文字列をチェックせずに、直接SQL文の組み立て（文字列連結）に使用すると、SQLインジェjectionの脆弱性が生まれます。例えば、ID入力欄に ` ' OR 1=1 -- ` といった文字列を入力されると、WHERE句の条件が常に真となり、認証を突破されるなどの被害につながります。

**【受験者向け発展解説】**
この設問の例は認証回避ですが、SQLインジェクションは情報の窃取、改ざん、削除、さらにはデータベースサーバのOSコマンド実行など、極めて深刻な被害を引き起こす可能性があります。Webアプリケーションの脆弱性の中でも、最も危険なものの一つとして認識されています。

(2) プレースホルダはSQLインジェクションに対する最も安全で効果的な対策です。SQL文のテンプレート（例： `SELECT * FROM users WHERE id = ?`）を先にデータベースに渡しておき、後から入力値（`?` の部分）をデータとして渡します。これにより、入力値はSQLの構文として解釈されることがなくなり、攻撃を防ぐことができます。

**【受験者向け発展解説】**
（平成30年秋期の解説と同様）プレースホルダを利用することが最も推奨される対策ですが、それが困難な場合は、入力値の**エスケープ処理**や、入力値を特定のパターンに限定する**バリデーション**も重要な防御策となります。ただし、これらは実装が複雑になりがちで、不備があると脆弱性が残りやすいため、プレースホルダの利用が第一選択肢となります。

---
### ［設問］3
(1) ウ（推測されやすいパスワードが使われないように，パスワードの複雑さをチェックする。）
(2) 総当たり攻撃（ブルートフォース攻撃）
(3) アカウントロック

### ［解説］
・用語
*   **総当たり攻撃 (ブルートフォース攻撃)**: パスワードを解読するために、考えられる全ての文字の組み合わせを片っ端から試行する攻撃手法です。
*   **アカウントロック**: ログイン試行が一定回数連続して失敗した場合に、そのアカウントを一時的に利用できなくする機能です。

・技術的背景：
(1) `password` や `123456` といった単純なパスワードは、辞書攻撃やブルートフォース攻撃によって容易に破られてしまいます。そのため、システム側でパスワードの最小文字数や、英字・数字・記号を混在させるといったルール（パスワードポリシー）を強制し、利用者に推測されにくい複雑なパスワードを設定させることは、不正ログイン対策の基本です。

**【受験者向け発展解説】**
パスワードポリシーに加え、既知の漏洩パスワードリストと照合し、利用者が使い回しのパスワードを設定できないようにする**漏洩パスワードチェック**も有効な対策です。また、パスワードの定期的な変更を強制するポリシーは、現在ではセキュリティ上の効果が疑問視されており、むしろ長く複雑なパスワードを使い続ける方が良いとする考え方が主流になりつつあります。

(2) ブルートフォース攻撃は、プログラムによって自動的に、高速で何百万、何千万通りものパスワードを試行します。

**【受験者向け発展解説】**
（令和4年秋期の解説と同様）ブルートフォース攻撃と**パスワードスプレー攻撃**の違いを理解しておきましょう。前者は「1アカウント対多パスワード」、後者は「多アカウント対1パスワード」のアプローチであり、アカウントロックを回避しやすい後者が近年の主流となっています。

(3) アカウントロックは、ブルートフォース攻撃やパスワードリスト攻撃に対する有効な対策です。例えば、「5回連続でパスワードを間違えたら、30分間ログインできなくする」といった設定をしておくことで、攻撃者が短時間に大量の試行を行うことを物理的に困難にし、攻撃の効率を大幅に低下させることができます。

**【受験者向け発展解説】**
アカウントロックは有効な対策ですが、副作用もあります。攻撃者が意図的に特定のユーザのアカウントをロックさせることで、そのユーザがサービスを利用できなくする**サービス妨害（DoS）攻撃**に悪用される可能性があります。そのため、ロック時間は適切に設定し、本人であればメールなどで容易にロック解除できる仕組みを用意しておくことが望ましいです。

***

## 平成27年秋期 午後問1：ソーシャルネットワーキングサービスのセキュリティ

### ［設問］1
(1) オープンリダイレクト
(2) 利用者を偽のサイトに誘導し、ID、パスワードなどの情報を入力させる。
(3) 遷移先のURLが、あらかじめ許可されたドメインのURLであるか検査する。

### ［解説］
・用語
*   **オープンリダイレクト (不適切なリダイレクト)**: Webサイトに、外部の任意のURLへリダイレクト（転送）できてしまう脆弱性がある状態を指します。

・技術的背景：
(1) ログイン後の遷移先URLをパラメータとして受け取るような実装で、そのURLのチェックが不十分な場合にオープンリダイレクトの脆弱性が生まれます。攻撃者は、この脆弱性を悪用し、正規サイトのURLに、遷移先として悪意のあるサイトのURLをパラメータに含めたリンクを作成します。

**【受験者向け発展解説】**
この攻撃の巧妙な点は、ユーザにクリックさせるURLのドメイン名部分が**正規のサイトのもの**であるという点です。例えば `https://www.example.jp/login?redirect_to=http://evil-site.com` のようなURLです。利用者はドメイン名を見て安心してクリックしてしまい、フィッシングサイトに誘導されてしまいます。

(2) 利用者は、URLのドメイン名が信頼できる正規サイトのものであるため、安心してリンクをクリックしてしまいます。クリックすると、一旦正規サイトにアクセスした後、脆弱性によって即座に攻撃者が用意した偽のサイト（フィッシングサイト）に転送されてしまいます。利用者は偽サイトとは気づかずに、IDやパスワードを入力してしまい、情報が盗まれます。

**【受験者向け発展解説】**
この手口は、フィッシング詐欺を成功させるための「補助輪」として悪用されます。正規のサイトのドメイン名を悪用することで、フィッシングメールの検知をすり抜けたり、利用者の警戒心を解いたりする効果があります。

(3) この脆弱性の対策は、リダイレクト先のURLをサーバ側で厳密に検証することです。具体的には、リダイレクトを許可するドメインやURLのリスト（ホワイトリスト）をあらかじめ用意しておき、パラメータで渡されたURLがそのリストに含まれている場合のみリダイレクトを実行するようにします。

**【受験者向け発展解説】**
ホワイトリスト方式が最も安全な対策です。どうしても任意のURLへのリダイレクトが必要な場合は、リダイレクトする前に「あなたは外部サイトへ移動します」といった**警告ページ（クッションページ）**を挟み、利用者に注意を促すという対策も考えられます。

---
### ［設問］2
(1) クリックジャッキング
(2) iframe要素
(3) HTTPレスポンスヘッダに、X-Frame-Optionsヘッダを追加する。

### ［解説］
・用語
*   **クリックジャッキング (Clickjacking)**: Webサイトの視覚的な表現を悪用する攻撃です。攻撃者が用意したWebページの上に、透明にした標的サイトのページを重ねて表示し、利用者が攻撃者のページ上のボタンなどをクリックしているつもりが、実際には標的サイトのボタン（「退会する」「送金する」など）をクリックさせられてしまう、という手口です。
*   **iframe要素**: HTMLの要素の一つで、Webページ内に別のWebページを埋め込むために使用されます。
*   **X-Frame-Options**: HTTPレスポンスヘッダの一つで、ブラウザに対して、そのページを`<frame>`や`<iframe>`、`<object>`の中に表示することを許可するかどうかを指示するために使われます。クリックジャッキング対策として有効です。

・技術的背景：
(1) 問題文にある「利用者をだまして意図しない操作をさせる攻撃」で、「SNSサイトを透明にして罠サイトに重ねて表示」する手口は、クリックジャッキングの典型的なシナリオです。

**【受験者向け発展解説】**
この攻撃は、利用者が標的サイトにログイン済みであることを前提としています。利用者は、罠サイトの「景品が当たる！」といったボタンをクリックしているつもりで、実際には透明化されたSNSサイトの「アカウント削除」ボタンなどをクリックさせられてしまいます。

(2) 攻撃者は、自身の罠サイトで`<iframe>`タグを使い、その中に標的のSNSサイトを読み込みます。そして、CSSの`opacity`プロパティなどを使ってiframeを透明にし、罠サイトのボタンなどの真上に重ねて配置します。

**【受験者向け発展解説】**
iframeは、YouTube動画の埋め込みなど、正当な目的で広く使われているHTMLの標準機能です。クリックジャッキングは、この標準機能を悪用することで攻撃が成立します。

(3) クリックジャッキング対策として、WebサーバはHTTPレスポンスに `X-Frame-Options` ヘッダを含めるべきです。このヘッダに `DENY`（全てのフレーム表示を拒否）や `SAMEORIGIN`（同一生成元のページからのフレーム表示のみ許可）を設定しておくことで、第三者のサイトが`<iframe>`で自サイトのページを読み込むことをブラウザレベルで禁止でき、攻撃を防ぐことができます。

**【受験者向け発展解説】**
`X-Frame-Options` は広く普及していますが、より新しい規格として **CSP (Content Security Policy)** の `frame-ancestors` ディレクティブがあります。こちらは、複数のドメインを許可するなど、より柔軟な設定が可能です。`X-Frame-Options` とCSPの両方が指定された場合、CSPが優先されるブラウザが多いため、今後はこちらの利用が主流になると考えられます。

---
### ［設問］3
(1) CSRF (クロスサイトリクエストフォージェリ)
(2) ログインしている利用者からの正規のリクエストとしてサーバが処理してしまうから
(3) トークン

### ［解説］
・用語
*   **CSRF (Cross-Site Request Forgery)**: 攻撃者が用意した罠サイトなどを利用して、Webサイトにログイン中のユーザの意図しないリクエスト（掲示板への書き込み、商品購入など）を、そのユーザのブラウザからサーバに送信させる攻撃です。
*   **トークン (Token)**: CSRF対策で使われる、サーバが生成する推測困難なランダムな文字列のことです。「ワンタイムトークン」とも呼ばれます。

・技術的背景：
(1) 利用者が正規サイトにログインした状態で、悪意のある罠サイトを閲覧すると、罠サイトに埋め込まれたスクリプトなどが、ユーザのブラウザに、正規サイトへの意図しないリクエスト（例: `http://example.com/buy?item=123`）を自動的に送信させます。

**【受験者向け発展解説**】
CSRFは、状態が変化するリクエスト（投稿、購入、退会など）が主な攻撃対象となります。攻撃者は、罠サイトに`<img>`タグなどを埋め込み、その`src`属性に攻撃用のURLを指定するだけで、利用者がページを開いた瞬間に自動的にリクエストを送信させることができます。

(2) ブラウザは、正規サイトへのリクエストを送信する際に、そのサイトのCookie（セッションIDなど）を自動的に添付します。そのため、サーバ側から見ると、そのリクエストは正規のセッションを持つ本人からの正当なリクエストと区別がつかず、意図しない処理を実行してしまいます。

**【受験者向け発展解説】**
この「ブラウザがCookieを自動送信する」という仕様がCSRFの根本原因です。この仕様自体はWebの利便性を支える重要なものですが、攻撃者に悪用される側面も持っています。

(3) CSRFの一般的な対策は、**トークン**の利用です。重要な処理を行うフォーム画面を生成する際に、サーバは推測困難なトークンを生成し、非表示パラメータ（hidden属性）としてフォームに埋め込みます。ユーザがフォームを送信する際、このトークンも一緒に送られます。サーバ側では、リクエストを受け取った際に、自身が発行したトークンと一致するかを検証します。攻撃者はこのトークンを知ることができないため、不正なリクエストを偽造することができなくなります。

**【受験者向け発展解説】**
トークンによる対策に加え、**SameSite属性**をCookieに設定することも有効な対策です。`SameSite=Strict` や `SameSite=Lax` を設定すると、外部サイトからのリクエストにはCookieが送信されなくなるため、CSRF攻撃を防ぐことができます。また、重要な操作の前には**パスワードの再入力**を求めることも、利用者の意図を確認する上で有効です。

***

## 平成27年春期 午後問1：電子メールのセキュリティ

### ［設問］1
(1) STARTTLS
(2) ウ（PCとメールサーバ間の通信が暗号化されるので，盗聴されてもメールの内容が漏えいしない。）

### ［解説］
・用語
*   **STARTTLS**: 暗号化されていない平文の通信経路上で、暗号化された通信（SSL/TLS）を開始するためのコマンドです。メールの送受信プロトコルであるSMTPやPOP3、IMAP4で利用されます。
*   **SMTP (Simple Mail Transfer Protocol)**: 電子メールを送信・転送するためのプロトコルです。
*   **POP3 (Post Office Protocol version 3) / IMAP4 (Internet Message Access Protocol version 4)**: 電子メールを受信するためのプロトコルです。

・技術的背景：
(1) 通常のSMTP（25番ポート）やPOP3（110番ポート）の通信は暗号化されていません。STARTTLSは、これらの既存のポートを使いつつ、通信の途中で暗号化を開始する仕組みです。クライアントがサーバにSTARTTLSコマンドを送ると、そこからSSL/TLSのハンドシェイクが始まり、以降の通信が暗号化されます。最初から暗号化されたポート（SMTPS: 465番, POP3S: 995番）を使う方法もあります。

**【受験者向け発展解説】**
STARTTLSは、平文通信から暗号化通信へ「格上げ」する方式です。この格上げの交渉段階を狙い、暗号化通信を妨害して平文通信を強制する**ダウングレード攻撃**を受ける可能性があります。これに対し、最初から暗号化ありきで通信を開始する**SMTPS (465/TCP) や POP3S (995/TCP)** は、そのような攻撃を受けにくいため、より安全とされています。これを **Implicit TLS (暗黙的TLS)** と呼び、STARTTLSは **Explicit TLS (明示的TLS)** と呼ばれます。

(2) PCとメールサーバ間の通信経路（例えば、公衆無線LANなど）で盗聴が行われた場合、通信が暗号化されていないと、メールの本文だけでなく、認証に使われるIDやパスワードも平文のまま盗まれてしまいます。STARTTLSやSMTPS/POP3Sを利用して通信を暗号化することで、たとえ通信が傍受されても内容を解読されることを防ぎ、盗聴による情報漏えいを防止できます。

**【受験者向け発展解説】**
ここで暗号化されるのは、あくまでPC（メールクライアント）とメールサーバ間の通信**経路**です。メールサーバに保存されているメールデータや、サーバから別のサーバへ転送される際の通信が暗号化されるとは限りません。メールの**内容**そのものを端から端まで（End-to-End）暗号化するためには、**S/MIME**や**PGP**といった技術が必要になります。

---
### ［設問］2
(1) OP25B (Outbound Port 25 Blocking)
(2) SMTP-AUTH (SMTP Authentication)
(3) サブミッションポート

### ［解説］
・用語
*   **OP25B (Outbound Port 25 Blocking)**: プロバイダ（ISP）のネットワークから外部のネットワークへの、宛先ポート番号25番のSMTP通信を遮断する、迷惑メール対策です。
*   **SMTP-AUTH (SMTP Authentication)**: メール送信時に、ユーザIDとパスワードによる認証を行うSMTPの拡張機能です。
*   **サブミッションポート (Submission Port)**: メールソフト（MUA）からメールサーバ（MSA）へメールを送信（投入）するために予約されている専用のポート番号で、通常587番ポートが使われます。

・技術的背景：
(1) 迷惑メール（スパム）の多くは、ウイルスに感染してボットとなった一般家庭のPCから、直接相手先のメールサーバ（宛先ポート25番）へ送信されます。OP25Bは、このようなボットからのスパム送信を防ぐために、自社のネットワーク内からは、自社が用意した正規のメールサーバ以外へのSMTP通信を許可しないようにする対策です。

**【受験者向け発展解説】**
OP25Bは、ISP（プロバイダ）が自社のネットワークを守るための対策です。これにより、利用者は契約しているISPのメールサーバを利用してメールを送信することが強制されます。

(2) OP25Bが導入されると、利用者はプロバイダが指定するメールサーバを使わなければなりません。その際、誰でも自由にメールサーバを使えると迷惑メールの温床になるため、正規の契約者であることを確認する認証（SMTP-AUTH）が必要になります。

**【受験者向け発展解説】**
SMTP-AUTHは、メール送信時にユーザIDとパスワードで認証を行う仕組みです。パスワードが平文で流れないように、**CRAM-MD5**や**LOGIN**、**PLAIN**といった認証方式が使われますが、これらはSTARTTLSなどで通信経路全体が暗号化されていることが前提となります。

(3) メールサーバ間の転送に使われる25番ポートと、利用者からのメール送信を受け付けるポートを分ける考え方から、サブミッションポート（587番）が標準化されました。利用者は、OP25Bの影響を受けないこのサブミッションポートとSMTP-AUTHを組み合わせて利用することで、安全にメールを送信できます。

**【受験者向け発展解説】**
メールに関するポート番号の役割分担を整理しておきましょう。
*   **25番 (SMTP)**: 主に**サーバ間**のメール転送に使われる。
*   **110番 (POP3)**: メール受信に使われる。
*   **143番 (IMAP4)**: メール受信に使われる。（POP3より高機能）
*   **587番 (Submission)**: 主に**クライアントからサーバ**へのメール送信に使われる。SMTP-AUTHが必須。
*   **465番 (SMTPS)**: 587番と同様、クライアントからのメール送信に使われる。（SSL/TLSが必須）
この使い分けは非常に重要です。

---
### ［設問］3
(1) SPF (Sender Policy Framework)
(2) DKIM (DomainKeys Identified Mail)

### ［解説］
・用語
*   **なりすましメール**: 送信者のメールアドレス（Fromアドレス）を偽装し、他人になりすまして送信されるメールです。
*   **SPF (Sender Policy Framework)**: 送信元ドメインのDNSサーバに、そのドメイン名を送信元としてメールを送ることを許可された、メールサーバのIPアドレスを登録しておく仕組みです。受信側は、メールを受け取った際に、送信元サーバのIPアドレスがDNSに登録されているものと一致するかを検証します。
*   **DKIM (DomainKeys Identified Mail)**: 送信側メールサーバが、メールヘッダと本文から生成したハッシュ値に対して、自身の秘密鍵で電子署名を行う仕組みです。受信側は、送信元ドメインのDNSサーバで公開されている公開鍵を使って署名を検証し、送信元の正当性とメールが改ざんされていないことを確認します。

・技術的背景：
(1) SPFは、送信元IPアドレスを基準になりすましを検知します。例えば、ドメイン`example.jp` のSPFレコードに `v=spf1 ip4:203.0.113.1 -all` と登録されていれば、受信側は `example.jp` からのメールが `203.0.113.1` 以外のIPアドレスから送られてきた場合に、なりすましの可能性が高いと判断できます。

**【受験者向け発展解説**】
SPFの弱点は、メールが**転送**されると認証に失敗する場合があることです。転送サーバのIPアドレスは、元の送信元ドメインのSPFレコードには登録されていないため、受信側でSPF認証が失敗してしまいます。この弱点を補うのがDKIMです。

(2) DKIMは、電子署名を基になりすましと改ざんを検知します。メールが転送される過程で送信元IPアドレスが変わってしまうような環境でも、署名が維持されていれば正しく検証できるという利点があります。SPFとDKIMは、それぞれ異なる側面からなりすましを検知する技術であり、両方を組み合わせて利用することで、より強固な対策となります。これらの認証結果を基に、メールをどう扱うか（受信、拒否、隔離など）を送信側がポリシーとして宣言する技術がDMARCです。

**【受験者向け発展解説】**
（令和5年秋期の解説と同様）SPF、DKIM、そして両者を統合する**DMARC**は、三位一体で送信ドメイン認証を実現します。
*   **SPF**: 送信元IPアドレスを認証
*   **DKIM**: 送信元ドメインの正当性と改ざんの有無を電子署名で認証
*   **DMARC**: SPF/DKIMの認証結果に基づき、メールの取り扱いポリシーを決定し、認証結果を送信者にフィードバックする。
この3つの関係性は試験の頻出論点です。

***

## 平成26年秋期 午後問1：ネットワークやWebアプリケーションプログラムのセキュリティ

### ［設問］1
(1) ア（DNSサーバのキャッシュに偽の情報を登録させる。）
(2) DNSSEC
(3) ウ（DNSの応答メッセージに付与されたディジタル署名を検証する。）

### ［解説］
・用語
*   **DNSキャッシュポイズニング**: DNSサーバのキャッシュに偽のドメイン情報を注入し、利用者を不正なWebサイトに誘導する攻撃です。
*   **DNSSEC (DNS Security Extensions)**: DNSの応答の「送信元の正当性」と「データの完全性」を保証するための拡張仕様です。公開鍵暗号技術に基づいた電子署名を利用します。

・技術的背景：
(1) DNSキャッシュポイズニング攻撃では、攻撃者はキャッシュDNSサーバが権威DNSサーバに問い合わせを行うタイミングを狙い、本物の応答より先に偽の応答（例：銀行のドメインと偽サイトのIPアドレスの対応）を送りつけます。キャッシュDNSサーバがこれを信じてキャッシュに保存してしまうと、以降、そのサーバを利用するユーザは全員偽サイトに誘導されてしまいます。

**【受験者向け発展解説】**
（令和3年春期の解説と同様）この攻撃を防ぐための緩和策として**ソースポートランダマイゼーション**があります。DNSクエリを送信する際の送信元ポート番号をランダムにすることで、攻撃者が偽の応答を送りつける際に推測すべきパラメータを増やし、攻撃を困難にします。

(2) DNSSECは、DNSキャッシュポイズニングに対する根本的な対策技術です。

**【受験者向け発展解説】**
DNSSECは、DNS応答に「正当性」と「完全性」をもたらしますが、「機密性」は提供しません。つまり、DNSの問い合わせ内容自体は暗号化されないため、経路上で盗聴される可能性があります。このプライバシー問題を解決する技術が**DNS over HTTPS (DoH)** や **DNS over TLS (DoT)** です。これらはDNSの通信自体を暗号化する仕組みであり、DNSSECとは目的が異なります。

(3) DNSSECでは、権威DNSサーバが自身の持つDNS情報（ゾーンデータ）に秘密鍵で電子署名を付けて応答します。キャッシュDNSサーバは、事前に信頼している公開鍵を使ってこの署名を検証します。署名が正しければ、その応答が正当な管理者から来たものであり、途中で改ざんされていないことが確認できるため、偽の情報をキャッシュすることを防げます。

**【受験者向け発展解説】**
DNSSECの署名検証は、ルートDNSサーバを頂点とした**信頼の連鎖（Chain of Trust）** によって成り立っています。キャッシュDNSサーバはルートの公開鍵を信頼することで、そこから順に.jpドメイン、example.jpドメインへと署名を検証していくことができます。これは、SSL/TLSにおけるサーバ証明書の検証モデルと似た考え方です。

---
### ［設問］2
(1) エ（Webアプリケーションの入力項目に不正なSQL文を入力し、データベースを不正に操作する。）
(2) プレースホルダ
(3) WAF

### ［解説］
・用語
*   **SQLインジェクション**: Webアプリケーションの脆弱性を利用して、データベースを不正に操作する攻撃です。
*   **プレースホルダ (バインド機構)**: SQL文の組み立てにおいて、外部からの入力値を安全に取り扱うための仕組みです。
*   **WAF (Web Application Firewall)**: Webアプリケーションへの攻撃を検知・防御することに特化したファイアウォールです。

・技術的背景：
(1) 選択肢エの説明は、SQLインジェクション攻撃そのものの定義です。

**【受験者向け発展解説】**
（平成28年春期の解説と同様）SQLインジェクションは、Webアプリケーションの脆弱性診断において最も頻繁に発見される脆弱性の一つです。入力値の検証漏れが主な原因であり、その影響は情報漏洩からデータの破壊、サーバの乗っ取りまで多岐にわたります。

(2) プレースホルダは、入力値をSQL文の「リテラル（値）」として扱い、「構文」の一部としては解釈させないようにする仕組みです。これにより、攻撃者が入力値にSQL文の断片を紛れ込ませても、それが実行されることはなく、攻撃を防ぐことができます。これはSQLインジェクションに対する最も推奨される対策方法です。

**【受験者向け発展解説】**
（平成30年秋期の解説と同様）プログラムでSQL文を組み立てる際に、文字列を連結して組み立てている箇所があれば、そこがSQLインジェクションの脆弱性となりえます。プレースホルダ（バインド機構）を使用することで、この問題を根本的に解決できます。

(3) WAFは、Webサーバの前段に設置され、HTTPリクエストの内容を詳細に検査します。SQLインジェクション攻撃でよく使われる特徴的な文字列（`' OR 1=1`, `UNION SELECT`など）をパターンとして検知し、そのようなリクエストを遮断することで、脆弱性のあるWebアプリケーションを保護します。

**【受験者向け発展解説】**
WAFは、アプリケーション本体を修正することなく、外部からの攻撃を防御できるため、緊急対策（仮想パッチ）として非常に有効です。しかし、WAFの検知を回避する攻撃手法も存在するため、WAFを導入したからといってアプリケーションの脆弱性を修正しなくてよい、ということにはなりません。**セキュアコーディング（脆弱性を作り込まないプログラミング）** とWAFによる多層防御を組み合わせることが理想です。

---
### ［設問］3
(1) セッションID
(2) 推測可能なセッションIDを攻撃者が特定し、本人になりすまして利用する。
(3) エ（セッションIDをURLに埋め込むことは、RefererヘッダなどからセッションIDが漏えいする危険性があるので避ける。）

### ［解説］
・用語
*   **セッションID**: Webサイトが、個々のユーザ（ブラウザ）を識別し、ログイン状態などを維持するために発行する、一時的な識別子です。通常、Cookieに保存されます。
*   **セッションハイジャック**: 何らかの方法で他人のセッションIDを不正に取得し、その人になりすましてサービスを利用する攻撃です。
*   **Refererヘッダ**: あるWebページから別のページへリンクをたどった際に、ブラウザがリンク先のサーバに送信するHTTPリクエストヘッダの一つで、リンク元のページのURLが含まれています。

・技術的背景：
(1) HTTPはステートレスなプロトコルであるため、サーバは前のリクエストと今のリクエストが同じユーザからのものかを判別できません。そこで、ログイン成功時にサーバが発行したセッションIDを、ブラウザが以降のリクエストに毎回含めることで、サーバはユーザを識別し、セッション（一連のやり取り）を維持します。

**【受験者向け発展解説】**
セッションIDを管理する仕組みを**セッション管理**と呼びます。安全なセッション管理には、(1)推測困難なセッションIDの発行、(2)安全な方法でのセッションIDの受け渡し（Cookieの利用）、(3)適切なセッションの有効期限設定、(4)ログアウト時のセッション破棄、などが含まれます。

(2) セッションIDが単純な連番であったり、発行時刻から容易に推測できるような値であったりすると、攻撃者は他人のセッションIDを推測して不正にログインすることが可能になります。これを「セッションIDの推測」と呼びます。対策として、セッションIDは暗号論的に安全な乱数を用いて生成する必要があります。

**【受験者向け発展解説】**
セッションIDの推測の他に、**セッション固定化（Session Fixation）攻撃**にも注意が必要です。これは、攻撃者が用意したセッションIDを、利用者に強制的に使わせてログインさせ、ログイン成功後にそのセッションIDを乗っ取る攻撃です。対策として、ログインが成功したタイミングで、必ず新しいセッションIDを再発行することが重要です。

(3) セッションIDをURLに含める（例： `http://example.com/main?sid=12345`）という実装は、セキュリティ上、非常に危険です。利用者がそのページから別のサイトへのリンクをクリックすると、リンク先サイトのサーバに送信されるRefererヘッダに、セッションIDが含まれたURLがそのまま記録されてしまいます。これにより、第三者にセッションIDが漏えいするリスクがあります。セッションIDの受け渡しには、Cookieを利用するのが一般的です。

**【受験者向け発展解説】**
Cookieを利用する場合でも、適切な属性を設定することが重要です。
*   **Secure属性**: HTTPS通信の場合のみCookieを送信するようにブラウザに指示し、盗聴を防ぎます。
*   **HttpOnly属性**: JavaScriptからのCookieへのアクセスを禁止し、XSSによるセッションIDの窃取を防ぎます。
*   **SameSite属性**: 外部サイトからのリクエスト時にCookieを送信するかを制御し、CSRF攻撃を防ぎます。
これらの属性を適切に設定することで、Cookieの安全性を高めることができます。

***

## 平成26年春期 午後問1：営業支援サーバへのSSLの導入

### ［設問］1
(1) 盗聴
(2) SSL/TLS
(3) ディジタル証明書（サーバ証明書）

### ［解説］
・用語
*   **盗聴 (Eavesdropping)**: ネットワーク上を流れるデータを、当事者に気づかれずに不正に傍受することです。
*   **SSL/TLS (Secure Sockets Layer / Transport Layer Security)**: インターネット上でデータを暗号化して送受信するためのプロトコルです。現在では、より安全なTLSが主流です。
*   **ディジタル証明書 (サーバ証明書)**: 通信相手の正当性を保証し、暗号化通信に必要な公開鍵を配布するための電子的な証明書です。信頼できる第三者機関である認証局（CA）によって発行されます。

・技術的背景：
(1) 暗号化されていないHTTP通信やFTP通信は、ネットワーク上のデータが平文で流れるため、パケットキャプチャツールなどを使えば、IDやパスワード、通信内容を容易に盗聴できてしまいます。

**【受験者向け発展解説】**
特に、暗号化されていない公衆無線LANなど、信頼できないネットワークを利用する際は盗聴のリスクが非常に高くなります。VPN(Virtual Private Network)を利用して通信全体を暗号化することも、有効な盗聴対策の一つです。

(2) SSL/TLSは、公開鍵暗号と共通鍵暗号を組み合わせたハイブリッド暗号方式を用いて、通信経路を暗号化します。これにより、第三者による盗聴や改ざんを防ぎ、安全な通信を実現します。

**【受験者向け発展解説**】
SSL/TLSのハンドシェイクプロセスを理解しておくことが重要です。
1.  **鍵交換**: 安全でない通信路上で、安全に共通鍵を共有する（公開鍵暗号を使用）。
2.  **サーバ認証**: 通信相手が本物であることをディジタル証明書で確認する。
3.  **暗号化通信**: 生成した共通鍵を使って、実際のデータを高速に暗号化して通信する（共通鍵暗号を使用）。
この流れを把握しておきましょう。

(3) SSL/TLS通信を開始する際、Webサーバは自身のディジタル証明書をブラウザに提示します。ブラウザは、その証明書が信頼できる認証局によって発行されたものか、有効期限は切れていないか、証明書に記載されたサイト名（コモンネーム）がアクセス先のURLと一致するかなどを検証します。これにより、通信相手が本物であることを確認し、フィッシングサイトなどへの接続を防ぎます。

**【受験者向け発展解説】**
ブラウザは、OSやブラウザ自身に予め組み込まれている「ルート証明書」の一覧を信頼の起点として、サーバ証明書の正当性を検証します。サーバ証明書から、それを発行した中間認証局、さらにその上位のルート認証局へと証明書の階層を遡って検証し、最終的に信頼できるルート証明書に行き着けば、そのサーバ証明書は正当であると判断されます。これを**証明書チェーン（信頼の連鎖）**と呼びます。

---
### ［設問］2
(1) b: 認証局, c: 秘密鍵
(2) ウ（ディジタル証明書に記載されているWebサーバの公開鍵）
(3) 共通鍵

### ［解説］
・技術的背景：
(1) Webサイトの運営者は、自組織の情報を**b: 認証局(CA)**に提出して、ディジタル証明書の発行を申請します。この際、サーバ側では公開鍵と**c: 秘密鍵**のペアを生成し、公開鍵を申請情報に含めます。認証局は申請内容を審査し、問題がなければ認証局自身の秘密鍵でディジタル署名を行い、証明書を発行します。サーバの秘密鍵は、サーバ管理者のみが厳重に保管します。

**【受験者向け発展解説】**
公開鍵と秘密鍵のペアを生成し、証明書の発行を申請するための情報（CSR: Certificate Signing Request）を作成するプロセスが最初に行われます。サーバの秘密鍵が漏洩すると、第三者がサーバになりすましたり、暗号化通信を解読したりすることが可能になるため、その管理は極めて重要です。

(2) SSL/TLSのハンドシェイクプロセスでは、まずサーバがクライアント（ブラウザ）にディジタル証明書を送ります。この証明書には、サーバの公開鍵が含まれています。

(3) ブラウザは、受け取ったサーバの公開鍵を使って、その後の実際のデータを暗号化するための「共通鍵」の元になる情報（プリマスターシークレット）を暗号化してサーバに送り返します。サーバは、自分だけが持つ秘密鍵でこれを復号し、共通鍵を生成します。ブラウザも同じ手順で共通鍵を生成します。以降、この共通鍵（セッションキー）を使って、高速な共通鍵暗号方式で実際のデータを暗号化して通信します。

**【受験者向け発展解説】**
この(2)→(3)のプロセスが、SSL/TLSにおける**鍵交換**の核心部分です。処理が遅い公開鍵暗号を、安全に共通鍵を共有するためだけに使い、その後の実際のデータ通信は処理が速い共通鍵暗号で行うことで、安全性とパフォーマンスを両立しています。この仕組みを**ハイブリッド暗号方式**と呼びます。現在では、**DHE**や**ECDHE**といった、**PFS (Perfect Forward Secrecy)** を実現する鍵交換アルゴリズムが主流となっています。PFSとは、万が一サーバの秘密鍵が漏洩しても、過去の通信内容が解読されないようにする性質のことです。

---
### ［設問］3
(1) CRL (Certificate Revocation List)
(2) 有効期限内であっても、秘密鍵の漏えいなどによって信頼できなくなったディジタル証明書を無効にするため。

### ［解説］
・用語
*   **CRL (証明書失効リスト)**: 秘密鍵の漏えいや紛失、証明書の記載内容の変更などの理由で、有効期限が来る前に失効（無効化）されたディジタル証明書のシリアル番号のリストです。認証局が発行・管理します。

・技術的背景：
(1) CRLは、認証局が定期的に発行する、失効した証明書の一覧です。

(2) サーバの秘密鍵が漏えいしてしまった場合、攻撃者はその秘密鍵を使ってサーバになりすますことが可能になります。ディジタル証明書の有効期限がまだ残っていても、その証明書はもはや信頼できません。このような場合に、証明書の所有者は認証局に失効を申請します。ブラウザなどのクライアントは、証明書を検証する際に、CRLを参照してその証明書が失効リストに載っていないかを確認することで、信頼できない証明書の使用を防ぐことができます。（現在では、リアルタイム性の高いOCSPというプロトコルも広く使われています。）

**【受験者向け発展解説】**
証明書の失効確認方法には、CRLと**OCSP (Online Certificate Status Protocol)** の2種類があります。
*   **CRL**: 失効した証明書の全リストをダウンロードして確認する方式。リストが巨大になるとパフォーマンスが低下する課題がある。
*   **OCSP**: 確認したい証明書1枚ごとに、オンラインで認証局に問い合わせる方式。リアルタイム性が高いが、認証局への問い合わせが集中する可能性がある。
OCSPのプライバシー問題を改善した**OCSPステープリング**という技術も広く利用されています。これは、Webサーバが認証局からOCSP応答を代理で取得し、証明書と一緒にクライアントに提示する方式で、クライアントの負荷とプライバシーを改善します。

***

## 平成25年秋期 午後問8：Webサイトのセキュリティ強化策

### ［設問］1
(1) SQLインジェクション攻撃
(2) クロスサイトスクリプティング攻撃
(3) WAF (Web Application Firewall)

### ［解説］
・用語
*   **SQLインジェクション**: Webアプリケーションの脆弱性を利用して、データベースを不正に操作する攻撃です。
*   **クロスサイトスクリプティング (XSS)**: 脆弱なWebサイトに悪意のあるスクリプトを埋め込み、閲覧者のブラウザ上で実行させる攻撃です。
*   **WAF (Web Application Firewall)**: Webアプリケーションを保護することに特化したファイアウォールです。通信内容を詳細に検査し、SQLインジェクションやXSSなどの攻撃パターンを検知して遮断します。

・技術的背景：
(1) `id=123 OR 1=1` のようなパラメータを渡すことで、データベースへの問い合わせ条件を不正に書き換え、本来見ることができない情報を表示させようとする手口は、SQLインジェクション攻撃の典型例です。

**【受験者向け発展解説】**
これは、SQLインジェクションによる認証回避の古典的な例です。`WHERE user_id = '123' OR '1'='1'` のように解釈され、`'1'='1'`が常に真であるため、条件が成立してしまいます。

(2) `<script>...</script>` のようなスクリプトを掲示板などに書き込み、それを閲覧した他のユーザのブラウザで意図しない動作を引き起こさせるのは、クロスサイトスクリプティング攻撃です。

**【受験者向け発展解説】**
XSSは、Webサイトの脆弱性を利用して、**利用者のブラウザ**を攻撃する手口です。SQLインジェクションがサーバ側のデータベースを直接攻撃するのとは対照的です。この違いを理解しておきましょう。

(3) WAFは、ネットワークファイアウォールやIPS/IDSが検知できないアプリケーション層への攻撃を防ぐためのセキュリティ機器です。SQLインジェクションで使われるSQL文の断片や、XSSで使われるスクリプトタグなどをシグネチャとして持ち、HTTPリクエスト/レスポンスの内容を検査して、これらの攻撃を検知・遮断します。

**【受験者向け発展解説】**
（平成26年秋期の解説と同様）WAFは非常に有効な対策ですが、**過信は禁物**です。検知ルール（シグネチャ）を回避するような巧妙な攻撃手法も存在するため、根本対策であるアプリケーションの脆弱性修正（セキュアコーディング）と組み合わせて多層的に防御することが重要です。

---
### ［設問］2
(1) 推測されやすいパスワードが設定されることを防ぐため
(2) ブルートフォース攻撃

### ［解説］
・用語
*   **ブルートフォース攻撃 (総当たり攻撃)**: パスワードを解読するため、考えられる全ての文字列の組み合わせを、順番に試行し続ける攻撃手法です。

・技術的背景：
(1) 利用者が安易なパスワード（`password`, `123456`など）や、辞書に載っているような単純な単語を設定すると、辞書攻撃やブルートフォース攻撃によって短時間で破られてしまう危険性が高まります。文字種の組み合わせ（英大文字、英小文字、数字、記号）や、最低文字数を強制するパスワードポリシーを導入することで、利用者に推測されにくい、より強固なパスワードの設定を促すことができます。

**【受験者向け発展解説】**
パスワードの強度（破られにくさ）は、長さと複雑さ（文字種）によって決まります。特に**長さ**が重要で、文字数を1文字増やすだけで、組み合わせの総数は飛躍的に増加します。近年のガイドラインでは、複雑さよりも十分な長さを確保することを重視する傾向にあります。

(2) アカウントロックアウトは、ブルートフォース攻撃に対する有効な防御策です。攻撃者はプログラムを使って高速にログイン試行を繰り返しますが、一定回数パスワードを間違えた時点でアカウントをロック（一時的にログイン不能に）することで、それ以上の試行を続けられなくなり、攻撃を遅延・阻止することができます。

**【受験者向け発展解説】**
（平成28年春期の解説と同様）アカウントロックはブルートフォース攻撃には有効ですが、特定のユーザを狙い撃ちにしてサービスを利用できなくする**DoS攻撃**に悪用されるリスクもあります。そのため、ロックアウトの代わりに、試行回数が増えるごとに応答時間を遅延させる（スロットリング）などの対策も考えられます。

---
### ［設問］3
(1) URLのドメイン名が，本物のWebサイトのものであることを利用者が確認しやすくなるから。
(2) ウ（ディジタル証明書によって，Webサーバの運営組織が実在することを確認できる。）

### ［解説］
・用語
*   **EV SSL証明書 (Extended Validation SSL Certificate)**: 最も厳格な審査基準に基づいて発行されるサーバ証明書です。EV SSL証明書が導入されているサイトを対応ブラウザで表示すると、アドレスバーが緑色に表示されるなど、サイトの信頼性が視覚的に分かりやすくなります。

・技術的背景：
(1) フィッシングサイトは、本物のサイトとそっくりのURL（例: `example.co.jp` に対して `example-co.jp` や `examp1e.co.jp`）を使うことがあります。EV SSL証明書を導入すると、ブラウザのアドレスバーに、認証局による審査を通過した正式な組織名が表示されます。利用者はこの組織名とドメイン名を見ることで、アクセスしているサイトが偽サイトではなく、本物のサイトであることを容易に確認でき、フィッシング詐欺の被害を防ぐ効果が期待できます。

**【受験者向け発展解説】**
最近のブラウザでは、EV SSL証明書によるアドレスバーの緑色表示は廃止される傾向にありますが、証明書の詳細を確認すれば運営組織名が表示されることに変わりはありません。EV証明書の価値は、利用者に視覚的な安心感を与えるだけでなく、厳格な審査プロセスそのものにあります。

(2) サーバ証明書の最も重要な役割の一つは、暗号化だけでなく、Webサイトの運営者が誰であるかを証明することです。特にEV SSL証明書では、認証局が申請組織の法的・物理的な実在性を厳格に審査するため、利用者はそのサイトを運営している組織が確かに存在することを信頼でき、安心してサービスを利用できます。

**【受験者向け発展解説】**
（平成31年春期の解説と同様）サーバ証明書には**DV（ドメイン認証）、OV（組織認証）、EV（拡張組織認証）** の3種類があります。DV証明書は無料で取得できるものもあり、フィッシングサイトでも広く使われています。そのため、「HTTPSだから安全」と単純に判断するのではなく、サイト運営者の実在性が保証されているか（OV/EV証明書か）を確認することが、より高い安全性を求める上では重要になります。

***

## 平成25年春期 午後問9：PCのマルウェア対策

### ［設問］1
(1) USBメモリを介して，他のPCにマルウェアの感染を広げる。
(2) autorun.inf
(3) ア（OSの自動実行機能を無効にする。）

### ［解説］
・用語
*   **autorun.inf**: Windowsにおいて、CD-ROMやUSBメモリなどのリムーバブルメディアが挿入された際に、特定のプログラムを自動的に実行させるための設定ファイルです。

・技術的背景：
(1) マルウェアの中には、USBメモリなどのリムーバブルメディアに自身をコピーし、他のPCにそのメディアが接続された際に自動的に感染を広げる機能を持つものがあります。これにより、ネットワークに接続されていないオフラインのPCにも感染が拡大する可能性があります。

**【受験者向け発展解説】**
このように、ネットワークを介さずに物理メディアによってマルウェアが拡散する手法は、**エアギャップ**（外部ネットワークから物理的に隔離された環境）で保護されているはずの工場などの制御システム（OT: Operational Technology）への侵入経路としても問題になります。

(2) マルウェアは、USBメモリに自身のコピーと共に、不正な`autorun.inf` ファイルを書き込みます。このファイルには、USBメモリがPCに挿入されたときに、マルウェア本体である実行ファイルを自動的に起動するような指示が記述されています。

(3) この種のマルウェア感染を防ぐための最も直接的で効果的な対策は、OSの自動実行（オートラン）機能を無効にすることです。これにより、たとえマルウェアが仕込まれたUSBメモリをPCに接続しても、`autorun.inf` が解釈されず、マルウェアが自動で実行されることがなくなります。

**【受験者向け発展解説**】
現在のWindowsでは、セキュリティ上の理由から、autorun.infによるプログラムの自動実行機能は大幅に制限されています。しかし、古いOSでは依然としてリスクが残ります。対策としては、OSの機能無効化に加え、組織のポリシーとして**許可されていないUSBメモリの使用を禁止**したり、DLP製品などでUSBポートへの書き込み自体を制御したりすることが有効です。

---
### ［設問］2
(1) プロキシサーバ
(2) DNSサーバ
(3) a: プロキシ, b: DNS

### ［解説］
・用語
*   **プロキシサーバ**: 内部PCの代理としてインターネットに接続するサーバです。Webアクセス(HTTP/HTTPS)を中継します。
*   **DNSサーバ**: ドメイン名（`www.example.com`）とIPアドレス（`192.0.2.1`）を対応付ける名前解決を行うサーバです。

・技術的背景：
マルウェアは、外部のC2サーバと通信するために、まずC2サーバのドメイン名をIPアドレスに変換する「名前解決」を行い、その後、そのIPアドレスに対してHTTPなどで通信を行います。
したがって、
- **(2) DNSサーバ**のログを調べれば、マルウェアがどのドメイン名にアクセスしようとしたかが分かります。
- **(1) プロキシサーバ**のログを調べれば、マルウェアがどのIPアドレスやURLに対して、どのようなHTTP通信を行ったかが分かります。

問題文のケースでは、PCはWebアクセスを行う際に、まず **b: DNS** サーバに問い合わせてドメイン名の名前解決を行い、次に **a: プロキシ** サーバを経由して外部のWebサーバと通信します。そのため、それぞれのログを調査することで、マルウェアの通信の痕跡を追うことができます。

**【受験者向け発展解説**】
マルウェアの通信を調査する上でのログの重要度は、一般的に**プロキシ > DNS > ファイアウォール**の順と考えられます。
*   **プロキシログ**: URLやHTTPメソッドなど、最も詳細な情報が得られる。
*   **DNSログ**: 宛先ドメイン名は分かるが、具体的な通信内容は不明。
*   **FWログ**: 宛先IPアドレスは分かるが、ドメイン名は不明（HTTPSの場合）。
インシデント調査では、これらのログを時系列で突き合わせて相関分析を行うことが不可欠です。

---
### ［設問］3
ウ（マルウェアがPCに常駐するのを防ぐ。）

### ［解説］
・技術的背景：
マルウェアの多くは、PCの起動時に自動的に実行されるように、Windowsのレジストリやスタートアップフォルダに自身の情報を登録します。これにより、PCを再起動してもマルウェアは活動を続け、システムに常駐します。
マルウェア対策ソフトは、これらの自動起動設定が変更されるのを監視し、不正なプログラムが登録されようとするのをブロックします。これにより、マルウェアがPCに永続的に居座る（常駐する）のを防ぎ、再起動すればマルウェアが活動できなくなるようにする効果があります。

**【受験者向け発展解説】**
マルウェアが自動実行のために利用するレジストリキー（例: `Run`キー）やフォルダ（スタートアップフォルダ）は、攻撃手法としてよく知られています。このような**永続化（Persistence）** の手口を監視・検知することは、EDR製品の重要な機能の一つです。MITRE ATT&CKフレームワークにおいても、永続化は独立した戦術（Tactics）として分類されています。

***

## 平成24年秋期 午後問9：電子メールのセキュリティ対策

### ［設問］1
(1) SMTP-AUTH (SMTP Authentication)
(2) OP25B (Outbound Port 25 Blocking)
(3) イ（自社のネットワークから，契約しているプロバイダ以外のメールサーバへ，メールを送信できないようにする。）

### ［解説］
・用語
*   **SMTP-AUTH**: メール送信（SMTP）時にユーザ認証を行う仕組みです。
*   **OP25B**: ISPなどが、自身の管理外のメールサーバへのSMTP通信（宛先ポート25番）をブロックする迷惑メール対策です。
*   **サブミッションポート(587番)**: メールソフトからメールサーバへのメール送信（投入）専用のポートです。OP25Bの対象外となります。

・技術的背景：
(1) 誰でも自由にメールを送信できるメールサーバ（オープンリレー）は、迷惑メールの踏み台にされてしまいます。これを防ぐため、メールを送信する際にIDとパスワードで正規の利用者であることを確認するSMTP-AUTHが広く利用されています。

**【受験者向け発展解説**】
（平成27年春期の解説と同様）SMTP-AUTHでパスワードを安全にやり取りするためには、**STARTTLS**や**SMTPS**で通信経路を暗号化することが必須となります。

(2), (3) マルウェアに感染し、迷惑メール送信のボットと化したPCが、外部のメールサーバの25番ポートに直接メールを送信するのを防ぐのがOP25Bです。これにより、利用者は契約プロバイダが用意したメールサーバ（サブミッションポート＋SMTP-AUTH）を使わざるを得なくなり、結果として迷惑メールの送信を抑制できます。

**【受験者向け発展解説】**
（平成27年春期の解説と同様）メールのポート番号（25, 110, 143, 587, 465など）の役割と使い分けは、ネットワークの基礎知識として非常に重要です。特に、**25番（サーバ間転送）**と**587番（クライアントからの投入）**の役割分担は確実に理解しておきましょう。

---
### ［設問］2
(1) STARTTLS
(2) 公衆無線LANなど信頼できないネットワーク上でメールのパスワードや本文を盗聴される。
(3) ウ（電子署名を利用して，送信元メールアドレスの正当性を確認し，メール本文の改ざんを検知する。）

### ［解説］
・用語
*   **STARTTLS**: 平文の通信経路上で、暗号化通信(SSL/TLS)を開始するためのコマンドです。
*   **S/MIME (Secure/Multipurpose Internet Mail Extensions)**: 電子メールの暗号化と電子署名のための標準規格です。

・技術的背景：
(1) STARTTLSは、既存のメール送受信ポート（SMTP: 25番, POP: 110番など）を使いながら、途中で暗号化通信に切り替えることができる仕組みです。これにより、通信経路上の盗聴を防ぎます。

**【受験者向け発展解説】**
（平成27年春期の解説と同様）STARTTLSにはダウングレード攻撃のリスクがあるため、最初から暗号化通信を行う**Implicit TLS**（SMTPS/465番など）の方がより安全性が高いとされています。

(2) STARTTLSなどで通信を暗号化していない場合、特に暗号化されていない公衆無線LANなどでは、通信パケットを傍受（盗聴）することで、メールの認証情報（ID、パスワード）やメールの本文が第三者に漏えいしてしまう危険性があります。

**【受験者向け発展解説】**
これはメールに限りません。HTTPやFTP、Telnetなど、暗号化されていないプロトコルは全て同様のリスクを抱えています。そのため、現在ではこれらのプロトコルは、それぞれHTTPS, SFTP/FTPS, SSHといった暗号化された後継プロトコルに置き換えられることが強く推奨されています。

(3) S/MIMEは、送信者が自身の秘密鍵でメールに電子署名を行い、受信者が送信者の公開鍵でそれを検証する仕組みを提供します。これにより、受信者は「そのメールが本当にその送信者から送られたものであること（なりすまし防止）」と、「メールの内容が途中で改ざんされていないこと（完全性の保証）」を確認できます。

**【受験者向け発展解説】**
S/MIMEは電子署名だけでなく、メール本文を暗号化する機能も提供します。送信者が受信者の公開鍵でメールを暗号化し、受信者は自身の秘密鍵で復号することで、**End-to-End**でのメールの盗聴防止が実現できます。送信ドメイン認証（SPF/DKIM）がサーバ間のセキュリティを担保するのに対し、S/MIMEはユーザ間のセキュリティを担保する技術と位置づけられます。

***

## 平成24年春期 午後問9：セキュリティインシデントへの対応

### ［設問］1
(1) ネットワークからの隔離
(2) 全ての通信を遮断してしまうと，被害状況の調査に必要なマルウェアの通信内容を監視できなくなるから。
(3) ミラーポート

### ［解説］
・用語
*   **封じ込め**: インシデント対応において、被害の拡大を防ぐために、感染したシステムを隔離するなどの措置を取るフェーズです。
*   **ミラーポート (ポートミラーリング)**: スイッチの特定のポートを流れるパケットを、別の指定したポートにコピーして出力する機能です。ネットワークの監視やトラブルシューティングに利用されます。

・技術的背景：
(1) サーバがマルウェアに感染したと判断した場合、インシデント対応の初動として最も重要なのは「封じ込め」です。他のシステムへの感染拡大や、外部への情報漏えいを防ぐため、まずはそのサーバをネットワークから切り離す（**ネットワークからの隔離**）ことが最優先となります。

**【受験者向け発展解説**】
ネットワークからの隔離は、必ずしも物理的にLANケーブルを抜くことだけを意味しません。VLANの変更や、ファイアウォールのルール変更によって論理的に隔離することも可能です。EDR製品には、管理コンソールから遠隔で端末を論理的に隔離する機能が備わっているものが多いです。

(2) 感染したサーバを完全にネットワークから遮断すると、被害の拡大は防げますが、マルウェアがどのような活動（外部のC2サーバとの通信など）をしているのかをリアルタイムで観測できなくなります。調査のためには、マルウェアを生かしたままその通信を監視する必要があります。

(3) 感染サーバの通信を監視するため、スイッチの**ミラーポート**機能を利用します。感染サーバが接続されているポートの通信を、解析用のPCが接続された別のポートに全てコピーします。これにより、感染サーバの通信に影響を与えることなく、その通信内容を安全な場所で詳細に調査（パケットキャプチャ）することができます。

**【受験者向け発展解説】**
ミラーポートでコピーしたパケットを解析するツールを**パケットキャプチャツール**（例: Wireshark）や**ネットワークフォレンジックツール**と呼びます。これらを用いて通信内容を詳細に分析することで、マルウェアがどのような情報を外部に送信しようとしていたのか、攻撃者からどのようなコマンドを受け取っていたのかを明らかにすることができます。

---
### ［設問］2
(1) バックアップからサーバを復旧させる前に，マルウェアがバックアップに含まれていないことを確認する。
(2) 脆弱性への対処
(3) イ（同じ攻撃が再度成功しないように，攻撃の原因となった脆弱性を解消する。）

### ［解説］
・技術的背景：
(1) マルウェアに感染した後に取得したバックアップには、マルウェア自身や、マルウェアによって設置されたバックドアなどが含まれている可能性があります。それに気づかずにリストア（復旧）してしまうと、サーバを復旧させた瞬間に再びマルウェアが活動を開始してしまいます。そのため、バックアップから復旧する前には、バックアップデータ自体がクリーンであるかを確認する（ウイルススキャンなど）ことが重要です。

**【受験者向け発展解説**】
バックアップの重要性を考える上で**3-2-1ルール**を覚えておくと良いでしょう。「3つのコピーを作成し、2種類の異なる媒体に保存し、そのうち1つはオフサイト（遠隔地）に保管する」というバックアップの原則です。これにより、機器の故障だけでなく、ランサムウェアによる暗号化や災害時にもデータを保護することができます。

(2), (3) インシデント対応における「復旧」とは、単にシステムを元に戻すことだけではありません。最も重要なのは、攻撃の根本原因となった**脆弱性**（OSやミドルウェアのパッチ未適用、設定の不備など）を特定し、それに対して適切な**対処**（パッチ適用、設定修正など）を行うことです。これを怠ると、同じ手口で再び攻撃者に侵入されてしまい、インシデントが再発してしまいます。

**【受験者向け発展解説**】
インシデント対応プロセスは、**CSIRT (Computer Security Incident Response Team)** と呼ばれる専門チームが主導します。CSIRTの活動は、インシデント発生時の対応（リアクティブ活動）だけでなく、インシデントを未然に防ぐための脆弱性情報の収集や注意喚起（プロアクティブ活動）も含まれます。インシデント対応の最終フェーズは「**教訓**」であり、対応プロセスを振り返り、報告書を作成し、再発防止策を組織全体に展開することが求められます。

***

## 平成23年秋期 午後問9：Webアプリケーションのセキュリティ対策

### ［設問］1
(1) SQLインジェクション
(2) クロスサイトスクリプティング

### ［解説］
・技術的背景：
(1) Webアプリケーションへの入力値として、データベースへの命令文であるSQLの一部を注入（inject）することで、データベースを不正に操作する攻撃がSQLインジェクションです。個人情報の窃取やデータの改ざん・削除などの被害につながります。

(2) 脆弱性のあるWebサイトの掲示板などに、悪意のあるスクリプトを埋め込み、そのページを閲覧した他のユーザのブラウザ上で、意図しないスクリプトを実行させる攻撃がクロスサイトスクリプティングです。利用者のクッキー情報（セッションID）を盗み、なりすましを行うなどの手口があります。

**【受験者向け発展解説】**
この二つは、Webアプリケーションの脆弱性として常に上位に挙げられる代表的なものです。
*   **SQLインジェクション**: **サーバサイド**の脆弱性。データベースが攻撃対象。
*   **クロスサイトスクリプティング(XSS)**: 主に**クライアントサイド**（ユーザのブラウザ）で影響が出る脆弱性。
この攻撃対象の違いを明確に理解することが重要です。

---
### ［設問］2
(1) エスケープ処理
(2) プレースホルダ
(3) WAF

### ［解説］
・用語
*   **エスケープ処理**: `<` `>` `"` `'` といった、スクリプトやHTMLタグとして特別な意味を持つ文字を、無害な別の文字列（HTMLエンティティなど）に変換する処理です。XSS対策の基本です。
*   **プレースホルダ (バインド機構)**: SQL文のテンプレート（骨格）と、そこにはめ込むデータ（値）を分離して扱うことで、入力値がSQL文の構文として解釈されるのを防ぐ仕組みです。SQLインジェクションの根本対策です。
*   **WAF (Web Application Firewall)**: Webアプリケーションへの通信を検査し、SQLインジェクションやXSSなどの攻撃パターンを検知して遮断するセキュリティ製品です。

・技術的背景：
(1) クロスサイトスクリプティングを防ぐには、ユーザからの入力値を画面に出力する際に、必ず**エスケープ処理**を施し、スクリプトとして実行されないようにする必要があります。

(2) SQLインジェクションを防ぐには、SQL文を組み立てる際に文字列連結を使わず、**プレースホルダ**を利用することが最も安全で確実な方法です。

(3) 既存のWebアプリケーションに脆弱性があり、すぐには修正できない場合の保険的な対策として、**WAF**を導入することが有効です。WAFがWebサーバの前段で不正なリクエストをブロックしてくれます。

**【受験者向け発展解説】**
脆弱性対策の考え方を整理しましょう。
*   **根本対策**: 脆弱性そのものを修正する。（例: プレースホルダ利用、エスケープ処理）
*   **保険的対策（緩和策）**: 脆弱性は残存するが、攻撃の影響を緩和する。（例: WAF導入）
理想は根本対策ですが、すぐに対応できない場合にWAFのような保険的対策が有効となります。この関係性を理解しておきましょう。また、脆弱性を早期に発見するための**脆弱性診断**や**ソースコード診断**も重要なプロセスです。

---
### ［設問］3
セッションハイジャック

### ［解説］
・用語
*   **セッションハイジャック**: ログイン中のユーザのセッションIDを何らかの方法で盗み出し、そのユーザになりすまして不正な操作を行う攻撃です。

・技術的背景：
クロスサイトスクリプティング攻撃などによって、利用者のブラウザで管理されているCookie内のセッションIDが攻撃者に盗まれてしまうと、攻撃者はそのセッションIDを使って、正規の利用者になりすますことが可能になります。これがセッションハイジャックです。対策としては、セッションIDの漏えい経路となるXSSなどの脆弱性をなくすことや、セッションIDを推測困難なものにすること、重要な操作の前にはパスワードの再入力を求める、などがあります。

**【受験者向け発展解説**】
（平成26年秋期の解説と同様）セッションハイジャックを防ぐためには、セッションIDそのものの管理を堅牢にすることが不可欠です。
*   **漏洩対策**: XSS脆弱性の修正、Cookieの**HttpOnly属性**の設定
*   **推測対策**: 暗号論的に安全な乱数でセッションIDを生成する
*   **固定化対策**: ログイン成功時にセッションIDを再発行する
これらの対策を組み合わせることで、セッションハイジャックのリスクを大幅に低減できます。

***

## 平成23年特別 午後問9：サーバへのサイバー攻撃対策

### ［設問］1
(1) 辞書攻撃
(2) アカウントロック
(3) パスワードの最小文字数を長くし，英字，数字，記号を混在させるなど，パスワードの複雑さを増す。

### ［解説］
・用語
*   **辞書攻撃**: パスワードとしてよく使われそうな単語や名前などをリスト化した「辞書」ファイルを用いて、ログインを試行する攻撃手法です。
*   **アカウントロック**: ログイン試行が規定回数以上失敗した場合に、そのアカウントを一時的に使用不能にする機能です。

・技術的背景：
(1) `password`や`admin`のような単純なパスワードは、辞書攻撃によって容易に破られてしまいます。

(2) アカウントロックは、辞書攻撃やブルートフォース攻撃（総当たり攻撃）に対して有効な対策です。攻撃者はプログラムで高速に試行しますが、数回失敗しただけでロックされるため、攻撃の効率を大幅に下げることができます。

(3) パスワードポリシーを強化し、利用者に長く複雑なパスワードの設定を強制することは、辞書攻撃やブルートフォース攻撃でパスワードが破られるまでの時間を増大させ、セキュリティ強度を高めるための基本的な対策です。

**【受験者向け発展解説】**
パスワード認証の強化策として、これらの対策に加えて**多要素認証(MFA)**の導入が最も効果的です。たとえパスワードが破られても、MFAがあれば不正ログインを防ぐことができます。また、パスワードを使わない**パスワードレス認証（FIDOなど）**への移行も、今後の大きなトレンドです。

---
### ［設問］2
(1) バッファオーバフロー攻撃
(2) エ（既知の脆弱性を解消するための修正プログラム）
(3) 不要なサービスを停止し、FWで外部からの通信を遮断する。

### ［解説］
・用語
*   **バッファオーバフロー攻撃**: プログラムが用意しているメモリ領域（バッファ）のサイズを超える大きなデータを送りつけることで、バッファをあふれさせ（オーバフロー）、不正なプログラムコードを実行させる攻撃です。
*   **セキュリティパッチ**: ソフトウェアの脆弱性を修正するために提供されるプログラムです。

・技術的背景：
(1) バッファオーバフローは、C言語などで書かれたプログラムの古典的な脆弱性の一つです。攻撃が成功すると、攻撃者はサーバの管理者権限などを奪取することが可能になります。

**【受験者向け発展解説**】
OSには、バッファオーバーフロー攻撃を緩和するためのセキュリティ機構が実装されています。代表的なものに、**DEP (Data Execution Prevention / データ実行防止)** や **ASLR (Address Space Layout Randomization / アドレス空間配置のランダム化)** があります。DEPはデータ領域のコード実行を防ぎ、ASLRはメモリ配置をランダム化して攻撃コードの実行を困難にします。

(2) ソフトウェアの脆弱性は日々発見されています。サーバを安全に運用するためには、ベンダーから提供されるセキュリティパッチを迅速に適用し、既知の脆弱性を塞ぐことが不可欠です。

(3) サーバのセキュリティの基本は「不要な機能は動かさない」ことです。利用していないサービス（プログラム）は停止し、ファイアウォール(FW)でそのサービスが使うポートを閉じておくことで、攻撃者が侵入に使える経路（アタックサーフェス）を減らし、攻撃されるリスクを低減できます。

**【受験者向け発展解説**】
（平成30年秋期の解説と同様）これは**サーバハーデニング（要塞化）**の基本原則です。最小権限の原則と並び、セキュリティの基本思想として重要です。攻撃対象領域（アタックサーフェス）を最小化することが、防御の第一歩となります。

***

## 平成22年秋期 午後問9：検疫ネットワーク

### ［設問］1
(1) ウイルス対策ソフトの定義ファイルが最新ではないPCなどを，そのまま社内ネットワークに接続させないようにする仕組み
(2) a: DHCPサーバ, b: 検疫サーバ
(3) 治療

### ［解説］
・用語
*   **検疫ネットワーク**: 社内ネットワークに接続しようとするPCのセキュリティ状態（ウイルス対策ソフトの導入状況、定義ファイルの更新状況、特定のパッチの適用状況など）を検査し、予め定めたセキュリティポリシーを満たさないPCを、治療用のネットワーク（検疫エリア）に隔離する仕組みです。

・技術的背景：
(1) 検疫ネットワークの目的は、セキュリティ対策が不十分なPC（持ち込みPCや、長期間使われていなかったPCなど）が社内ネットワークに接続することで、ウイルスなどをまき散らすのを防ぐことです。

(2) 一般的な検疫ネットワークの仕組みでは、PCがネットワークに接続すると、まず**a: DHCPサーバ**が、PCに検疫エリアのIPアドレスを割り当てます。PCのWebブラウザからの通信は**b: 検疫サーバ**にリダイレクトされ、そこでセキュリティポリシーを満たしているかのチェック（検疫）が行われます。

(3) ポリシーを満たしていないと判定されたPCは、検疫エリアに隔離されたままとなります。検疫エリアからは、ウイルス定義ファイルを更新したり、必要なパッチをダウンロードしたりするためのサーバにのみ接続が許可されます。このプロセスを「**治療**」と呼びます。治療が完了し、再度検疫を受けて合格すれば、正式な社内ネットワークへの接続が許可されます。

**【受験者向け発展解説】**
検疫ネットワークは、ゼロトラストのコンセプトに通じる考え方です。「社内ネットワークに接続するPCだからといって、無条件に信頼しない。まずそのPCの健全性（セキュリティ状態）を検証する」という点で、ゼロトラストの原則である "Never Trust, Always Verify" を具現化した技術の一つと言えます。

---
### ［設問］2
(1) エージェント方式
(2) Webブラウザを利用して検査する方式と比べて，より詳細な検査ができるから
(3) ア（PCの資産管理）

### ［解説］
・用語
*   **エージェント方式**: 検疫対象のPCに、あらかじめ「エージェント」と呼ばれる専用のソフトウェアをインストールしておき、そのエージェントがPCのセキュリティ状態を検査して検疫サーバに通知する方式です。

・技術的背景：
(1) エージェントをインストールしておく方式をエージェント方式と呼びます。これに対し、Webブラウザの機能（ActiveXなど）を利用して一時的なプログラムをダウンロードさせて検査する方式をエージェントレス方式と呼びます。

(2) エージェント方式は、専用ソフトをインストールする手間はかかりますが、PC内部のより詳細な情報（特定のレジストリ設定、インストールされている全ソフトウェアのバージョンなど）を収集・検査できるため、エージェントレス方式よりも厳格なセキュリティチェックが可能です。

(3) エージェントは、PCのハードウェア情報（CPU、メモリ、ディスク容量など）や、インストールされているソフトウェアのライセンス情報などを収集する機能も持たせることができます。これにより、検疫ネットワークの仕組みを、組織内のPC資産を一元管理するための資産管理システムとして応用することが可能です。

**【受験者向け発展解説】**
このエージェントは、検疫機能だけでなく、DLP機能やEDR機能などを統合した**統合エンドポイントセキュリティ**のエージェントとして提供されることもあります。一つのエージェントで複数のセキュリティ機能を実現することで、PCの負荷を低減し、管理を一元化できるというメリットがあります。

***

## 平成22年春期 午後問9：DNSサーバのセキュリティ対策

### ［設問］1
(1) DNSキャッシュポイズニング
(2) ファイアウォールで，外部から内部向けUDP53番ポートの通信を遮断する。
(3) b: 外部, c: 内部

### ［解説］
・用語
*   **DNSキャッシュポイズニング**: DNSのキャッシュサーバに偽のドメイン情報を注入する攻撃です。
*   **DNSコンテンツサーバ (権威DNSサーバ)**: 自身が管理するドメインのDNS情報（ゾーン情報）を持つサーバです。外部からの問い合わせに応答します。
*   **DNSキャッシュサーバ**: 内部のクライアントからの問い合わせを代理で行い、結果をキャッシュするサーバです。

・技術的背景：
(1) DNSキャッシュサーバが、外部のDNSコンテンツサーバに問い合わせを行っている隙を狙い、攻撃者が偽のDNS応答を送りつけることで、キャッシュを汚染する攻撃です。

(2) DNSサーバへの問い合わせ（名前解決）には、通常UDPの53番ポートが使われます。外部のDNSサーバが、自社の内部向けDNSキャッシュサーバに再帰的な問い合わせをしてくることは通常ありません。そのため、ファイアウォールで、インターネット側（外部）から社内LAN側（内部）への宛先ポートUDP/53の通信を遮断することは、外部からのDNSキャッシュポイズニング攻撃を防ぐ基本的な対策となります。

**【受験者向け発展解説】**
内部向けDNSキャッシュサーバが、外部からの再帰的な問い合わせに応答してしまう設定になっている状態を**オープンリゾルバ**と呼びます。オープンリゾルバは、DNSキャッシュポイズニングの標的になるだけでなく、**DNSリフレクション攻撃（DNSアンプ攻撃）**の踏み台として悪用される危険性が非常に高いため、必ず無効に設定する必要があります。

(3) 一般的に、DNSサーバは外部に公開して自社ドメインの情報を引かせる**DNSコンテンツサーバ**と、社内クライアントからの問い合わせのみを受け付ける**DNSキャッシュサーバ**の二つの役割に分離して構築・運用されます。前者は**b: 外部**セグメント（DMZなど）に、後者は**c: 内部**ネットワークに設置することで、セキュリティを高めることができます。

**【受験者向け発展解説】**
このように、一つのサーバに複数の役割を持たせるのではなく、役割ごとにサーバを分離することは、セキュリティ設計の基本原則です。これにより、万が一外部公開サーバが侵害されても、内部のキャッシュサーバやクライアントへの影響を限定することができます。

---
### ［設問］2
(1) ゾーン転送
(2) イ（ゾーン転送を許可する相手を，セカンダリDNSサーバに限定する。）
(3) DNSSEC

### ［解説］
・用語
*   **ゾーン転送**: DNSサーバ間で、ドメイン情報（ゾーンファイル）を同期するための仕組みです。プライマリDNSサーバからセカンダリDNSサーバへ、一方向で行われます。
*   **DNSSEC (DNS Security Extensions)**: DNS応答に電子署名を付与することで、応答の正当性と完全性を保証する拡張機能です。DNSキャッシュポイズニングへの根本対策とされます。

・技術的背景：
(1) ゾーン転送は、DNSの冗長性を確保するために不可欠な機能ですが、誰からの要求にも応答するように設定されていると、攻撃者にネットワーク内部のホスト名やIPアドレスの一覧を丸ごと盗まれてしまいます。これは、攻撃の足がかりとなる重要な情報を与えることになります。

(2) ゾーン転送は、本来、プライマリDNSサーバとセカンダリDNSサーバの間でのみ行われるべきです。そのため、DNSサーバの設定で、ゾーン転送を要求できる相手のIPアドレスを、正規のセカンダリDNSサーバのIPアドレスのみに制限することが、非常に重要なセキュリティ対策となります。

**【受験者向け発展解説】**
ゾーン転送には、ゾーン全体の情報を全て転送する**フルゾーン転送(AXFR)**と、差分のみを転送する**インクリメンタルゾーン転送(IXFR)**があります。いずれの場合も、許可する相手を限定することが重要です。

(3) DNSキャッシュポイズニングを防ぐためのより高度で根本的な対策がDNSSECです。DNS応答に付与された電子署名を検証することで、受信したDNS情報が、正当な管理者によって生成され、途中で改ざんされていないことを確認できます。

**【受験者向け発展解説】**
（平成26年秋期の解説と同様）DNSSECはDNS応答の**真正性（本物であること）**と**完全性（改ざんされていないこと）**を保証しますが、**機密性（暗号化）**は提供しません。この3つの性質（CIA: Confidentiality, Integrity, Authenticity）をどの技術が担保するのかを整理して理解することが重要です。

***

## 平成21年秋期 午後問9：公開鍵基盤を用いた社員認証システム

### ［設問］1
(1) a: 認証局, b: リポジトリ
(2) ウ（社員の秘密鍵で暗号化されたメッセージを，その社員の公開鍵で復号する。）
(3) CRL (証明書失効リスト)

### ［解説］
・用語
*   **PKI (Public Key Infrastructure / 公開鍵基盤)**: 公開鍵暗号技術を利用して、安全な通信や電子署名を実現するための、認証局(CA)やリポジトリ(証明書などを保管するデータベース)などで構成される社会的な基盤（仕組み）です。
*   **電子署名**: メッセージの送信者が、自身の秘密鍵でメッセージのハッシュ値を暗号化したものです。これにより、「メッセージの作成者が本人であること（認証）」と「メッセージが改ざんされていないこと（完全性）」を証明できます。
*   **CRL (証明書失効リスト)**: 有効期限内に失効した電子証明書のシリアル番号がリスト化されたものです。

・技術的背景：
(1) PKIにおいて、電子証明書を発行するのが**a: 認証局(CA)**、発行された証明書やCRLを公開・保管するデータベースが**b: リポジトリ**です。

**【受験者向け発展解説】**
PKIの構成要素として、認証局(CA)とリポジトリの他に、本人確認を行って証明書発行の申請を受け付ける**登録局(RA: Registration Authority)** があります。CA、RA、リポジトリがPKIの主要な構成要素です。

(2) 電子署名のプロセスは、正確には「メッセージのハッシュ値を秘密鍵で暗号化」し、受信側は「公開鍵で復号したハッシュ値」と「受信したメッセージから計算したハッシュ値」を比較することで検証します。これにより、**認証（Authentication）**、**完全性（Integrity）**、**否認防止（Non-repudiation）** の3つを実現します。

**【受験者向け発展解説】**
「暗号化」と「電子署名」で、公開鍵と秘密鍵の使い方が逆になることを理解しましょう。
*   **暗号化（盗聴防止）**: **受信者**の**公開鍵**で暗号化し、**受信者**の**秘密鍵**で復号する。
*   **電子署名（なりすまし・改ざん防止）**: **送信者**の**秘密鍵**で署名し、**送信者**の**公開鍵**で検証する。
この使い分けは、公開鍵暗号技術の根幹をなす重要なポイントです。

(3) 社員が退職したり、ICカードを紛失して秘密鍵が漏えいしたりした場合、その社員の電子証明書は有効期限内であっても無効化（失効）する必要があります。認証局は、失効した証明書のリストであるCRLを発行し、リポジトリで公開します。システムは、証明書を利用する際に、このCRLを参照して証明書が失効していないかを確認します。

**【受験者向け発展解説】**
（平成26年春期の解説と同様）証明書の失効確認方法には、リスト形式の**CRL**と、オンラインで問い合わせる**OCSP**があります。それぞれのメリット・デメリットを理解しておきましょう。

---
### ［設問］2
(1)チャレンジレスポンス認証
(2) ワンタイムパスワード
(3) 通信経路上でチャレンジとレスポンスを盗聴されても，レスポンスから秘密鍵を特定できないから。

### ［解説］
・用語
*   **チャレンジレスポンス認証**: 認証サーバが「チャレンジ」と呼ばれるランダムなデータ（乱数）をクライアントに送り、クライアントはそれを自身の秘密鍵などで加工した「レスポンス」をサーバに返すことで認証を行う方式です。
*   **ワンタイムパスワード**: 一度の認証にしか使えない、使い捨てのパスワードです。

・技術的背景：
(1) サーバが送ったランダムな値（チャレンジ）に対して、クライアントが正しい応答（レスポンス）を返せるかどうかで本人確認を行うのが、チャレンジレスポンス認証です。

(2) チャレンジ（乱数）は毎回変わるため、クライアントが生成するレスポンスも毎回異なる値になります。このレスポンスは、その一度の認証でしか使えないため、実質的にワンタイムパスワードとして機能します。

(3) この方式の最大の利点は、ネットワーク上にパスワードそのものや秘密鍵を流さずに認証できる点です。認証のたびにチャレンジは変わるため、たとえ攻撃者が通信を盗聴して、あるチャレンジとレスポンスのペアを入手したとしても、それを次の認証で再利用する（リプレイ攻撃）ことはできません。また、レスポンスから秘密鍵を計算することも極めて困難なため、安全な認証が実現できます。

**【受験者向け発展解説】**
チャレンジレスポンス認証は、多くの認証プロトコルで利用されています。例えば、無線LANの認証で使われる**EAP-TLS**や、リモートアクセスで使われる**CHAP**などがこの方式に基づいています。パスワードそのものをネットワークに流さないことが、盗聴に対する耐性を高める上で非常に重要であるという点を押さえておきましょう。

***

## 平成21年春期 午後問9：ファイアウォールの設定

### ［設問］1
(1) パケットフィルタリング
(2) a: 送信元IPアドレス, b: 宛先ポート番号
(3) DMZ (DeMilitarized Zone / 非武装地帯)

### ［解説］
・用語
*   **パケットフィルタリング**: ルータやファイアウォールが、通過するパケットのヘッダ情報（IPアドレス、ポート番号など）を見て、予め設定されたルールに基づき、そのパケットを通過させるか破棄するかを決定する、最も基本的なファイアウォールの機能です。
*   **DMZ (非武装地帯)**: インターネット（外部ネットワーク）と社内ネットワーク（内部ネットワーク）の中間に設けられる、隔離されたネットワークセグメントです。Webサーバやメールサーバなど、外部に公開する必要があるサーバを設置します。

・技術的背景：
(1) ファイアウォールは、通過する通信パケットを検査し、ルールに従ってフィルタリングを行います。

(2) パケットフィルタリングのルールは、主にパケットのIPヘッダやTCP/UDPヘッダに含まれる情報、すなわち「**(a) 送信元IPアドレス**」「宛先IPアドレス」「プロトコル」「**(b) 宛先ポート番号**」「送信元ポート番号」などを組み合わせて記述します。

**【受験者向け発展解説】**
ファイアウォールのルールは、**上から順に評価され、最初に一致したルールが適用される**のが基本です。そして、どのルールにも一致しなかった通信をどう扱うかを決めるのが**デフォルトポリシー**です。セキュリティの観点からは、最後に「全ての通信を拒否する（Deny All）」というルールを置き、それより上に許可したい通信だけを記述する**デフォルト拒否（Fail-Safe）** の設計が推奨されます。

(3) DMZを設けることで、万が一Webサーバなどが不正アクセスを受けて乗っ取られたとしても、社内ネットワークへの直接的な被害を防ぐことができます。DMZと社内ネットワークの間にもファイアウォールを設置し、通信を厳しく制限するのが一般的です。

**【受験者向け発展解説**】
DMZのファイアウォール設定の基本は次の通りです。
*   **インターネット → DMZ**: WebサーバへのHTTP/HTTPS(80, 443)など、公開に必要な最小限の通信のみ許可。
*   **DMZ → 社内LAN**: 原則として全て拒否。DMZのサーバから社内DBへのアクセスなど、必要な通信のみを最小限に許可。
*   **社内LAN → DMZ**: 必要な管理用通信などを許可。
このように、セグメント間の通信を厳しく制限することが重要です。

---
### ［設問］2
(1) ステートフルパケットインスペクション
(2) 戻りの通信（WebサーバからPCへの応答）のパケットだけを動的に通過させることができる。
(3) アプリケーションゲートウェイ（プロキシ）

### ［解説］
・用語
*   **ステートフルパケットインスペクション**: 従来のパケットフィルタリングの機能に加え、過去に通過したパケットの情報を記憶（通信の「状態（ステート）」を管理）し、その文脈に沿った通信であるかを判断して、より高度なフィルタリングを行う機能です。
*   **アプリケーションゲートウェイ (プロキシ型ファイアウォール)**: 内部ネットワークのクライアントの代理（プロキシ）として、外部のサーバと通信を中継する方式のファイアウォールです。HTTPやFTPなど、アプリケーションプロトコルごとに通信を解析するため、より詳細な制御が可能です。

・技術的背景：
(1) ステートフルパケットインスペクションは、通信のセッション（コネクション）を管理します。

(2) 例えば、社内PCから外部WebサーバへのHTTPリクエスト（往路）がファイアウォールを通過すると、ファイアウォールはその通信を記憶します。その後、Webサーバから社内PCへのHTTPレスポンス（復路）が到着すると、ファイアウォールは「これは先ほどの通信の戻りのパケットだ」と文脈を判断し、明示的な許可ルールがなくても動的にそのパケットを通過させます。これにより、戻りの通信のために多くのポートを開放する必要がなくなり、セキュリティが向上します。

**【受験者向け発展解説】**
ステートフルパケットインスペクションは、TCPのコネクション状態（SYN, ACKなど）を追跡します。これに対し、ヘッダ情報だけを見てパケットを個別に判断する方式を**スタティック（ステートレス）パケットフィルタリング**と呼びます。現在のファイアウォールのほとんどはステートフルパケットインスペクション機能を搭載しています。

(3) アプリケーションゲートウェイ型は、通信を一旦終端させ、内容を詳細に解析した上で、問題がなければ代理として通信を再開します。パケットを中継するだけのパケットフィルタリング方式に比べて、よりきめ細かく、安全な制御が可能ですが、処理負荷が高いという側面もあります。

**【受験者向け発展解説】**
ファイアウォールの世代を整理すると理解が深まります。
*   **第1世代**: パケットフィルタリング型
*   **第2世代**: ステートフルパケットインスペクション型
*   **第3世代**: アプリケーションゲートウェイ（プロキシ）型
*   **次世代ファイアウォール (NGFW)**: 上記の機能に加え、アプリケーション識別・制御、IPS、ウイルス対策など、複数のセキュリティ機能を統合したファイアウォール。
現在ではNGFWが主流となっています。