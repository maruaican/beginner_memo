システムプロンプトに従い、情報処理安全確保支援士試験合格レベルの知識に準拠した解説を行います。

### １．全体像（テキスト図）

```
利用者 ─┐
         │
         ├─── Webブラウザ
         │
         │
         └──── 悪意のある攻撃者
                   │
                   │ (SQLインジェクション)      (不正なSQL文の注入)
                   ├─→ Webサーバ/Webアプリケーション ─→ DB
                   │
                   │ (クロスサイトスクリプティング)  (不正スクリプトの埋め込み)
                   ├─→ Webサーバ/Webアプリケーション
                   │           ↓
                   │       (スクリプトの実行)
                   └─→ 利用者のWebブラウザ
                          │
                          └→ 攻撃者 (情報送信)
```

### ２．定義（IPA準拠）と用語の由来

情報処理安全確保支援士の観点から、攻撃の定義をより詳細に、かつ根本的な脆弱性と関連付けて解説します。

  * **SQLインジェクション**:
      * **定義**: Webアプリケーションが、データベースへの命令文（SQL文）を動的に組み立てる際に、利用者からの入力値を適切にエスケープ（無害化）せずに用いる脆弱性を悪用する攻撃。単なる不正な入力ではなく、データベースに対する認証回避や情報窃取、データ破壊を目的とした攻撃です。
      * **用語の由来**: 前述のとおりですが、特にセキュリティエンジニアリングの文脈では、この脆弱性が\*\*「入力検証の不備」\*\*に起因することが強調されます。
  * **クロスサイトスクリプティング（XSS）**:
      * **定義**: Webアプリケーションが、利用者からの入力を適切にサニタイジング（無害化）せずに、動的に生成するHTMLに出力する脆弱性を悪用し、利用者のブラウザ上で攻撃者が用意したスクリプトを実行させる攻撃。
      * **分類**: 反射型、格納型、DOM Basedの3種類に大別されます。セキュリティ対策の観点からは、これらのタイプに応じた対策が必要です。
  * **クロスサイトリクエストフォージェリ（CSRF）**:
      * **定義**: Webアプリケーションが、リクエストの正当性を検証する仕組みを持たない脆弱性を悪用し、攻撃者が利用者の意図しない操作を強制的に実行させる攻撃。
      * **用語の由来**: 「Forgery」は「偽造」を意味し、利用者になりすましてリクエストを**偽造**することに本質があります。
  * **セッションハイジャック**:
      * **定義**: WebアプリケーションがセッションIDを安全に管理していない脆弱性を悪用し、攻撃者がセッションIDを推測・窃取・固定化することで、利用者の認証情報を乗っ取る攻撃。
      * **用語の由来**: ネットワーク通信における「セッション（Session）」を「乗っ取る（Hijack）」ことから、この名称がつけられました。

### ３．技術の必要性（解決する具体的課題）

システム開発の上流工程から関与する情報処理安全確保支援士は、個別の対策技術だけでなく、その対策が必要となる根本的な原因と、対策がもたらすシステム全体のセキュリティ向上を理解する必要があります。

  * **入力値の検証・無害化**: ユーザーからの入力はすべて信頼できないものとして扱い、データベースやHTMLなど、利用されるコンテキストに応じて適切な無害化処理を施すことが、SQLインジェクションやXSSを防ぐ大前提です。
  * **セッション管理の厳格化**: セッションIDの推測困難性、盗聴防止、固定化対策など、セッション管理のライフサイクル全体にわたるセキュリティ確保が、セッションハイジャックを防ぐ上で不可欠です。
  * **リクエストの正当性検証**: Webアプリケーションの重要な機能（例：パスワード変更、決済処理）を実行する際、利用者の意図を再確認する仕組み（例：ワンタイムトークン）を導入することが、CSRFを防ぐ上で不可欠です。

### ４．試験の着眼点（頻出領域と解答に必要な知識を解説）

情報処理安全確保支援士試験では、単なる知識の有無だけでなく、具体的なシナリオにおける脆弱性の特定と、最も効果的かつ適切な対策の選択が問われます。

  * **脆弱性の特定**: 問題文に示されるソースコードや通信ログから、SQLインジェクション、XSS、CSRFなどの脆弱性がどこに存在するかを正確に読み取る能力が求められます。
  * **対策の選択**: 複数の対策候補の中から、システムのパフォーマンスや運用に与える影響、対策の網羅性を考慮して最適なものを選ぶ必要があります。例えば、SQLインジェクション対策として、静的プレースホルダはパフォーマンスが高速であり、かつ安全性が高いことから、推奨される対策であることが多いです。
  * **多層防御の理解**: 単一の対策に依存するのではなく、入力検証、セッション管理、認証、通信の暗号化など、複数のレイヤでセキュリティを確保する「多層防御」の考え方が重要となります。

### ５．体系マップ（分類・関係・比較表）

| 攻撃手法 | 脆弱性の根本原因 | 代表的な対策 |
| :--- | :--- | :--- |
| **SQLインジェクション** | SQL文の動的生成における入力検証不備 | プリペアドステートメント（静的プレースホルダ）、\<br\>エスケープ処理 |
| **クロスサイトスクリプティング（XSS）** | 出力処理における入力値のサニタイジング不備 | 入力値の無害化（HTMLエスケープ）、\<br\>WAF（Web Application Firewall）、\<br\>CSP（Content Security Policy） |
| **クロスサイトリクエストフォージェリ（CSRF）** | リクエストの正当性検証の不備 | ワンタイムトークン（同期トークン）、\<br\>Refererヘッダの検証、\<br\>SameSite Cookie属性 |
| **セッションハイジャック** | セッションIDの管理不備 | セッションIDの推測困難化（乱数性の向上）、\<br\>SSL/TLSによる通信暗号化、\<br\>セッションIDの定期的な再生成、\<br\>タイムアウトの設定 |

### ６．代表例（正答例・誤答例）

**正答例**

  * **SQLインジェクション** ↔ **静的プレースホルダ**
      * **解説**: プリペアドステートメント（静的プレースホルダ）は、SQL文の骨格とパラメータを分離してデータベースに送信します。データベースは、SQL文を最初にコンパイルし、後から送られてくるパラメータを単なるデータとして扱います。この処理特性により、パラメータ中にSQLの構文を構成する特殊文字が含まれていても、命令として解釈されることはありません。これは、攻撃者が意図したSQL文の実行を根本的に防ぐ、最も効果的かつ高速な対策です。

**誤答例**

  * **クロスサイトスクリプティング** ↔ **HTTP Only属性が付与されていないCookieの利用**
      * **解説**: HTTP Only属性が付与されていないCookieは、JavaScriptからアクセスが可能です。このため、XSSによってCookie情報が容易に窃取されてしまいます。セッション情報を含む重要なCookieには、必ずHTTP Only属性を付与し、JavaScriptからのアクセスを禁止すべきです。

### ７．よくある誤解と正しい知識

  * **誤解**: クロスサイトスクリプティングは、Webアプリケーションの入力フォームのみに存在する脆弱性である。
      * **正しい知識**: XSSは、入力フォームだけでなく、URLのパラメータやHTTPヘッダ、ファイルアップロードなど、Webアプリケーションが利用者からデータを受け付けるすべての箇所に潜在する可能性があります。攻撃の種類も、反射型、格納型、DOM Basedなど多岐にわたり、それぞれ異なる対策が求められます。情報処理安全確保支援士は、これらの多様な攻撃経路と対策を網羅的に理解し、設計段階から対策を講じる必要があります。

### ８．一問一答（5問：問題→回答→解説）

**問題１**
Webアプリケーションにおいて、SQLインジェクション対策として、パフォーマンスの観点から最も優れている手法はどれか。
**回答**
プリペアドステートメント（静的プレースホルダ）の利用
**解説**
プリペアドステートメントは、SQL文をあらかじめコンパイルしておくため、同じSQL文が繰り返し実行される場合、コンパイル処理のオーバーヘッドが削減され、高速な実行が期待できます。また、パラメータは後からバインドされるため、SQLインジェクション攻撃を根本的に防ぐことが可能です。

**問題２**
セッションハイジャック攻撃を最も効率的に防ぐために、HTTPレスポンスヘッダに追加すべき推奨属性はどれか。
**回答**
`Set-Cookie`ヘッダにおける`Secure`と`HttpOnly`属性
**解説**
`Secure`属性は、CookieがHTTPS通信でのみ送信されるように強制し、盗聴を防ぎます。`HttpOnly`属性は、JavaScriptからのCookieへのアクセスを禁止し、XSSによるCookieの窃取を防ぎます。これら二つの属性は、セッションハイジャック対策の基本中の基本です。

**問題３**
Webアプリケーション開発におけるCSRF対策として、二重送信防止トークン（ワンタイムトークン）の仕組みを詳細に説明せよ。
**回答**
①フォームを生成する際に、サーバ側で推測困難なランダムなトークンを生成し、セッションに保存します。②このトークンをWebページの隠しフィールドに含めて、利用者のブラウザに送信します。③利用者がフォームを送信する際、トークンも一緒にサーバに送られます。④サーバは、受信したトークンとセッションに保存しておいたトークンを比較し、一致した場合のみ処理を実行します。
**解説**
この仕組みにより、攻撃者が用意した偽のフォームには正しいトークンが含まれないため、サーバ側で不正なリクエストを拒否することができます。

**問題４**
Webアプリケーションのセキュリティ診断において、クロスサイトスクリプティング脆弱性を発見するために、入力値に含めるべき文字列の例を挙げよ。
**回答**
`<script>alert(1)</script>`
**解説**
この文字列は、HTMLの`<script>`タグを閉じることで、JavaScriptの`alert()`関数を実行させようとするものです。この文字列が、Webページの表示時にブラウザ上でダイアログを表示した場合、XSS脆弱性が存在すると判断できます。

**問題５**
SQLインジェクション対策として、エスケープ処理を行う際の課題を述べよ。
**回答**
エスケープ処理は、使用するデータベースや文字コードによってルールが異なるため、実装が複雑であり、漏れが生じるリスクがあります。また、開発者がすべての特殊文字を正確にエスケープする必要があり、ヒューマンエラーが発生しやすい点も課題です。
**解説**
このため、IPAを含む多くのセキュリティ機関は、エスケープ処理よりも、より安全で実装が容易なプリペアドステートメントの利用を推奨しています。

### ９．要約（3行以内）

情報処理安全確保支援士レベルの解説では、Webアプリケーションの主要な攻撃（SQLインジェクション、XSS、CSRF、セッションハイジャック）について、脆弱性の根本原因、攻撃の仕組み、そして最も効果的な対策技術を深く理解することが求められます。単一の知識ではなく、セキュリティの多層防御の視点から、最適な対策を論理的に選択する能力が重要です。