# セキュリティソリューション（DLP, UEBA, SIEM, EDR）の体系的解説

## はじめに：セキュリティ監視・防御技術の全体像

DLP, UEBA, SIEM, EDRは、いずれも企業のセキュリティを監視・防御するための重要なソリューションですが、それぞれ守る対象、検知する方法、導入位置が異なります。これらの違いを理解することは、自社に最適なセキュリティ対策を講じる上で不可欠です。

### 全体像の概念図

各ソリューションの基本的な関係性は以下の通りです。

承知いたしました。擬人化によるイメージングではなく、AP試験（応用情報技術者試験）などで問われるような、より技術的で体系的な理解を助けるためのネットワーク構成図をアスキーアートで作成します。

FW（ファイアウォール）やWAF（Web Application Firewall）を含め、各セキュリティソリューションがどのネットワーク階層で、どのような役割を果たすのかを図式化しました。

---

### セキュリティソリューション配置と役割の概念図（アスキーアート）

この図は、外部からの通信が内部に入り、各ソリューションがどのように機能するか、そして各所で発生したログがどのように集約・分析されるかを示しています。

```ascii
          【インターネット空間 (脅威の発生源)】
                    |
      正規通信 / サイバー攻撃 (SQLインジェクション, マルウェア侵入など)
                    ↓
+-----------------------------------------------------------------------+
|  ■ 境界防御レイヤー (Perimeter Security)                             |
|                                                                       |
|      [ ファイアウォール (FW) ]  <-- (1) 基本的な通信制御 (IP/ポート)  |
|                 |                                                     |
|                 ↓                                                     |
|      [ WAF (Web App FW) ]     <-- (2) Webアプリへの攻撃を防御         |
|                 |                                                     |
+-----------------|-----------------------------------------------------+
                  ↓
+-----------------------------------------------------------------------+
|  ■ 内部ネットワークレイヤー (Internal Network / LAN)                  |
|                                                                       |
|   +-------------------+     +-------------------+     +---------------+
|   |  [公開Webサーバ]  |     |  [内部サーバ]   |     |  [社内PC]   |
|   |-------------------|     |-------------------|     |---------------|
|   |   - EDR Agent     |     |   - EDR Agent     |     | - EDR Agent   |
|   +-------------------+     +-------------------+     | - DLP Agent   |
|             ↑                          ↑            +-------↑-------+
|             | (3) 端末内の挙動を監視・防御 (EDR)            | (4) 情報の持ち出しを制御 (DLP)
|             |                                               |
+-------------|-----------------------------------------------|---------+
              |                                               |
              +---------------------+     +-------------------+
                                    |     |
                 ログ・イベントの流れ |(5)  |
                                    ↓     ↓
+-----------------------------------------------------------------------+
|  ■ 監視・分析レイヤー (Monitoring & Analytics)                       |
|                                                                       |
|                  +--------------------------------+                     |
|                  | [ SIEM ] (統合ログ分析基盤)    |                     |
|                  |  - FW/WAF/EDR/サーバ等から収集 | <--(5)              |
|                  |  - ログの統合管理・相関分析    |                     |
|                  +--------------+-----------------+                     |
|                                 |                                     |
|                      (6) 高度な行動分析                               |
|                                 ↓                                     |
|                  +--------------------------------+                     |
|                  | [ UEBA ] (ふるまい検知エンジン) |                     |
|                  |  - ユーザ/端末の異常行動を検知 |                     |
|                  |  - 内部不正/アカウント乗っ取り |                     |
|                  +--------------------------------+                     |
+-----------------------------------------------------------------------+

```

### 図の解説と覚え方

上記の図を、番号に沿って解説します。これを一連の流れとして覚えることで、各ソリューションの役割と連携を体系的に理解できます。

#### (1) FW (ファイアウォール) - 会社の「通用門」
*   **役割:** ネットワークの最も外側に位置し、送信元/宛先のIPアドレスやポート番号といった情報に基づき、**許可された通信だけを通す門番**です。
*   **覚え方:** 「誰がどこから来て、どの部屋（ポート）に行きたいのか」という形式的な情報だけを見て、入館を許可・拒否します。

#### (2) WAF (Web Application Firewall) - 会社の「受付」
*   **役割:** 通用門(FW)を抜けた後、Webサーバーという特定の部屋へ向かう通信内容を詳しくチェックする受付係です。SQLインジェクションやクロスサイトスクリプティングといった、**Webアプリケーションの脆弱性を狙った攻撃を防ぎます**。
*   **覚え方:** 訪問者（通信）の「目的」や「持ち物の中身（=パケットの中身）」まで見て、怪しい人物（攻撃）を通しません。

#### (3) EDR (Endpoint Detection and Response) - 各部屋の「監視カメラと警備員」
*   **役割:** 内部ネットワークに入った後、個々のPCやサーバー（=エンドポイント）に常駐し、**内部での不審な挙動（マルウェアの活動など）を検知・対処**します。
*   **覚え方:** 受付(WAF)をすり抜けて建物内に侵入した不審者（未知のマルウェア）が、各部屋で悪事を働くのを監視し、即座に取り押さえます。

#### (4) DLP (Data Loss Prevention) - 社外への「荷物検査場」
*   **役割:** PCやネットワークの出口で、**「機密情報」と定義されたデータが外部に持ち出されようとしていないか**を監視し、制御（ブロック）します。
*   **覚え方:** 社員が社外に持ち出すカバンの中身（メール添付、USBメモリへのコピー）をすべてチェックし、重要書類（機密データ）の持ち出しを防ぎます。

#### (5) SIEM (Security Information and Event Management) - 「中央防災センター」
*   **役割:** FW、WAF、EDR、サーバなど、**あらゆる機器から出力されるログ（警報や入退室記録）をすべて集約**し、一元的に管理・分析する場所です。
*   **覚え方:** 「受付で不審な訪問者情報があった（WAFログ）」と「ある部屋で非常ベルが鳴った（EDRログ）」という別々の報告を突き合わせ（相関分析）、建物全体で起きているインシデントの全体像を把握します。

#### (6) UEBA (User and Entity Behavior Analytics) - 「プロファイリング専門の分析官」
*   **役割:** SIEMが集めた膨大なログを使い、AIや統計学を駆使して**ユーザーや端末の「普段の行動パターン」を学習**し、そこから逸脱する「いつもと違う動き」を検知します。
*   **覚え方:** 防災センター(SIEM)にいる専門家。普段の従業員の行動パターンをすべて把握しており、「あの従業員が深夜に重要書類の保管庫にアクセスしているのはおかしい」といった、**権限上は正しくても状況的におかしい行動（内部不正やアカウント乗っ取りの兆候）**を見つけ出します。

この図と解説により、各ソリューションが単独で存在するのではなく、多層防御の各レイヤーで連携し、ログをSIEMに集約して統合的に監視・分析するという一連の流れをイメージできるかと思います。




------------------------------------------------------------------------
### 各ソリューションの役割（要約）

*   **DLP:** 情報漏洩防止
*   **UEBA:** 行動異常検知
*   **SIEM:** ログ統合分析
*   **EDR:** 端末挙動監視

---

## 第1章：主要セキュリティソリューションの定義と目的

### 1.1. DLP (Data Loss Prevention)

*   **正式名称:** Data Loss Prevention（データ損失防止）
*   **定義 (IPA準拠):** 機密情報が社外に流出しないよう、コピー・送信・印刷といった操作を制御する仕組み。
*   **解決する課題:** USBメモリやメール、クラウドストレージなどを経由した、意図的または偶発的な機密情報の持ち出しを防止します。

### 1.2. UEBA (User and Entity Behavior Analytics)

*   **正式名称:** User and Entity Behavior Analytics（ユーザと端末の行動分析）
*   **定義 (IPA準拠):** ユーザーや端末の通常の行動パターンをAIや統計的手法で学習し、それから逸脱した「いつもと違うふるまい」を検知する仕組み。
*   **解決する課題:** 内部関係者による不正行為（Insider Threat）や、正規アカウントが乗っ取られた後の不正行動など、従来のセキュリティ対策では検知が難しい脅威に対応します。

### 1.3. SIEM (Security Information and Event Management)

*   **正式名称:** Security Information and Event Management（セキュリティ情報・イベント管理）
*   **定義 (IPA準拠):** ファイアウォール、サーバー、各種セキュリティ製品など、多様な機器から出力されるログを一元的に収集・管理し、それらを横断的に分析（相関分析）することで、単体の機器では見つけられない攻撃の兆候を発見する仕組み。
*   **解決する課題:** 各機器に散在するログを統合管理できていないため、インシデントの全体像が把握できず、監視が困難であるという問題を解決します。

### 1.4. EDR (Endpoint Detection and Response)

*   **正式名称:** Endpoint Detection and Response（エンドポイントでの検知と対応）
*   **定義 (IPA準拠):** PCやサーバーなどのエンドポイント（端末）におけるファイル操作やプロセス実行、ネットワーク通信といった挙動をリアルタイムで監視し、不審な動きを検知・遮断・記録する仕組み。
*   **解決する課題:** 従来のパターンマッチング型のウイルス対策ソフト（アンチウイルス）をすり抜けて侵入する、新種や未知のマルウェア（ゼロデイ攻撃など）に対応します。
*   **従来のアンチウイルスとの違い:** 従来のアンチウイルスは、既知のマルウェアのシグネチャ（特徴）と照合する「署名検知」が主です。一方、EDRは未知のマルウェアも対象とし、その不審な「挙動」を検知する点で異なります。

---

## 第2章：主要ソリューションの機能・ユースケース比較

### 2.1. 機能比較一覧

| 技術 | 守る対象 | 手法 | 主な利用シーン |
| :--- | :--- | :--- | :--- |
| **DLP** | データ（情報資産） | コピーや送信の制御 | 情報漏洩防止 |
| **UEBA** | ユーザ・端末 | 行動パターンの異常検知 | 内部不正検知 |
| **SIEM** | ログ全体 | 相関分析 | SOCでの統合監視 |
| **EDR** | 端末（エンドポイント） | 挙動監視・遮断 | マルウェア対応 |

### 2.2. ユースケース比較（Q&A形式）

*   **Q1. 社員が機密情報を含むファイルを、個人のUSBメモリにコピーするのを防ぎたい。どの仕組みが有効か？**
    *   **A1. DLP**
    *   **解説:** 情報の「持ち出し制御」がキーワードです。DLPは、指定された機密情報が許可なく外部デバイスにコピーされるのを防ぎます。

*   **Q2. 正規のIDとパスワードでログインした社員のアカウントが、深夜に普段アクセスしないサーバーへ大量のアクセスを試みている。この異常を検知したい。どの仕組みが有効か？**
    *   **A2. UEBA**
    *   **解説:** 正規アカウントが乗っ取られたケースです。「利用者の通常行動と異なるアクセス」という行動パターンの異常に注目するのがUEBAの特徴です。

*   **Q3. ファイアウォールでの不審な通信ログと、Webサーバーでのログイン失敗ログ、Active Directoryでの権限変更ログを突き合わせて、一連の攻撃キャンペーンとして検知したい。どの仕組みが有効か？**
    *   **A3. SIEM**
    *   **解説:** 複数の異なる機器からの「ログを一元管理し、相関分析する」のはSIEMの本質的な機能です。

*   **Q4. 添付ファイル付きメールを開いた後、PC内で不審なプログラムが起動し、他のファイルに自身をコピーしようとしている。この未知のマルウェアの活動をリアルタイムで遮断したい。どの仕組みが有効か？**
    *   **A4. EDR**
    *   **解説:** 端末（エンドポイント）上で、従来のアンチウイルスソフトを超える未知の脅威の「挙動を検知し、対応する」のがEDRの役割です。

*   **Q5. 「情報漏洩対策」「内部犯行の検知」「ログの統合管理」「マルウェアからの端末防御」をそれぞれ主目的とする仕組みを答えよ。**
    *   **A5. DLP / UEBA / SIEM / EDR**
    *   **解説:** この4つの技術は、それぞれ異なるセキュリティ課題に対応するために存在しており、相互に補完しあう関係にあります。

### 2.3. 混同しやすいポイントと正しい理解

資格試験などでは、これらの技術の役割を正確に区別できるかが問われます。

*   **DLP vs UEBA: 情報の「持ち出し制御」と「行動異常検知」**
    *   目的は内部不正対策で近いですが、手法が異なります。DLPはあらかじめ定義されたルールに基づいて情報の「持ち出し制御」を直接行うのに対し、UEBAは平時の行動パターンとの差異から「異常検知」を行います。
*   **SIEM vs UEBA: ログの「相関分析」とユーザーの「ふるまい分析」**
    *   SIEMは多様な機器のログを横断的に分析する「ログの相関分析」が主目的です。一方、UEBAはユーザーや端末の「ふるまい分析」に特化し、その「異常検知」を行います。
*   **SIEM vs EDR: 「ログ統合分析」と「端末での直接検知」**
    *   エンドポイントでマルウェアの挙動を直接検知するのはEDRの役割です。SIEMは、そのEDRなどから送られてきたログを含め、様々なログを収集・分析する役割を担います。

---

## 第3章：関連・発展技術

### 3.1. DLPの関連技術：情報漏洩対策の多層化

*   **CASB (Cloud Access Security Broker)**
    *   クラウドサービスの利用を可視化・制御する仕組み。クラウド環境におけるDLP機能を提供し、機密データが不適切なクラウドサービスにアップロードされるのを防ぎます。
    *   **DLPとの違い:** 社内ネットワークが主戦場ならDLP、**「クラウド環境」**における情報漏洩対策ならCASBと使い分けられます。
*   **DRM/IRM (Digital/Information Rights Management)**
    *   ファイル自体に暗号化やアクセス制御を施し、「誰が、いつ、どの操作（閲覧、編集、印刷など）をできるか」を制御する技術。ファイルが社外に持ち出された後も保護が継続します。
*   **MDM (Mobile Device Management)**
    *   スマートフォンやタブレットなどのモバイル端末を統合管理し、遠隔ロックやデータ消去、アプリケーションの利用制限などを行うことで、端末からのデータ漏洩を防止します。

### 3.2. UEBAの関連技術：行動分析の進化

*   **UBA (User Behavior Analytics)**
    *   UEBAの`前身`とされる技術で、分析対象を主に「ユーザー」の行動に限定していました。U`E`BAはこれに「`エンティティ（端末、サーバーなど）`」の行動分析を加えて拡張したものです。
*   **AI/機械学習による異常検知**
    *   UEBAの中核技術です。正常な行動の統計的なモデル（ベースライン）を自動で作成し、そこから大きく逸脱する異常なふるまいを検知します。
*   **SIEMとの連携**
    *   UEBAは単体で導入されるよりも、SIEMが収集した膨大なログデータを分析基盤として利用し、SIEMの機能の一つとして提供されることが多くあります。

### 3.3. SIEMの関連技術：統合監視と対応の自動化

*   **SOAR (Security Orchestration, Automation and Response)**
    *   SIEMの発展形。SIEMが検知したインシデントに対し、事前に定義された手順（プレイブック）に従って、脅威情報の収集やネットワーク遮断といった対応を**「自動化」**する仕組みです。
    *   **SIEMとの違い:** 脅威の「検知・分析」が主目的であればSIEM、検知後の対応の「自動化」が主目的であればSOARとなります。
*   **SOC (Security Operation Center)**
    *   SIEMなどのツールを活用して、24時間365日体制でセキュリティ監視・分析を行う専門の組織や機能のことです。
*   **NDR (Network Detection and Response)**
    *   ネットワーク全体の通信（パケット）を監視・分析し、不審な挙動やマルウェアの通信などを検知する仕組み。SIEMがログベースであるのに対し、NDRは通信の中身を直接分析します。

### 3.4. EDRの関連技術：端末防御の拡張

*   **XDR (Extended Detection and Response)**
    *   EDRの概念を拡張したもので、エンドポイントだけでなく、ネットワーク（NDR）、クラウド、メールなど、複数の領域から情報を収集・相関分析し、より広範囲で高度な検知と対応を実現します。
    *   **EDRとの違い:** 「端末限定」の検知・対応がEDRであるのに対し、XDRは端末、ネットワーク、クラウドなど**「統合範囲を拡大」**した検知・対応を行います。
*   **MDR (Managed Detection and Response)**
    *   EDRやXDRの運用を、専門知識を持つベンダーやセキュリティ事業者に委託するサービスです。高度な脅威分析やインシデント対応を専門家が代行します。
*   **NGAV (Next Generation Anti-Virus)**
    *   従来型アンチウイルス（AV）の進化系。機械学習やAI、挙動分析といった技術を用いて、未知のマルウェアやファイルレス攻撃を検知・防御します。EDRと機能的に重複する部分もあります。