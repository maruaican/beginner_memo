# データベースの矢印（→）整理

* **異なる**エンティティ間の関係：カーディナリー（**多重度**）
 
* **同一**テーブルの関係＝正規化：**「関数従属性」**を表す。

まったく違うので注意。

## （１）E-R図における矢印（カーディナリティ：多重度）


* **意味**：エンティティ間の**カーディナリティ（多重度）**を表す。
* **試験ルール**：必ず「**１→多**」で描かれる（応用情報技術者試験の凡例で統一）。テキストによっては、異なる書き方をしているが応用情報技術者試験では、上記で統一されている。
* **読み方**：「１つの○○に対して、複数の△△が対応する」

### 例

* 部署ID → 従業員
  （１つの部署に対して、複数の従業員が所属する）
* 注文 → 注文明細
  （１つの注文に対して、複数の注文明細が存在する）

  ・主キー（項目A：**実線**）　１→多　外部キー（項目A：**点線**）

* 一般常識的に考えることも必要。 
* ID、番号、コード　→　日付、年月
* IDなどの類が主キー：１となる。一方、日付などは、無限にあるので外部キー：多となるのは予想できる。
* 部署ID　→　従業員ID　　　※「部署ごとに」との記載があれば、従業員が多いとわかるので、部署＜従業員となる。リンゴの大きさ**ごとに**をイメージすれば、箱：１＜多：リンゴの数と分かる。

* 注文　　　　　　　→　　　注文明細

🔑 **試験での着眼点**

* （１）主キー（実線）　→　外部キー（点線）の関係を確認する。
　　一意　　　１　→　多
※実線＝漢数字の一。点線が雨のようにたくさん（多い）なので、傘は外部キー。
※ただ、必ずしもこうならないのが応用情報なので注意。

* （２）一般常識で考える。
　　・日付、時間、注文がたくさんあるのは当然。
　　・注文＜注文明細
　　・商品分類コード＜商品コード
　　・
* （３）上記で解けない場合は、本文から拾う。
* 問題文の「○○ごとに△△が複数ある」という記述を根拠に、矢印の方向を決定する。
* 一か所だけではなく複数個所から拾う必要がある場合がある（例：絶対パス＋フォルダ＝フォルダパス名）
---

## （２）正規化における矢印

* **意味**：同一テーブル内の**「関数従属性」**を表す。
* **E-R図のカーディナリティとは無関係**。
* 書き方：**主キー（決定項目） → 非キー項目（従属項目）**

### 例

* 社員ID → 社員名，部署ID，給与
  （社員IDが**決まると**、社員名や給与も一意に決まる）
  （社員名は、社員IDに**従属している**）

🔑 **試験での着眼点**
* 「同じテーブルの中で、どの項目がどの項目を一意に決めるか」を考える。
* 「外部キーの参照」と混同しないように注意！！

---

## （３）体系マップ（比較）

| 領域       | 矢印の意味        | 対象         | 典型例        | 試験での狙い              |
| -------- | ------------ | ---------- | ---------- | ------------------- |
| **E-R図** | １→多のカーディナリティ | エンティティ間    | 部署 → 従業員   | 問題文から方向を推定させる       |
| **正規化**  | 関数従属性        | 同一テーブル内の項目 | 社員ID → 社員名 | 「決定項目」と「従属項目」の誤解を狙う |

---

## （４）代表例（正答例・誤答例）

* ✅ **正答例**：部署 → 従業員（１部署に多従業員）
* ❌ **誤答例**：従業員 → 部署（「従業員ごとに複数部署」が誤り）

* ✅ **正答例**（正規化）：社員ID → 社員名
* ❌ **誤答例**（正規化）：社員名 → 社員ID（同姓の社員がいる場合、一意に決まらない）

---

## （５）よくある誤解と正しい知識

* ❌ 「E-R図の１→多は、関数従属性の１→多と同じ意味」
  → **誤り**（前者はエンティティ間の行数関係、後者は同一表内の決定関係）
* ❌ 「外部キーがあるから必ず１対多」
  → **誤り**（外部キーは参照関係を示すだけで、必ず１対多とは限らない）

---

## （６）一問一答（５問）

**Q1.** E-R図で「部署 → 従業員」と表される意味は？
**A1.** 部署１⇒多従業員。１つの部署に複数の従業員が所属する。
**解説**：E-R図では１→多の関係を表す。

**Q2.** **正規化**における「社員ID → 社員名」の意味は？
**A2.** 社員IDが決まれば、社員名が一意に決まる。
**解説**：**関数従属性**の矢印である。

**Q3.** 「社員名 → 社員ID」は正しいか？
**A3.** 誤り。
**解説**：同姓同名の社員がいるため、一意に決まらない。

**Q4.** 注文 → 注文明細の関係は、どのように読み取るか？
**A4.** １つの注文に対して複数の注文明細が存在する。
**解説**：E-R図の１対多。

**Q5.** E-R図の矢印と正規化の矢印は同じ意味か？
**A5.** 違う。
**解説**：E-R図はエンティティ間の件数関係、正規化は同一表内の関数従属性。

---

## （７）要約（３行以内）

* E-R図の「１→多」は**エンティティ間の行数関係**を表す。
* 正規化の「A→B」は**同一表内の関数従属性**を表す。

* エンティティ間の件数関係＝「表の行数どうしの対応関係」
* 正規化の関数従属性＝「同じ表内の項目どうしの決定関係」

* E-R図の矢印：表どうし（行数どうし）の関係を表す。
* 正規化の矢印：同じ表の中で「どの項目が他の項目を一意に決めるか」を表す。

* 試験では「両者の混同を狙う」ので、区別が必須。

---

いい質問です 👍
「エンティティ間の件数関係」と「行数の関係」がどうつながるのかを整理してみましょう。

---

## １　エンティティ間の件数関係とは？

* **定義**：２つのエンティティが関連するとき、**片方の１つの行に対して、もう片方に何行が対応するか**を表す。
* IPA用語では「カーディナリティ（多重度）」と呼ぶ。

---

## ２　具体例（行数の関係に置き換える）

### 部署 と 従業員

* 部署（部署IDが主キー）
* 従業員（従業員IDが主キー、部署IDが外部キー）

関係：**部署１行 → 従業員が複数行**
例：

| 部署ID | 部署名 |
| ---- | --- |
| 10   | 総務  |
| 20   | 開発  |

| 従業員ID | 氏名 | 部署ID |
| ----- | -- | ---- |
| 101   | 佐藤 | 10   |
| 102   | 鈴木 | 10   |
| 201   | 田中 | 20   |

→ 「部署ID=10」の１行に対して、従業員表では「佐藤」「鈴木」の**２行が対応**する。
これが「１対多（部署→従業員）」という**行数関係**。

---

### 注文 ↔ 注文明細
* 注文表の１行（注文ID=500）
* 注文明細表では、その注文に属する商品ごとに複数行（例：商品A×2行、商品B×1行）

→ 注文１行 → 注文明細が複数行。

---



# 問題
関係R(A，B，C，D，E，F)において，関数従属A→B，C→D，C→E，{A，C}→Fが成立するとき，関係Rの候補キーはどれか。

# １　全体像（テキスト図）

```
関係 R(A, B, C, D, E, F)
   │
   ├─ A → B
   ├─ C → D, C → E
   └─ {A, C} → F
```

* 「→」は **左の属性集合が右の属性を一意に決める**ことを意味
* 候補キーは {A, C}（最小の全属性決定集合）

---

# １－１　定義（IPA準拠）と用語の由来

* **関数従属（FD）**
  「属性 X が Y を決定する」ことを X→Y で表す

  * X は決定属性（determinant）
  * Y は従属属性（dependent attribute）
* **候補キー**
  「全属性を決定できる最小の属性集合」
* **超キー**
  「全属性を決定できる属性集合（最小である必要なし）」

**語源**

* “Functional Dependency” は「関数的に依存する」から。数学の関数 f(x)=y に似て、X に対して Y が一意に決まることを意味。

---

# １－２　技術の必要性（解決する具体的課題）

* データベース設計で冗長性を減らし、更新異常（更新・挿入・削除異常）を防ぐために必要
* 候補キーや関数従属を理解すると、**正規化**の判断が正確にできる

---

# １－３　試験の着眼点

* FD の読み取り：左辺→右辺
* 候補キー判定：全属性を決定できる最小集合
* 属性閉包の計算が頻出

  * 「X+」を求めて全属性に到達するか確認
* 試験作成者は受験者が「部分従属だけ見てキーを誤判断」することを狙っている

---

# １－４　体系マップ（分類・関係・比較表）

| 概念      | 定義                  | 例                      |
| ------- | ------------------- | ---------------------- |
| 関数従属 FD | X→Y、X の値で Y が一意に決まる | A→B、C→D、{A,C}→F        |
| 超キー     | 全属性を決定できる属性集合       | {A,C}, {A,C,D}         |
| 候補キー    | 超キーかつ最小の集合          | {A,C}                  |
| 主キー     | 候補キーのうち選ばれた 1 つ     | {A,C} を採用              |
| 属性閉包 X+ | X から導けるすべての属性       | {A,C}+ = {A,B,C,D,E,F} |

---

# １－５　代表例（正答例・誤答例）

* 正答例：候補キー = {A, C}
* 誤答例：

  * A だけ → ×（B しか決まらない）
  * C だけ → ×（D, E は決まるが F が決まらない）
  * {A, C, D} → ○ 超キーだが最小でないので候補キーではない

---

# １－６　よくある誤解と正しい知識

* 「左辺に1つの属性があるとそれがキー」 → 誤り
* 「右辺の属性が多いほど候補キーになりやすい」 → 誤り
* 「FD が複数あっても、最小性を確認せずに候補キー判定する」 → 誤り

**正しい理解**：

1. 候補キーは **全属性を決定できること**
2. 候補キーは **最小集合であること**

---

# １－７　一問一答（5問：問題→回答→解説）

**問1**
R(A,B,C,D,E,F) において A→B, C→D, C→E, {A,C}→F がある。{A}+ = ?
**答**：{A,B}
**解説**：A だけでは B は決まるが、C, D, E, F は決まらない

**問2**
{C}+ = ?
**答**：{C,D,E}
**解説**：C→D, C→E で D, E が決まるが A, B, F は決まらない

**問3**
{A,C}+ = ?
**答**：{A,B,C,D,E,F}
**解説**：全属性が決まるので {A,C} は超キー

**問4**
{A,C} は候補キーか？
**答**：はい
**解説**：全属性を決められ、A か C 単独では決められないため最小

**問5**
{A,C,D} は候補キーか？
**答**：いいえ
**解説**：全属性を決められるが、D を含めなくても {A,C} で十分なので最小でない

---

# １－８　要約（3行以内）

* 関数従属は X→Y で X が Y を一意に決める関係
* 候補キーは全属性を決定できる最小集合
* 属性閉包で候補キーか判定する

---





