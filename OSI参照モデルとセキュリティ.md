承知いたしました。ご提供いただいた資料を、重複をなくし、体系的に整理します。

***

### OSI参照モデルにおけるネットワークセキュリティ技術

この資料は、OSI参照モデルの各階層で利用されるセキュリティ技術について、その役割、仕組み、関連技術を体系的にまとめたものです。

---

### 1. OSI参照モデルとデータ通信の仕組み

ネットワーク通信は、OSI参照モデルに基づいた階層構造で成り立っています。データは送信時に上位層から下位層へと送られ、各層で必要な情報（ヘッダ）が付与されてカプセル化されます。

| OSI階層 | データ単位 | アドレス情報 | 内容・役割 |
| :--- | :--- | :--- | :--- |
| **アプリケーション層** | データ | （プロトコル依存） | ユーザーが直接やり取りする情報（HTTPメッセージ、メール本文など）を定義します。 |
| **トランスポート層** | セグメント | ポート番号 | どのアプリケーションの通信かを識別し、通信の信頼性（TCP）などを管理します。 |
| **ネットワーク層** | パケット | IPアドレス | ネットワーク間の宛先を決定し、通信経路を選択（ルーティング）します。 |
| **データリンク層** | フレーム | MACアドレス | 同一ネットワーク内（LAN内）の機器間でデータを転送します。 |

**ポイント**
*   データは「データ → セグメント → パケット → フレーム」の順にカプセル化されて送信されます。
*   暗号化技術は、通信内容である「データ」部分のみを対象にする場合や、ヘッダを含む「パケット全体」を対象にする場合があります。

---

### 2. 各階層におけるセキュリティ技術

攻撃はネットワークの様々な階層で行われるため、それぞれの階層に応じた多層的な防御が必要となります。

#### 2.1. アプリケーション層のセキュリティ

ユーザーが直接触れるアプリケーションのデータを保護します。

*   **TLS/SSL (Transport Layer Security / Secure Sockets Layer)**
    *   **役割**: アプリケーション層で扱われるデータ（HTTPの中身など）を暗号化し、通信の盗聴や改ざんを防ぎます。認証機能も持ちます。
    *   **備考**: TLSはSSLの後継プロトコルで、より安全性が向上しています。HTTPS通信は、このTLS/SSLをTCP上で利用する技術です。

*   **WAF (Web Application Firewall)**
    *   **役割**: Webアプリケーションに対する攻撃を専門に防御します。
    *   **防御対象**: SQLインジェクションやクロスサイトスクリプティング（XSS）など、アプリケーションの脆弱性を狙った攻撃のパターンを検知・遮断します。
    *   **注意点**: ファイアウォールがIPアドレスやポート番号で通信を制御するのに対し、WAFは通信の中身（HTTPデータ）を検査する点で役割が異なります。

*   **S/MIME, PGP**
    *   **役割**: 電子メールの内容を暗号化し、盗聴や改ざんを防ぎます。

#### 2.2. トランスポート層のセキュリティ

通信セッションやサービス（ポート）単位でのアクセスを制御します。

*   **TCPセグメントフィルタリング（状態監視型ファイアウォール）**
    *   **役割**: TCPのポート番号や通信状態（フラグ）に基づいて、通信を許可または拒否します。これにより、特定のサービスへのアクセスを制御したり、不正な接続要求を遮断したりします。
    *   **関連技術: ステートフルインスペクション (Stateful Inspection)**
        *   **仕組み**: 単純なパケットフィルタリングとは異なり、通信の文脈（セッション状態）を記憶・管理します。例えば、正規の要求（SYN）に対する応答（SYN-ACK）だけを許可するなど、セッション単位で通信を制御します。
        *   **特徴**: このセッション状態の記録は、ファイアウォールなどの中間機器が行います。サーバーやクライアント自身がこの目的で状態を保持するわけではありません。

#### 2.3. ネットワーク層のセキュリティ

IPアドレスに基づき、ネットワーク間の不正なパケットの通過を制御します。

*   **ファイアウォール (パケットフィルタリング)**
    *   **役割**: ネットワークの境界に設置され、IPアドレスやポート番号といったヘッダ情報に基づいて、パケット単位で通信を通過させるか遮断するかを判断します。

*   **IPsec (IP Security)**
    *   **役割**: ネットワーク層でIPパケット全体を暗号化・認証します。主にVPN（Virtual Private Network）の構築に利用され、安全な通信経路を確保します。
    *   **動作モード**:
        *   **トランスポートモード**: 元のIPヘッダは暗号化せず、データ部分（ペイロード）のみを暗号化します。
        *   **トンネルモード**: 元のIPパケット全体を暗号化し、新しいIPヘッダを付与します。
    *   **ポイント**: どちらのモードでも、ルータが経路判断するために必要な宛先IPアドレスは暗号化されずに残るため、通信経路がわからなくなる心配はありません。

*   **IDS/IPS (Intrusion Detection/Prevention System - 侵入検知/防御システム)**
    *   **役割**: ネットワーク上を流れるパケットを監視し、マルウェアの通信やDoS攻撃、不正アクセスといった異常な通信を検知・防御します。
    *   **違い**:
        *   **IDS (侵入検知システム)**: 不正な通信を検知し、管理者に通知（ログ出力など）します。
        *   **IPS (侵入防御システム)**: 検知に加えて、不正な通信を自動的に遮断します。

#### 2.4. データリンク層のセキュリティ

同一ネットワーク（LAN）内での物理的なアクセスを制御します。

*   **802.1X認証**
    *   **役割**: LANに接続しようとする端末（PCなど）を認証し、許可された端末のみにネットワークアクセスを許可します。
    *   **仕組み**: スイッチや無線LANアクセスポイントが認証を行い、未認証の端末が社内LANなどに接続するのを防ぎます。

*   **VLAN (Virtual LAN)**
    *   **役割**: 物理的には1つのネットワークを、スイッチの設定によって論理的に複数のネットワークに分割します。
    *   **効果**: 部署ごとなどにネットワークを分離することで、異なるVLAN間の通信を制限し、セキュリティを向上させます。また、不要な通信（ブロードキャスト）がネットワーク全体に広がるのを防ぎ、負荷を軽減します。

*   **スイッチACL (Access Control List)**
    *   **役割**: スイッチにおいて、特定のMACアドレスやIPアドレスを持つ端末からの通信を許可または拒否します。
    *   **効果**: 未認証の端末や不正な端末からのアクセスを制御します。

---

### 3. セキュリティ技術の体系マップ

各技術がどの階層で、どのような脅威から何を保護するのかを一覧で示します。

| OSI階層 | データ単位 | アドレス情報 | セキュリティ技術 | 主な防御対象 |
| :--- | :--- | :--- | :--- | :--- |
| **アプリケーション層** | データ | （プロトコル依存） | TLS/SSL, WAF, S/MIME, PGP | データの内容、アプリケーションへの攻撃 |
| **トランスポート層** | セグメント | ポート番号 | TCPフィルタリング（ステートフル検査） | 不正な通信路の確立、サービスへの攻撃 |
| **ネットワーク層** | パケット | IPアドレス | IPsec, ファイアウォール, IDS/IPS | 不正な経路へのアクセス、不正パケット |
| **データリンク層** | フレーム | MACアドレス | 802.1X, VLAN, スイッチACL | LANへの不正アクセス、MACアドレス偽装 |

---

### 4. 理解度チェック

よくある質問や誤解を通じて、各技術の理解を深めます。

#### 4.1. よくある誤解と正しい理解

*   **誤解**: TLSはMACアドレス単位で暗号化される。
    *   **正解**: 誤りです。TLSは**アプリケーション層のデータ**を暗号化する技術です。

*   **誤解**: ファイアウォールとWAFは同じものだ。
    *   **正解**: 誤りです。**動作する階層と防御対象が異なります**。ファイアウォールは主にネットワーク層でIPアドレスやポートを基に制御しますが、WAFはアプリケーション層で通信の中身（HTTPデータなど）を検査します。

*   **誤解**: SSLとTLSは同じものだ。
    *   **正解**: 厳密には異なります。**TLSはSSLの後継**であり、脆弱性が修正され、より安全性が高められています。

---

#### 4.2. 一問一答

*   **問題1**: HTTPS通信で暗号化されるのはどの層のデータですか？
    *   **回答**: **アプリケーション層**のデータです。
    *   **解説**: TLSはアプリケーション層のデータを、TCP上で転送するために暗号化します。TCPヘッダ自体は暗号化されません。

*   **問題2**: IPsecはどのOSI階層で動作しますか？
    *   **回答**: **ネットワーク層**です。
    *   **解説**: IPパケットを対象に暗号化や認証を行い、主にVPNで利用されます。

*   **問題3**: WAFで防御可能な攻撃の例は何ですか？
    *   **回答**: **SQLインジェクション**や**クロスサイトスクリプティング（XSS）**など、アプリケーション層を標的とする攻撃です。
    *   **解説**: WAFはHTTP/HTTPS通信の内容を詳細に検査し、不正なパターンを検知して遮断します。

*   **問題4**: 802.1X認証は何を対象に行われますか？
    *   **回答**: LANに接続する**端末**です。
    *   **解説**: ネットワークスイッチや無線LANアクセスポイントが端末の認証を行い、許可されていない端末のアクセスを防ぎます。

*   **問題5 (追加)**: ファイアウォールの一種であるステートフルインスペクションが、従来のパケットフィルタリングより優れている点は何ですか？
    *   **回答**: 過去の通信を記憶し、その**文脈（セッション状態）に基づいて**パケットの通過を判断できる点です。
    *   **解説**: これにより、内部からの通信に対する正当な応答パケットのみを通過させることができ、不正な通信をより効果的に遮断できます。

*   **問題6 (追加)**: Webブラウザから社内システムにリモートアクセスする際に利用されるVPNで、トランスポート層で動作するプロトコルは何ですか？
    *   **回答**: **TLS (またはSSL)**です。一般的に**TLS-VPN（SSL-VPN）**と呼ばれます。
    *   **解説**: IPsecがネットワーク層で動作するのに対し、TLS-VPNはWebブラウザなどのアプリケーションに組み込みやすく、既存のファイアウォール設定を変更せずに導入しやすい利点があります。

*   **問題7 (追加)**: IDS/IPSにおいて、既知の攻撃パターンを定義したファイル（シグネチャ）と通信を照合して不正を検知する方式を何と呼びますか？
    *   **回答**: **シグネチャ検出（パターンマッチング）方式**です。
    *   **解説**: この方式は既知の攻撃に対して高い精度で検知できますが、未知の攻撃（ゼロデイ攻撃）の検知は困難です。対照的な方式として、正常な状態と異なる通信を異常と判断するアノマリ検出方式があります。

*   **問題8 (追加)**: 無線LANのセキュリティ規格であるWPA3で利用される、必須の暗号化方式は何ですか？
    *   **回答**: **AES (Advanced Encryption Standard)** です。
    *   **解説**: WPA3は、WPA2の脆弱性を改善し、より強固な暗号化と認証機能を提供します。暗号化プロトコルとしてはCCMP（AESをベースにしたもの）が利用されます。

*   **問題9 (追加)**: 送信元メールサーバのIPアドレスが、そのドメインのDNSに正当なものとして登録されているかを検証する、送信ドメイン認証技術は何ですか？
    *   **回答**: **SPF (Sender Policy Framework)** です。
    *   **解説**: SPFは、メールヘッダのエンベロープFrom情報をもとに送信元IPアドレスを検証し、なりすましメール対策として利用されます。DKIMやDMARCといった他の技術と組み合わせて使われることが推奨されます。

*   **問題10 (追加)**: DNSサーバへの問い合わせに対し、偽の応答情報を送り込むことで、利用者を不正なサイトへ誘導する攻撃を何と呼びますか？
    *   **回答**: **DNSキャッシュポイズニング**（またはDNSスプーフィング）です。
    *   **解説**: この攻撃への対策として、DNSの応答に電子署名を付与し、その正当性を検証する**DNSSEC (DNS Security Extensions)** があります。

*   **問題11 (追加)**: 内部ネットワークのクライアントPCに代わってインターネットにアクセスし、URLフィルタリングなどを行うサーバを何と呼びますか？
    *   **回答**: **フォワードプロキシサーバ**です。
    *   **解説**: フォワードプロキシは、クライアントの通信を代理することで、アクセス制御や通信内容のウイルスチェック、キャッシュによる応答速度の向上といった役割を担います。

*   **問題12 (追加)**: 複数のスイッチにまたがってVLANを構成する際、フレームがどのVLANに所属するかを識別するために付与される情報を何と呼びますか？
    *   **回答**: **VLANタグ（またはタグVLAN）**です。
    *   **解説**: この仕組みはIEEE 802.1Qで標準化されており、イーサネットフレームにVLAN IDなどの情報を含むタグを挿入することで、スイッチ間でVLAN情報を伝達します。

*   **問題13 (追加)**: TLS通信の開始時に、クライアントが接続先のサーバが本物であることを確認するために用いるものは何ですか？
    *   **回答**: **サーバ証明書（公開鍵証明書）**です。
    *   **解説**: サーバ証明書は、信頼できる第三者機関である認証局（CA）によって発行されます。クライアントはこれを検証することで、通信相手のサーバの正当性を確認し、安全に暗号化通信を開始します。

*   **問題14 (追加)**: ネットワーク上のサーバに対し、どのようなサービス（ポート）が待ち受け状態にあるかを調査する行為を何と呼びますか？
    *   **回答**: **ポートスキャン**です。
    *   **解説**: 攻撃者はポートスキャンによって稼働中のサービスやそのバージョンを特定し、攻撃の足がかりとなる脆弱性を探します。ファイアウォールやIPSは、このようなスキャン行為を検知し、遮断する機能を持っています。